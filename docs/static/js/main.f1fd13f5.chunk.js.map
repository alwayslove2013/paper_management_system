{"version":3,"sources":["Server/index.js","Common/Counter.js","Store/createStoreV0128.js","Store/index.js","Views/SearchView/index.js","Views/ControlView/index.js","Views/UnitView/CircleUnit.js","Views/UnitView/index.js","Views/DetailView/index.js","Common/userList.js","Views/Header/index.js","App.js","reportWebVitals.js","index.js"],"names":["baseUrl","fetchData","url","params","getUrl","includes","qs","stringify","Promise","resolve","reject","fetch","then","res","json","data","catch","err","getPublicTags","a","getPrivateTags","uid","setPrivateTags","pid","paper","privateTags","read","tags","filter","join","mostCommon","items","n","item2Count","forEach","itemList","item","itemCountList","push","count","sort","b","slice","map","attr2func","publicTags","createStore","titleSearch","setTitleSearch","text","this","toLocaleLowerCase","searchPaperDois","papers","title","indexOf","doi","Set","commonAuthors","commonCountries","commonPublicTags","commonPrivateTags","setPapers","compareAttr","console","log","doi2paper","colors","innerColors","outerColors","internalRefList","internalCitedList","refList","toLowerCase","split","trim","authors","replace","countries","s","part","length","toUpperCase","ref","concat","computedPosition","initPublicTags","runInAction","setPaper","attr","value","find","p","userId","toJS","doiUpdateColors","unitXAttr","xAttrSet","add","xAttrList","Array","from","unitYAttr","maxUnitBlockPaperCount","unitBlockCount","xAttr","yAttr","unitIndex","Math","max","Object","values","initPrivateTags","readIndex","splice","batchUpdateColors","setUserId","localStorage","setItem","initUserId","getItem","label","list","highlightType","category2highlightType","controlTagNameList","category","activeTags","ans","key","outerCategories","isUnitOuterHighlight","outerCategory","tag2color","colorUse","setTagColor","tag","fullTag","i","_color","d3","updateColor","hightlightAttrs","maxCitationCount","currentSelected","currentSelectedRefSet","currentSelectedCitedSet","isSelected","setCurrentSelected","cancelSelect","storeContext","React","createContext","StoreProvider","children","store","useLocalObservable","Provider","useGlobalStore","useContext","Error","SearchView","handleInput","debounce","e","target","className","onInput","SearchOutlined","ControlView","observer","searchAttr","ControlItem","tagData","useState","setTags","handleClickOption","currentTags","index","clickOption","isSelect","ControlOption","style","background","border","value_format","onClick","CircleUnit","memo","cx","cy","r","opacity","handleClick","isBackgroundActive","polarX","angle","sin","polarY","cos","innerStepAngle","PI","innerPoints","_","startX","startY","endX","endY","outerR","outerPolarX","outerPolarY","outerStepAngle","outerPoints","id","cursor","x","y","width","height","fill","rx","ry","point","d","stroke","strokeWidth","unitLayoutPadding","unitBlockPadding","UnitView","unitXAttrList","unitYAttrList","controlIsActive","searchPaperDoiSet","svgWidth","setSvgWidth","svgHeight","setSvgHeight","useEffect","svg","document","querySelector","clientWidth","clientHeight","unitBlockWidth","unitBlockHeight","aspectRatio","floor","blockCountX","ceil","sqrt","xAttr2blockCountX","maxColumnBlockCount","j","get","xAttr2blockCountX_StartCount","xAttr2blockCountX_StartPos","scale","domain","range","paperCircles","paperCircle","oriData","BlockIndexX","BlockIndexY","circleIndexX","circleIndexY","citationGrey","citationCount","activeColors","has","Title","borderColor","xLabels","yLabels","handleClickPaper","stopPropagation","borderOpacity","textAnchor","fontSize","transform","DetailView","currentSelectedPaper","editTags","initTags","year","size","checkedChildren","CheckOutlined","unCheckedChildren","CloseOutlined","defaultChecked","onChange","editTag","handleChangeTags","DetailItem","DetailEditTags","_setTags","newTags","editInputIndex","setEditInputIndex","input","useRef","editInputValue","setEditInputValue","handleEditInputConfirm","inputValue","setInputValue","handleInputConfirm","setInputVisible","inputVisible","onchange","onBlur","onPressEnter","closable","onClose","removeTag","type","PlusOutlined","userList","Option","Select","Header","placeholder","user","App","ViewContainer","fetchPapers","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.f1fd13f5.chunk.js","sourcesContent":["import qs from \"qs\";\n\nconst baseUrl = \"http://vis.pku.edu.cn/vis4vis/\";\nconst fetchData = (url, params = \"\") => {\n  const getUrl =\n    baseUrl + url + (url.includes(\"?\") ? \"&\" : \"?\") + qs.stringify(params);\n  return new Promise((resolve, reject) => {\n    fetch(getUrl)\n      .then((res) => res.json())\n      .then((data) => resolve(data))\n      .catch((err) => reject(err));\n  });\n};\n\nexport const getPublicTags = async () => {\n  return await fetchData(\"get_public_tags\");\n};\n\nexport const getPrivateTags = async ({ uid }) => {\n  return await fetchData(\"get_private_tags\", { uid });\n};\n\nexport const setPublicTags = ({ pid, paper }) => {\n  const tags = paper.publicTags;\n  fetchData(\"set_public_tags\", { pid, tags: tags.join(\",\") });\n  return \"OK\";\n};\n\nexport const setPrivateTags = ({ uid, pid, paper }) => {\n  const { privateTags, read } = paper;\n  uid &&\n    fetchData(\"set_private_tags\", {\n      uid,\n      pid,\n      tags: [...privateTags, read && \"read\"].filter((a) => a).join(\",\"),\n    });\n  return \"OK\";\n};\n","const mostCommon = (items, n = 10) => {\n  const item2Count = {};\n  items.forEach((itemList) => {\n    itemList.forEach((item) => {\n      if (item) {\n        if (item in item2Count) {\n          item2Count[item] += 1;\n        } else {\n          item2Count[item] = 1;\n        }\n      }\n    });\n  });\n  const itemCountList = [];\n  for (let item in item2Count) {\n    itemCountList.push({\n      item,\n      count: item2Count[item],\n    });\n  }\n  itemCountList.sort((a, b) => b.count - a.count);\n  return itemCountList.slice(0, n).map(a => a.item);\n};\n\nexport default mostCommon;\n","import * as d3 from \"d3\";\nimport { toJS, runInAction } from \"mobx\";\nimport {\n  setPublicTags,\n  setPrivateTags,\n  getPublicTags,\n  getPrivateTags,\n} from \"../Server\";\n// import { get } from \"lodash\";\nimport mostCommon from \"../Common/Counter\";\n\nconst debug = true;\n\nconst attr2func = {\n  publicTags: setPublicTags,\n  privateTags: setPrivateTags,\n  read: setPrivateTags,\n};\n\nconst createStore = () => {\n  return {\n    titleSearch: \"\",\n    setTitleSearch(text) {\n      this.titleSearch = text.toLocaleLowerCase();\n    },\n    get searchPaperDoiSet() {\n      const searchPaperDois = this.titleSearch\n        ? this.papers\n            .filter((paper) => paper.title.toLocaleLowerCase().indexOf(this.titleSearch) > -1)\n            .map((paper) => paper.doi)\n        : [];\n      const searchPaperDoiSet = new Set(searchPaperDois);\n      return searchPaperDoiSet;\n    },\n    papers: [],\n    commonAuthors: [],\n    commonCountries: [],\n    commonPublicTags: [],\n    commonPrivateTags: [],\n    async setPapers(papers, compareAttr = \"citationCount\") {\n      debug && console.log(\"==> 初始化Papers\");\n      const doi2paper = {};\n      papers.forEach((paper) => {\n        // 初始化，一些特殊处理，比如如果没有doi或者引用量，就安排一个\n        // if (paper.doi === \"#\") paper.doi = `tmp-${i}`;\n        // if (paper.CitationCount === \"\") paper.CitationCount = 0;\n        // if (paper.Countries === \"#\" || paper.Countries === \"###\")\n        //   paper.Countries = \"\";\n        paper.privateTags = [];\n        paper.read = false;\n        paper.publicTags = [];\n        paper.colors = [];\n        paper.innerColors = [];\n        paper.outerColors = [];\n        paper.internalRefList = [];\n        paper.internalCitedList = [];\n        paper.refList = paper.refList\n          .toLowerCase()\n          .split(\";\")\n          .map((a) => a.trim());\n        doi2paper[paper.doi] = paper;\n\n        // 提取authors\n        paper.authors = paper.authors\n          .split(\";\")\n          .map((a) => a.trim().replace(/\\{(.*)\\}/, \"$1\"));\n\n        // 提取countries\n        paper.countries = paper.countries\n          .split(\";\")\n          .map((s) => {\n            const part = s\n              .trim()\n              .split(\" \")\n              .map((a) => a.trim())\n              .filter((a) => a);\n            if (part.length === 0) return \"\";\n            let country = part[part.length - 1]\n              .toLowerCase()\n              .replace(/^\\w/, (s) => s.toUpperCase());\n            return country;\n          })\n          .filter((a) => a);\n      });\n\n      papers.forEach((paper) => {\n        paper.refList.forEach((ref) => {\n          if (ref in doi2paper) {\n            const refPaper = doi2paper[ref];\n            refPaper.internalCitedList.push(paper.doi);\n            paper.internalRefList.push(ref);\n          }\n        });\n      });\n\n      this.commonAuthors = mostCommon(\n        papers.map((paper) => paper.authors),\n        7\n      ).concat([\"Xiaoru Yuan\"]);\n      // console.log(\n      //   \"Authors Tags: \",\n      //   mostCommon(\n      //     papers.map((paper) => paper.authors),\n      //     100\n      //   )\n      // );\n      this.commonCountries = mostCommon(papers.map((paper) => paper.countries));\n\n      // 先按引用量排序，再去统计分组的排序，这个时间消耗其实还挺大的。\n      papers.sort((a, b) => b[compareAttr] - a[compareAttr]);\n\n      // 开始计算位置\n      this.computedPosition(papers);\n      await this.initPublicTags(papers);\n\n      runInAction(() => {\n        this.papers = papers;\n      });\n    },\n    setPaper(doi, attr, value) {\n      const paper = this.papers.find((p) => p.doi === doi);\n      paper[attr] = value;\n      // if (attr === \"read\") {\n      //   if (value) {\n      //     paper.privateTags.push(\"read\");\n      //   } else {\n      //     paper.privateTags = [...paper.privateTags].filter(\n      //       (a) => a !== \"read\"\n      //     );\n      //   }\n      // }\n      debug && console.log(\"==> 更新paper数据 by doi:\", doi, attr, value);\n      // attr === \"publicTags\" && setPublicTags(doi, value);\n      attr2func[attr]({\n        uid: this.userId,\n        pid: doi,\n        paper: toJS(paper),\n      });\n      this.doiUpdateColors(doi);\n    },\n    unitXAttr: \"year\",\n    get unitXAttrList() {\n      const xAttrSet = new Set();\n      this.papers.forEach((paper) => {\n        xAttrSet.add(paper[this.unitXAttr]);\n      });\n      const xAttrList = Array.from(xAttrSet);\n      xAttrList.sort((a, b) => b - a);\n      return xAttrList;\n    },\n    unitYAttr: \"conferenceName\",\n    get unitYAttrList() {\n      return [\"SciVis\", \"InfoVis\", \"EuroVis\", \"VAST\", \"PacificVis\"];\n      // const yAttrSet = new Set();\n      // this.papers.forEach((paper) => {\n      //   yAttrSet.add(paper[this.unitYAttr]);\n      // });\n      // const yAttrList = Array.from(yAttrSet);\n      // yAttrList.sort();\n      // return yAttrList;\n    },\n    maxUnitBlockPaperCount: 0,\n    unitBlockCount: {},\n    computedPosition(papers) {\n      // 每一个block有多少单元\n      const unitBlockCount = {};\n      papers.forEach((paper) => {\n        const xAttr = paper[this.unitXAttr];\n        const yAttr = paper[this.unitYAttr];\n        if (!(xAttr in unitBlockCount)) unitBlockCount[xAttr] = {};\n        if (!(yAttr in unitBlockCount[xAttr])) unitBlockCount[xAttr][yAttr] = 0;\n        paper.unitIndex = unitBlockCount[xAttr][yAttr];\n        unitBlockCount[xAttr][yAttr] += 1;\n      });\n      this.maxUnitBlockPaperCount =\n        Math.max(...papers.map((paper) => paper.unitIndex)) * 0.6;\n      this.unitBlockCount = unitBlockCount;\n    },\n\n    async initPublicTags(papers) {\n      const publicTags = await getPublicTags();\n      papers.forEach((paper) => {\n        if (paper.doi in publicTags) {\n          paper.publicTags = publicTags[paper.doi].filter((a) => a);\n        }\n      });\n      runInAction(() => {\n        this.commonPublicTags = mostCommon(Object.values(publicTags));\n      });\n    },\n    async initPrivateTags() {\n      const privateTags = await getPrivateTags({ uid: this.userId });\n\n      runInAction(() => {\n        this.papers.forEach((paper) => {\n          if (paper.doi in privateTags) {\n            const readIndex = privateTags[paper.doi].indexOf(\"read\");\n            if (readIndex > -1) {\n              paper.read = true;\n              privateTags[paper.doi].splice(readIndex, 1);\n            }\n            paper.privateTags = privateTags[paper.doi].filter((a) => a);\n          }\n        });\n        this.commonPrivateTags = mostCommon(Object.values(privateTags));\n      });\n\n      this.batchUpdateColors();\n    },\n\n    userId: \"\",\n    setUserId(userId) {\n      if (userId !== this.userId) {\n        this.userId = userId;\n        debug && console.log(\"==> change userId:\", this.userId);\n        localStorage.setItem(\"paper-management-system-userId\", userId);\n        userId && this.initPrivateTags();\n      }\n    },\n    initUserId() {\n      const userId = localStorage.getItem(\"paper-management-system-userId\");\n      userId && this.setUserId(userId);\n    },\n\n    get controlTagNameList() {\n      return [\n        {\n          label: \"Country\",\n          value: \"countries\",\n          list: this.commonCountries.slice(0, 8).concat([\"Japan\", \"Korea\"]),\n          highlightType: \"outer\",\n        },\n        {\n          label: \"Author\",\n          value: \"authors\",\n          list: this.commonAuthors,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Private Tag\",\n          value: \"privateTags\",\n          // list: [\"read\"].concat(this.commonPrivateTags),\n          list: this.commonPrivateTags,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Public Tag\",\n          value: \"publicTags\",\n          list: this.commonPublicTags,\n          highlightType: \"inner\",\n        },\n      ];\n    },\n    get category2highlightType() {\n      const category2highlightType = {};\n      this.controlTagNameList.forEach((category) => {\n        category2highlightType[category.value] = category.highlightType;\n      });\n      return category2highlightType;\n    },\n    activeTags: {\n      countries: [],\n      authors: [],\n      privateTags: [],\n      publicTags: [],\n    },\n    // 判断 至少有一个控制器被激活\n    get controlIsActive() {\n      let ans = false;\n      for (let key in this.activeTags) {\n        if (this.activeTags[key].length > 0) {\n          ans = true;\n        }\n      }\n      return ans;\n    },\n    // 判断 至少有一个outer被激活\n    get isUnitOuterHighlight() {\n      const outerCategories = this.controlTagNameList\n        .filter((category) => category.highlightType === \"outer\")\n        .map((category) => category.value);\n      let isUnitOuterHighlight = false;\n      outerCategories.forEach((outerCategory) => {\n        if (this.activeTags[outerCategory].length > 0)\n          isUnitOuterHighlight = true;\n      });\n      return isUnitOuterHighlight;\n    },\n    tag2color: {},\n    colorUse: {},\n    setTagColor(tag, category) {\n      debug && console.log(\"==> 设置tag颜色:\", category, tag);\n      const fullTag = `${category}---${tag}`;\n      if (fullTag in this.tag2color) {\n        // 回收该颜色\n        this.colorUse[this.tag2color[fullTag]] = false;\n        delete this.tag2color[fullTag];\n        this.activeTags[category] = [...this.activeTags[category]].filter(\n          (a) => a !== tag\n        );\n      } else {\n        // 分配一个新的颜色\n        this.activeTags[category].push(tag);\n        let i = 0;\n        let _color = d3.schemeTableau10[i];\n        while (this.colorUse[_color]) {\n          i += 1;\n          if (i === 10) {\n            _color = \"black\";\n            break;\n          }\n          _color = d3.schemeTableau10[i];\n        }\n        this.tag2color[fullTag] = _color;\n        this.colorUse[_color] = true;\n      }\n      this.batchUpdateColors();\n    },\n    batchUpdateColors() {\n      this.papers.forEach((paper) => {\n        paper.colors = [];\n        paper.innerColors = [];\n        paper.outerColors = [];\n        this.updateColor(paper);\n      });\n    },\n    doiUpdateColors(doi) {\n      const paper = this.papers.find((p) => p.doi === doi);\n      paper.colors = [];\n      paper.innerColors = [];\n      paper.outerColors = [];\n      this.updateColor(paper);\n    },\n    updateColor(paper) {\n      const isReadTagActive = this.activeTags.privateTags.indexOf(\"read\") > -1;\n      if (isReadTagActive && paper.read) {\n        paper.colors.push(this.tag2color[\"privateTags---read\"]);\n        paper.innerColors.push(this.tag2color[\"privateTags---read\"]);\n      }\n\n      for (let category in this.activeTags) {\n        const hightlightAttrs = this.activeTags[category];\n        if (this.category2highlightType[category] === \"inner\") {\n          hightlightAttrs.forEach((attr) => {\n            if (paper[category].indexOf(attr) > -1) {\n              const fullTag = `${category}---${attr}`;\n              paper.innerColors.push(this.tag2color[fullTag]);\n            }\n          });\n        } else {\n          hightlightAttrs.forEach((attr) => {\n            if (paper[category].indexOf(attr) > -1) {\n              const fullTag = `${category}---${attr}`;\n              paper.outerColors.push(this.tag2color[fullTag]);\n            }\n          });\n        }\n        hightlightAttrs.forEach((attr) => {\n          if (paper[category].indexOf(attr) > -1) {\n            const fullTag = `${category}---${attr}`;\n            paper.colors.push(this.tag2color[fullTag]);\n          }\n        });\n      }\n    },\n    maxCitationCount: 200,\n\n    currentSelected: \"\",\n    currentSelectedRefSet: new Set(),\n    currentSelectedCitedSet: new Set(),\n    isSelected: false,\n    setCurrentSelected(doi) {\n      debug && console.log(\"==> 选中文章:\", doi);\n      this.currentSelected = doi;\n      this.isSelected = !!doi;\n\n      const paper = this.papers.find((paper) => paper.doi === doi);\n      this.currentSelectedRefSet = new Set(paper.internalRefList);\n      this.currentSelectedCitedSet = new Set(paper.internalCitedList);\n    },\n    cancelSelect() {\n      debug && console.log(\"==> 点击背景，取消论文选中状态\");\n      this.isSelected = false;\n    },\n    get currentSelectedPaper() {\n      return this.papers.find((paper) => paper.doi === this.currentSelected);\n    },\n  };\n};\n\nexport default createStore;\n","import React from \"react\";\nimport createStore from \"./createStoreV0128\";\nimport { useLocalObservable } from \"mobx-react-lite\";\n\nconst storeContext = React.createContext(null);\n\nexport const StoreProvider = ({ children }) => {\n  const store = useLocalObservable(createStore);\n  return (\n    <storeContext.Provider value={store}>{children}</storeContext.Provider>\n  );\n};\n\nexport const useGlobalStore = () => {\n  const store = React.useContext(storeContext);\n  if (!store) {\n    throw new Error(\"no Provider\");\n  }\n  return store;\n};\n","import React from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"../../Store\";\nimport { debounce } from \"lodash\";\nimport { SearchOutlined } from \"@ant-design/icons\";\n// import {observer} from \"mobx-react-lite\";\n\nconst SearchView = () => {\n  const store = useGlobalStore();\n  // const { searchPaperDoiSet } = store;\n  // console.log(\"=====> searchPaperDoiSet\", searchPaperDoiSet);\n  const handleInput = debounce((e) => {\n    // console.log(\"===>\", e.target.value);\n    store.setTitleSearch(e.target.value);\n  }, 200);\n  return (\n    <div className=\"search-view\">\n      <div className=\"search-view-input\">\n        <input onInput={handleInput} />\n      </div>\n\n      <div className=\"search-view-icon\">\n        <SearchOutlined />\n      </div>\n    </div>\n  );\n};\n\nexport default SearchView;\n","import React, { useState } from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"../../Store\";\nimport { observer } from \"mobx-react-lite\";\n// import { toJS } from \"mobx\";\nimport SearchView from \"../SearchView\";\n\nconst ControlView = observer(() => {\n  const store = useGlobalStore();\n  const { controlTagNameList } = store;\n  return (\n    <div className=\"control-view\">\n      <div className=\"control-item\">\n        <div className=\"control-item-title\">Title Search</div>\n        <div className=\"control-item-options\">\n          <SearchView searchAttr={\"title\"} />\n        </div>\n      </div>\n\n      {controlTagNameList.map((tag) => (\n        <ControlItem key={tag.label} tagData={tag} />\n      ))}\n    </div>\n  );\n});\n\nexport default ControlView;\n\nconst ControlItem = observer(({ tagData }) => {\n  const store = useGlobalStore();\n  const { tag2color } = store;\n\n  const [tags, setTags] = useState([]);\n  const handleClickOption = (value) => {\n    const currentTags = [...tags];\n    const index = currentTags.indexOf(value);\n    if (index > -1) {\n      currentTags.splice(index, 1);\n      setTags(currentTags);\n    } else {\n      currentTags.push(value);\n      setTags(currentTags);\n    }\n    store.setTagColor(value, tagData.value);\n  };\n\n  return (\n    <div className=\"control-item\">\n      <div className=\"control-item-title\">{tagData.label}</div>\n      <div className=\"control-item-options\">\n        {tagData.list.map((item) => (\n          <ControlOption\n            key={item}\n            value={item}\n            clickOption={handleClickOption}\n            isSelect={\n              tags.indexOf(item) > -1 && tag2color[`${tagData.value}---${item}`]\n            }\n          />\n        ))}\n      </div>\n    </div>\n  );\n});\n\nconst ControlOption = ({ value, clickOption, isSelect }) => {\n  const className = [\"control-item-option\", isSelect && \"option-active\"]\n    .filter((a) => a)\n    .join(\" \");\n  const style = isSelect\n    ? { background: isSelect, border: `1px solid ${isSelect}` }\n    : {};\n  const value_format = value === \"Usa\" ? \"USA\" : value;\n  return (\n    <div className={className} onClick={() => clickOption(value)} style={style}>\n      {value_format}\n    </div>\n  );\n};\n","import React from \"react\";\n// import * as d3 from \"d3\";\n// import { useGlobalStore } from \"../../Store\";\n// import { observer } from \"mobx-react-lite\";\n\nconst CircleUnit = React.memo(\n  ({\n    cx,\n    cy,\n    r,\n    // colors,\n    opacity,\n    doi,\n    handleClick,\n    // borderColor,\n    // borderOpacity,\n    title,\n    innerColors,\n    outerColors,\n    isBackgroundActive,\n  }) => {\n    const polarX = (angle) => cx + Math.sin(angle) * r;\n    const polarY = (angle) => cy + Math.cos(angle) * r;\n    const innerStepAngle = (2 * Math.PI) / innerColors.length;\n    const innerPoints = innerColors.map((_, i) => ({\n      startX: polarX(innerStepAngle * i),\n      startY: polarY(innerStepAngle * i),\n      endX: polarX(innerStepAngle * (i + 1)),\n      endY: polarY(innerStepAngle * (i + 1)),\n    }));\n\n    // console.log('outerColors', outerColors)\n    const outerR = r * 1.5;\n    const outerPolarX = (angle) => cx + Math.sin(angle) * outerR;\n    const outerPolarY = (angle) => cy + Math.cos(angle) * outerR;\n    const outerStepAngle = (2 * Math.PI) / outerColors.length;\n    const outerPoints = outerColors.map((_, i) => ({\n      startX: outerPolarX(outerStepAngle * i),\n      startY: outerPolarY(outerStepAngle * i),\n      endX: outerPolarX(outerStepAngle * (i + 1)),\n      endY: outerPolarY(outerStepAngle * (i + 1)),\n    }));\n\n    // const borderOpacity = isSelect ? 1 : 0;\n\n    return (\n      <g id=\"unit-g\" onClick={(e) => handleClick(e, doi)} cursor=\"pointer\">\n        <title>{title}</title>\n        <g id=\"unit-background-g\">\n          {isBackgroundActive && (\n            <rect\n              x={cx - 1.6 * r}\n              y={cy - 1.6 * r}\n              width={r * 3.2}\n              height={r * 3.2}\n              fill=\"#fc8d62\"\n              rx={r * 0.4}\n              ry={r * 0.4}\n            />\n          )}\n        </g>\n        <g id=\"unit-border-g\">\n          {/* <circle\n            cx={cx}\n            cy={cy}\n            r={1.4 * r}\n            fill=\"none\"\n            stroke={borderColor}\n            strokeWidth={0.6 * r}\n            opacity={borderOpacity}\n          /> */}\n          {outerPoints.length > 1 ? (\n            outerPoints.map((point, i) => (\n              <path\n                key={i}\n                d={`M ${cx} ${cy}\n              L ${point.startX} ${point.startY}\n              A ${outerR} ${outerR} 0 0 0 ${point.endX} ${point.endY}\n              Z\n              `}\n                // stroke=\"white\"\n                fill={outerColors[i]}\n                // strokeWidth={0.1 * r}\n                // fill-opacity=\"0.2\"\n              />\n            ))\n          ) : (\n            <circle\n              cx={cx}\n              cy={cy}\n              r={outerR}\n              fill={outerColors.length > 0 ? outerColors[0] : \"none\"}\n              // stroke=\"red\"\n              // strokeWidth={0.15 * r}\n            />\n          )}\n          {/* {outerPoints.length > 0 && <circle\n            cx={cx}\n            cy={cy}\n            r={1.2 * r}\n            fill=\"white\"\n            // stroke={borderColor}\n            // strokeWidth={0.6 * r}\n            // opacity={borderOpacity}\n          />} */}\n          <circle\n            cx={cx}\n            cy={cy}\n            r={1.1 * r}\n            fill=\"white\"\n            // stroke={borderColor}\n            // strokeWidth={0.6 * r}\n            opacity={outerPoints.length > 0 ? 1 : 0}\n          />\n        </g>\n        <g id=\"unit-sector-g\" opacity={opacity}>\n          {innerPoints.length > 1 ? (\n            innerPoints.map((point, i) => (\n              <path\n                key={i}\n                d={`M ${cx} ${cy}\n              L ${point.startX} ${point.startY}\n              A ${r} ${r} 0 0 0 ${point.endX} ${point.endY}\n              Z\n              `}\n                stroke=\"white\"\n                fill={innerColors[i]}\n                strokeWidth={0.1 * r}\n                // fill-opacity=\"0.2\"\n              />\n            ))\n          ) : (\n            <circle\n              cx={cx}\n              cy={cy}\n              r={r}\n              fill={innerColors[0]}\n              // stroke=\"red\"\n              // strokeWidth={0.15 * r}\n            />\n          )}\n        </g>\n      </g>\n    );\n  }\n);\n\nexport default CircleUnit;\n","import React, { useEffect, useState } from \"react\";\nimport \"./index.scss\";\nimport CircleUnit from \"./CircleUnit\";\nimport { useGlobalStore } from \"../../Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { toJS } from \"mobx\";\nimport { get } from \"lodash\";\nimport * as d3 from \"d3\";\n\nconst unitLayoutPadding = {\n  top: 30,\n  left: 40,\n  right: 15,\n  bottom: 1,\n};\n\nconst unitBlockPadding = {\n  top: 2,\n  left: 3,\n  right: 3,\n  bottom: 1,\n};\n\nconst UnitView = observer(() => {\n  const store = useGlobalStore();\n  const {\n    papers,\n    unitXAttr,\n    unitYAttr,\n    unitXAttrList,\n    unitYAttrList,\n    unitBlockCount,\n    maxUnitBlockPaperCount,\n    // doi2paperBlockPos,\n    // doi2privateTags,\n    // doi2publicTags,\n    // doi2comments,\n    // doi2colors,\n    controlIsActive,\n    isUnitOuterHighlight,\n    currentSelected,\n    setCurrentSelected,\n    isSelected,\n    cancelSelect,\n    currentSelectedRefSet,\n    currentSelectedCitedSet,\n    searchPaperDoiSet,\n  } = store;\n\n  // const svg = document.querySelector(\"#unit-svg\");\n  // const svgWidth =\n  //   svg.clientWidth - unitLayoutPadding.left - unitLayoutPadding.right;\n  // const svgHeight =\n  //   svg.clientHeight - unitLayoutPadding.top - unitLayoutPadding.bottom;\n\n  const [svgWidth, setSvgWidth] = useState(0);\n  const [svgHeight, setSvgHeight] = useState(0);\n\n  // 初始化svg长宽\n  useEffect(() => {\n    const svg = document.querySelector(\"#unit-svg\");\n    setSvgWidth(\n      svg.clientWidth - unitLayoutPadding.left - unitLayoutPadding.right\n    );\n    setSvgHeight(\n      svg.clientHeight - unitLayoutPadding.top - unitLayoutPadding.bottom\n    );\n  }, []);\n  const unitBlockWidth =\n    unitXAttrList.length > 0\n      ? svgWidth / unitXAttrList.length -\n        unitBlockPadding.left -\n        unitBlockPadding.right\n      : 0;\n  const unitBlockHeight =\n    unitYAttrList.length > 0\n      ? svgHeight / unitYAttrList.length -\n        unitBlockPadding.top -\n        unitBlockPadding.bottom\n      : 0;\n  // console.log(unitBlockWidth, unitBlockHeight);\n\n  const aspectRatio = Math.floor(\n    unitBlockWidth > 0 ? unitBlockHeight / unitBlockWidth : 1\n  );\n\n  const blockCountX = Math.ceil(\n    Math.sqrt(maxUnitBlockPaperCount / aspectRatio)\n  );\n  // console.log('blockCountX', blockCountX);\n\n  const xAttr2blockCountX = unitXAttrList.map((xAttr, i) => {\n    const maxColumnBlockCount = Math.max(\n      ...unitYAttrList.map((yAttr, j) => get(unitBlockCount, [xAttr, yAttr], 0))\n    );\n    let blockCountX = Math.ceil(\n      Math.sqrt(maxUnitBlockPaperCount / aspectRatio)\n    );\n    if (maxColumnBlockCount > maxUnitBlockPaperCount) {\n      blockCountX += 1;\n    }\n    return blockCountX;\n  });\n  // console.log(\"xAttr2blockCountX\", xAttr2blockCountX);\n\n  // const blockCountY = Math.ceil(aspectRatio * blockCountX);\n\n  let r = unitBlockWidth / blockCountX;\n  // console.log(\"r\", r);\n\n  const xAttr2blockCountX_StartCount = [0];\n  const xAttr2blockCountX_StartPos = [0];\n\n  for (let i = 1; i < unitXAttrList.length; i++) {\n    xAttr2blockCountX_StartCount.push(\n      xAttr2blockCountX_StartCount[i - 1] + xAttr2blockCountX[i - 1]\n    );\n  }\n\n  r =\n    (svgWidth -\n      (unitBlockPadding.left + unitBlockPadding.right) * unitXAttrList.length) /\n    (xAttr2blockCountX_StartCount[xAttr2blockCountX_StartCount.length - 1] +\n      xAttr2blockCountX[xAttr2blockCountX.length - 1]);\n  // console.log(\"new r\", r);\n\n  for (let i = 1; i < unitXAttrList.length; i++) {\n    xAttr2blockCountX_StartPos.push(\n      xAttr2blockCountX_StartCount[i] * r +\n        (unitBlockPadding.left + unitBlockPadding.right) * i\n    );\n  }\n  // console.log(\"xAttr2blockCountX_StartCount\", xAttr2blockCountX_StartCount);\n  // console.log(\"xAttr2blockCountX_StartPos\", xAttr2blockCountX_StartPos);\n  const scale = d3.scaleLinear().domain([0, 100]).range([0.25, 0.8]);\n  const citeCount2grey = (count) => d3.interpolateGreys(scale(count));\n  const paperCircles = papers.map((paper) => {\n    const paperCircle = {};\n    paperCircle.oriData = toJS(paper);\n\n    paperCircle.BlockIndexX = unitXAttrList.indexOf(paper[unitXAttr]);\n    paperCircle.BlockIndexY = unitYAttrList.indexOf(paper[unitYAttr]);\n\n    const doi = paper.doi;\n    paperCircle.doi = doi;\n\n    paperCircle.circleIndexX =\n      paper.unitIndex % xAttr2blockCountX[paperCircle.BlockIndexX];\n    paperCircle.circleIndexY = Math.floor(\n      paper.unitIndex / xAttr2blockCountX[paperCircle.BlockIndexX]\n    );\n\n    paperCircle.cx =\n      unitLayoutPadding.left +\n      paperCircle.BlockIndexX *\n        (unitBlockWidth + unitBlockPadding.left + unitBlockPadding.right) +\n      (paperCircle.circleIndexX + 0.5) * r;\n    paperCircle.cy =\n      unitLayoutPadding.top +\n      paperCircle.BlockIndexY *\n        (unitBlockHeight + unitBlockPadding.top + unitBlockPadding.bottom) +\n      (paperCircle.circleIndexY + 0.5) * r;\n\n    // 外挂逻辑\n    if (paper[\"year\"] == 2004 && paperCircle.BlockIndexY > 0) {\n      paperCircle.cy += 50 - paperCircle.BlockIndexY * 10;\n    }\n\n    paperCircle.cx =\n      unitLayoutPadding.left +\n      xAttr2blockCountX_StartPos[paperCircle.BlockIndexX] +\n      (paperCircle.circleIndexX + 0.5) * r;\n\n    paperCircle.citationGrey = citeCount2grey(paper.citationCount);\n    paperCircle.activeColors = paper.innerColors;\n    paperCircle.colors =\n      paperCircle.activeColors.length > 0\n        ? paperCircle.activeColors\n        : [paperCircle.citationGrey];\n    paperCircle.innerColors =\n      paperCircle.activeColors.length > 0\n        ? paperCircle.activeColors\n        : [paperCircle.citationGrey];\n    // paperCircle.outerColors\n    paperCircle.outerColors = [\"none\"];\n    if (isUnitOuterHighlight) {\n      paperCircle.outerColors = paper.outerColors;\n    } else {\n      if (isSelected) {\n        if (currentSelected === paper.doi)\n          paperCircle.outerColors = [\"#d95f02\"];\n        if (currentSelectedRefSet.has(paper.doi))\n          paperCircle.outerColors = [\"#1b9e77\"];\n        if (currentSelectedCitedSet.has(paper.doi))\n          paperCircle.outerColors = [\"#7570b3\"];\n      } else {\n        paperCircle.outerColors = [\"none\"];\n      }\n    }\n\n    paperCircle.opacity = controlIsActive\n      ? paperCircle.activeColors.length > 0\n        ? 0.8\n        : 0.4\n      : 0.8;\n\n    paperCircle.title = paper.Title;\n\n    if (isSelected) {\n      if (currentSelected === paper.doi) paperCircle.borderColor = \"#d95f02\";\n      if (currentSelectedRefSet.has(paper.doi))\n        paperCircle.borderColor = \"#1b9e77\";\n      if (currentSelectedCitedSet.has(paper.doi))\n        paperCircle.borderColor = \"#7570b3\";\n    } else {\n      paperCircle.borderColor = \"none\";\n    }\n\n    paperCircle.isBackgroundActive = searchPaperDoiSet.has(paper.doi);\n\n    return paperCircle;\n  });\n\n  const xLabels = unitXAttrList.map((xAttr, i) => {\n    const startX = unitLayoutPadding.left + xAttr2blockCountX_StartPos[i];\n    const middleX = startX + (xAttr2blockCountX[i] * r) / 2;\n    return {\n      value: xAttr,\n      x: middleX,\n      y: unitLayoutPadding.top * 0.8,\n    };\n  });\n\n  const yLabels = unitYAttrList.map((yAttr, i) => {\n    const startY =\n      unitLayoutPadding.top +\n      (unitBlockHeight + unitBlockPadding.top + unitBlockPadding.bottom) * i;\n    return {\n      value: yAttr,\n      x: unitLayoutPadding.left * 0.35,\n      y: startY,\n    };\n  });\n\n  const handleClickPaper = (e, doi) => {\n    // console.log(\"click\", e, doi);\n    e.stopPropagation();\n    setCurrentSelected(doi);\n  };\n\n  const handleClickBackground = () => {\n    cancelSelect();\n  };\n\n  return (\n    <div className=\"unit-view\">\n      <svg\n        id=\"unit-svg\"\n        width=\"100%\"\n        height=\"100%\"\n        onClick={handleClickBackground}\n      >\n        <g id=\"units\">\n          {r > 0 &&\n            paperCircles.map((paper, i) => (\n              <CircleUnit\n                key={i}\n                cx={paper.cx}\n                cy={paper.cy}\n                r={r / 2.4}\n                // grey={paper.citationGrey}\n                // oriData={paper.oriData}\n                doi={paper.doi}\n                colors={paper.colors}\n                opacity={paper.opacity}\n                innerColors={paper.innerColors}\n                outerColors={paper.outerColors}\n                handleClick={handleClickPaper}\n                // isSelect={isSelected && currentSelected === paper.doi}\n                borderOpacity={paper.borderOpacity}\n                borderColor={paper.borderColor}\n                title={paper.title}\n                isBackgroundActive={paper.isBackgroundActive}\n              />\n            ))}\n        </g>\n        <g id=\"x-label\">\n          {r > 0 &&\n            xLabels.map((label) => (\n              <text\n                key={label.value}\n                x={label.x}\n                y={label.y}\n                textAnchor=\"middle\"\n                fontSize={r * 1.6}\n                fill=\"rgb(78, 78, 78)\"\n              >\n                {label.value}\n              </text>\n            ))}\n        </g>\n        <g id=\"y-label\">\n          {r > 0 &&\n            yLabels.map((label) => (\n              <text\n                key={label.value}\n                // x={label.x}\n                // y={label.y}\n                // textAnchor=\"start\"\n                transform={`translate(${label.x}, ${label.y}) rotate(90)`}\n                fontSize={r * 1.6}\n                fill=\"rgb(78, 78, 78)\"\n              >\n                {label.value}\n              </text>\n            ))}\n        </g>\n      </svg>\n    </div>\n  );\n});\n\nexport default UnitView;\n","import React, { useState, useRef } from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"../../Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { get } from \"lodash\";\nimport { Switch } from \"antd\";\nimport { CloseOutlined, CheckOutlined } from \"@ant-design/icons\";\nimport { Tag, Input } from \"antd\";\nimport { PlusOutlined } from \"@ant-design/icons\";\nimport { toJS } from \"mobx\";\n\nconst debug = true;\n\nconst DetailView = observer(() => {\n  const store = useGlobalStore();\n  const { currentSelectedPaper, setPaper } = store;\n  const paper = currentSelectedPaper;\n  debug && console.log(\"currentSelectedPaper\", toJS(currentSelectedPaper));\n  if (!currentSelectedPaper) {\n    return <div></div>;\n  }\n\n  const doi = get(paper, \"doi\", \"\");\n\n  const editTags = [\n    {\n      title: \"Private Tags\",\n      value: \"privateTags\",\n      initTags: get(paper, \"privateTags\", []),\n    },\n    {\n      title: \"Public Tags\",\n      value: \"publicTags\",\n      initTags: get(paper, \"publicTags\", []),\n    },\n  ];\n  const handleChangeTags = (attr, value) => {\n    doi && setPaper(doi, attr, value);\n  };\n  const handleChangeRead = (value) => {\n    setPaper(doi, \"read\", value);\n  };\n  return (\n    <div className=\"detail-view\" key={doi}>\n      {paper && (\n        <>\n          <div className=\"detail-title\">{paper.title}</div>\n          <div className=\"detail-authors\">\n            {get(paper, \"authors\", []).join(\"; \")} ({paper.year})\n          </div>\n          <div className=\"detail-edit-tags\">\n            <div className=\"detail-edit-read\">\n              <div className=\"detail-edit-title\">Read</div>\n              <Switch\n                size=\"small\"\n                checkedChildren={<CheckOutlined />}\n                unCheckedChildren={<CloseOutlined />}\n                defaultChecked={get(paper, \"read\", false)}\n                onChange={handleChangeRead}\n              />\n            </div>\n            {editTags.map((editTag) => (\n              <DetailEditTags\n                key={editTag.value}\n                title={editTag.title}\n                initTags={editTag.initTags}\n                handleChangeTags={(value) =>\n                  handleChangeTags(editTag.value, value)\n                }\n              />\n            ))}\n          </div>\n          <div className=\"detail-attrs\">\n            <DetailItem paper={paper} label={\"keywords\"} />\n            <DetailItem paper={paper} label={\"doi\"} />\n            <DetailItem paper={paper} label={\"affiliation\"} />\n            <DetailItem paper={paper} label={\"abstract\"} />\n          </div>\n        </>\n      )}\n    </div>\n  );\n});\n\nexport default DetailView;\n\nconst DetailItem = ({ paper, label }) => (\n  <div className=\"detail-attr\">\n    <div className=\"detail-key\">{label}:</div>\n    <div className=\"detail-content\">{get(paper, label, \"\")}</div>\n  </div>\n);\n\nconst DetailEditTags = ({ title, initTags, handleChangeTags }) => {\n  const [tags, _setTags] = useState(initTags);\n  const setTags = (newTags) => {\n    handleChangeTags(newTags);\n    _setTags(newTags);\n  };\n  const [editInputIndex, setEditInputIndex] = useState(-1);\n  // const [editInput, setEditInput] = useState();\n  // const saveEditInputRef = (input) => setEditInput(input);\n  const input = useRef();\n  // const saveInputRef = (input) => setInput(input);\n\n  const [editInputValue, setEditInputValue] = useState(\"\");\n  const handleEditInputConfirm = () => {\n    const newTags = [...tags];\n    newTags[editInputIndex] = editInputValue;\n    setTags(newTags);\n    setEditInputIndex(-1);\n    setEditInputValue(\"\");\n  };\n\n  const [inputValue, setInputValue] = useState(\"\");\n  const handleInputConfirm = () => {\n    if (inputValue && tags.indexOf(inputValue) < 0) {\n      setTags([...tags, inputValue]);\n      setInputVisible(false);\n      setInputValue(\"\");\n    }\n  };\n\n  const handleClose = (removeTag) => {\n    setTags(tags.filter((tag) => tag !== removeTag));\n  };\n\n  const [inputVisible, setInputVisible] = useState(false);\n  const showInput = () => {\n    setInputVisible(true);\n    // input.focus();\n  };\n  return (\n    <div className=\"detail-edit-tag\">\n      <div className=\"detail-edit-title\">{title}:</div>\n      <div className=\"detail-edit-tags\">\n        <>\n          {tags.map((tag, index) => {\n            if (editInputIndex === index) {\n              return (\n                <Input\n                  // ref={saveEditInputRef}\n                  key={tag}\n                  size=\"small\"\n                  className=\"tag-input\"\n                  value={editInputValue}\n                  onchange={(e) => setEditInputValue(e.target.value)}\n                  onBlur={handleEditInputConfirm}\n                  onPressEnter={handleEditInputConfirm}\n                />\n              );\n            }\n\n            const tagElem = (\n              <Tag\n                className=\"edit-tag\"\n                key={tag}\n                closable={true}\n                onClose={() => handleClose(tag)}\n              >\n                <span\n                // onDoubleClick={(e) => {\n                //   setEditInputIndex(index);\n                //   setEditInputValue(tag);\n                //   editInput.focus();\n                //   e.preventDefault();\n                // }}\n                >\n                  {tag}\n                </span>\n              </Tag>\n            );\n            return tagElem;\n          })}\n          {inputVisible && (\n            <Input\n              ref={input}\n              type=\"text\"\n              size=\"small\"\n              className=\"tag-input\"\n              value={inputValue}\n              onChange={(e) => setInputValue(e.target.value)}\n              onBlur={handleInputConfirm}\n              onPressEnter={handleInputConfirm}\n            />\n          )}\n          {!inputVisible && (\n            <Tag className=\"site-tag-plus\" onClick={showInput}>\n              <PlusOutlined /> New Tag\n            </Tag>\n          )}\n        </>\n      </div>\n    </div>\n  );\n};\n","export const userList = [\n  \"Prof. Yuan\",\n  \"Guozheng Li\",\n  \"Shuai Chen\",\n  \"Chenglei Yue\",\n  \"Ruike Jiang\",\n  \"Can Liu\",\n  \"Jincheng Li\",\n  \"Chaofan Yang\",\n  \"Hanning Shao\",\n  \"Yuchu Luo\",\n  \"Zhixian Lin\",\n  \"Min Tian\",\n  \"Dingyi Yang\",\n  \"Changhe Yang\",\n  \"Yanda Li\",\n  \"Datong Wei\",\n  \"Cong Wu\",\n  \"Hao Wu\",\n  \"Shaocong Tan\",\n  \"Jiacheng Yu\",\n  \"Sihang Li\",\n  \"Zhen Li\",\n  \"Haohua Liu\",\n  \"KaiChen Nie\"\n];\n\nexport default userList;\n","import React from \"react\";\nimport \"./index.scss\";\nimport userList from \"../../Common/userList\";\nimport { useGlobalStore } from \"../../Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { Select } from \"antd\";\nconst { Option } = Select;\n\nconst Header = observer(() => {\n  const store = useGlobalStore();\n  const handleChange = (userId) => {\n    store.setUserId(userId);\n  };\n  return (\n    <div className=\"header\">\n      <div className=\"title\">Paper Management System</div>\n      <div className=\"user-selector title\">\n        User: &nbsp;\n        <Select\n          value={store.userId}\n          size=\"small\"\n          onChange={handleChange}\n          style={{ width: 130 }}\n          placeholder=\"Set User\"\n        >\n          {userList.map((user) => (\n            <Option value={user} key={user}>\n              {user}\n            </Option>\n          ))}\n        </Select>\n      </div>\n    </div>\n  );\n});\n\nexport default Header;\n","import \"./App.scss\";\nimport { StoreProvider, useGlobalStore } from \"./Store\";\n// import { observer } from \"mobx-react-lite\";\nimport { useEffect } from \"react\";\nimport * as d3 from \"d3\";\nimport ControlView from \"./Views/ControlView\";\nimport UnitView from \"./Views/UnitView\";\nimport DetailView from \"./Views/DetailView\";\nimport Header from \"./Views/Header\";\n\nfunction App() {\n  return (\n    <StoreProvider>\n      <ViewContainer />\n    </StoreProvider>\n  );\n}\n\nexport default App;\n\n// init data\nconst ViewContainer = () => {\n  const store = useGlobalStore();\n  useEffect(() => {\n    const fetchPapers = async () => {\n      const papers = await d3.csv(\"all_papers_data_0302.csv\");\n      await store.setPapers(papers);\n      store.initUserId();\n    };\n    fetchPapers();\n  }, [store]);\n  return (\n    <div className=\"view-container\">\n      <div className=\"header-container\">\n        <Header />\n      </div>\n      <div className=\"main-container\">\n        <div className=\"control-main-container\">\n          <div className=\"control-view-container\">\n            <ControlView />\n          </div>\n          <div className=\"unit-view-container\">\n            <UnitView />\n          </div>\n        </div>\n        <div className=\"detail-view-container\">\n          <DetailView />\n        </div>\n      </div>\n    </div>\n  );\n};\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'antd/dist/antd.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}