{"version":3,"sources":["Server/index.js","Common/mustInclude.js","Common/mostCommon.js","Store/createStoreV0128.js","Store/index.js","Pages/ManagePage/SearchView/index.js","Pages/ManagePage/ControlView/index.js","Pages/ManagePage/UnitView/CircleUnit.js","Pages/ManagePage/UnitView/PaperTooltip.js","Pages/ManagePage/UnitView/index.js","Pages/ManagePage/DetailView/index.js","Pages/ManagePage/index.js","Hooks/useClientRect.js","Pages/AnalysisPage/ProjectView-New/index.js","Common/find_d.js","Pages/AnalysisPage/NetworkView-New/index.js","Pages/AnalysisPage/TopicView-New/index.js","Pages/AnalysisPage/StatisticsView/index.js","Pages/AnalysisPage/PapersTable/index.js","Pages/AnalysisPage/HoverTooltip/index.js","Pages/AnalysisPage/index.js","Common/userList.js","Components/Header/index.js","App.js","reportWebVitals.js","index.js"],"names":["baseUrl","fetchData","url","params","getUrl","includes","qs","stringify","Promise","resolve","reject","fetch","then","res","json","data","catch","err","getPapers","a","getPublicTags","getPrivateTags","uid","setPrivateTags","pid","paper","privateTags","read","tags","filter","join","postData","body","JSON","headers","method","response","mustInclude","list","mustIncludeList","count","slice","forEach","mustItem","i","length","mostCommon","items","n","item2Count","itemList","item","itemCountList","push","sort","b","map","attr2func","publicTags","createStore","currentPage","setCurrentPage","this","window","location","hash","tooltipX","tooltipY","setTooltipPos","x","y","titleSearch","setTitleSearch","text","toLocaleLowerCase","searchPaperDois","papers","title","indexOf","doi","Set","commonAuthors","commonCountries","commonPublicTags","commonPrivateTags","initPapers","update","setPapers","compareAttr","console","log","doi2paper","projection","topics","colors","innerColors","outerColors","internalRefList","internalCitedList","isHighlight","indexByYear","refList","toLowerCase","split","trim","authors","replace","countries","s","part","toUpperCase","year","keywords","word","ref","computedPosition","initPublicTags","runInAction","initPrivateTags","setPaper","attr","value","find","p","userId","toJS","doiUpdateColors","unitXAttr","xAttrSet","add","xAttrList","Array","from","unitYAttr","unitYAttrList","maxUnitBlockPaperCount","unitBlockCount","xAttr","yAttr","unitIndex","Math","max","Object","values","readIndex","splice","batchUpdateColors","setUserId","localStorage","setItem","initUserId","getItem","generateCategory","analysisPapers","label","highlightType","have_read","commonKeywords","category2highlightType","controlTagNameList","category","activeTags","ans","key","outerCategories","isUnitOuterHighlight","outerCategory","tag2color","colorUse","setTagColor","tag","fullTag","_color","d3","updateColor","hightlightAttrs","maxCitationCount","currentSelected","currentSelectedRefSet","currentSelectedCitedSet","isSelected","setCurrentSelected","cancelSelect","currentSelectedPaper","controlIsActive","unitXAttrList","all","highlight","anaHighPapers","minYearAna","maxYearAna","anaCategories","all_timeDis","anaYearRange","highlight_timeDis","anaFilterType","setAnaFilterType","type","clearBrushTrigger","setClearBrushTrigger","fn","anaHighCate","anaHighTag","anaHighTopic","setAnaHighPapersByTag","get","setAnaHighPapersByTopic","topic","anaHighEntityTopic","startYear","endYear","setAnaHighPapersByYear","yearRange","yearStart","yearEnd","anaSelectHighlightPaperDoi","setAnaSelectHighlightPaperDoi","paperDoi","topicColorScale","defaultHighColor","drawProjectionFlag","resetProjectionFlag","num_topics","setNumTopics","num","tryLda","ldaState","setLdaState","tsneState","setTsneState","topics_detail","topics_word_dis","dois","getLdaRes","paper_lda_res","code","setAnaHighEntityTopic","topicIndex","anaHighEntityCitePaperDois","anaHighEntityCitedPaperDois","anaHighTopicIndenpentPaperDois","setHighEntityLinkData","citePaperDois","citedPaperDois","centralIndependentPaperDois","uploadModalShow","setUploadModalShow","updatePaper","oriDoi","newPaper","singleUpdatePaper","anaHoverPaperDoi","anaHoverPaperPositionX","anaHoverPaperPositionY","setAnaHoverPaperDoi","clientX","clientY","removeHoverPaperDoi","storeContext","React","createContext","StoreProvider","children","store","useLocalObservable","Provider","useGlobalStore","useContext","Error","SearchView","handleInput","debounce","e","target","className","onInput","SearchOutlined","ControlView","observer","searchAttr","ControlItem","tagData","useState","setTags","useEffect","initTags","keys","handleClickOption","currentTags","index","clickOption","isSelect","ControlOption","style","background","border","value_format","onClick","CircleUnit","memo","cx","cy","r","opacity","handleClick","isBackgroundActive","handleHover","handleHoverOut","polarX","angle","sin","polarY","cos","innerStepAngle","PI","innerPoints","_","startX","startY","endX","endY","outerR","outerPolarX","outerPolarY","outerStepAngle","outerPoints","id","cursor","onMouseEnter","onMouseLeave","width","height","fill","rx","ry","point","d","stroke","strokeWidth","PaperTooltip","isShow","paperCircle","containerWidth","containerHeight","xRatio","tooltipWidth","bottomStyle","transform","unitLayoutPadding","unitBlockPadding","UnitView","searchPaperDoiSet","svgWidth","setSvgWidth","svgHeight","setSvgHeight","svg","document","querySelector","clientWidth","clientHeight","unitBlockWidth","unitBlockHeight","aspectRatio","floor","blockCountX","ceil","sqrt","xAttr2blockCountX","maxColumnBlockCount","j","xAttr2blockCountX_StartCount","xAttr2blockCountX_StartPos","scale","domain","range","paperCircles","oriData","BlockIndexX","BlockIndexY","circleIndexX","circleIndexY","citationGrey","citationCount","activeColors","has","Title","borderColor","xLabels","yLabels","handleClickPaper","stopPropagation","hoverDoi","setHoverDoi","hoverPaper","hoverPaperCircle","borderOpacity","textAnchor","fontSize","DetailView","_setUploadModalShow","setNewPaper","_newPaper","isArray","editTags","SettingOutlined","size","checkedChildren","CheckOutlined","unCheckedChildren","CloseOutlined","defaultChecked","onChange","editTag","handleChangeTags","visible","onOk","onCancel","centered","new_paper","DetailItem","DetailEditTags","_setTags","newTags","editInputIndex","setEditInputIndex","input","useRef","editInputValue","setEditInputValue","handleEditInputConfirm","inputValue","setInputValue","handleInputConfirm","setInputVisible","inputVisible","onchange","onBlur","onPressEnter","closable","onClose","removeTag","PlusOutlined","ManagePage","useClientRect","svgId","clientRect","setClientRect","node","getClientRects","ProjectionView","num_topics_ing","set_num_topics_ing","padding","nice","contours","topic_i","bandwidth","thresholds","contourOpacity","paperCircleR","paperCircleColor","mainTopic","paperCircleOpacity","paperCircleStrokeWidth","paperCircleDasharray","paperCircleStroke","generateEntity","allPapers","mainPapers","positionX","reduce","positionY","color","anaHighTopicEntity","anaHighTopicPaperDoiSet","anaOtherEntities","entity","intersectionPapers","entityR","getEntitySectorD","start","end","entityOpacity","topicLinks","source","x0","y0","x1","y1","a0_positive","b0_positive","a0_negative","b0_negative","points_dist","delta_x","delta_y","find_d","citeControlPoints","x_1_3_negative","y_1_3_negative","x_2_3_negative","y_2_3_negative","citedControlPoints","x_1_3_positive","y_1_3_positive","x_2_3_positive","y_2_3_positive","interPapers","interCount","interPapersDoiSet","independentPapers","centralEntityIndependentPapers","citeDoiSet","concat","citePapers","citePapersDoiSet","citeLinkCount","citePaperCount","citeSourcePapers","citedDoiSet","citedPapers","citedPapersDoiSet","citedLinkCount","citedPaperCount","_linkWidth","linkWidth","weight","topicLinkOpacity","topicLink","papersSortByCite","reverse","mostCitedPapers","p1","p2","abs","mostCitedPaperDoiSet","labelFontS","clamp","abbr","author","conference","strokeLinejoin","contour","strokeDasharray","strokeLinecap","link","pointerEvents","min","onAfterChange","Option","Select","NetworkView","anaHighPapersDoiSet","paperCountByYear","rectWidth","rectHeight","year2count","doi2indexByYear","rectOpacity","rectStroke","rectStrokeWidth","rectStrokeDashArray","contourFunc","contourColor","internalLinks","refPaperDoi","diagonal","computedPath","x3","y3","x2","y2","linkStroke","linkOpacity","uniform","setUniform","topicsDis","t","topicsDisSum","topicsWidth","unshift","topicX","defaultValue","TopicView","columnWidth","wordHeight","topic_dis","fontS","ratio","headerRatio","timeDistributionRatio","heatmapTitleRatio","heatmapRowRatio","heatmapRowLabelWidthRatio","heatmapRowRectsWidthRatio","heatmapRectHeightRatio","heatmapColors","StatisticsView","headerStyle","timeDisStyle","authorDisStyle","keywordDisStyle","topicDisStyle","anaTagViewData","authorData","keywordData","topicData","topic_index","highlightPapers","allCount","highlightCount","allDis","highLightDis","allDisData","offset","brushStart","brushing","selection","x2year","selectStartYear","selectEndYear","brushEnd","something","keyword","StatisticsHeader","fontWeight","timeDisBarRatio","timeDisLineRatio","timeDisStickRatio","TimeLine","maxCount","yearCount","barWidth","brush","extent","on","timeline","call","move","yearTextX","startYearTextY","endYearTextY","yearTextLinkY","yearTextLinkHeight","TopicDistribution","topicBarChartHeightRatio","HeatmapContent","icon","titleContentHeight","HeatMap","heatmapRowStyle","PapersTable","sortAttr","setSortAttr","order","setOrder","columns","showText","overflow","textOverflow","whiteSpace","textAlign","display","justifyContent","marginRight","column","handleClickPaperRow","HoverTooltip","anaHoverPaper","left","top","conferenceName","abstract","AnalysisPage","userList","Header","switchPage","switchPageShowText","SwitchButton","to","setConferenceName","setPublicTags","batchUpdateItems","setFunc","file","setFile","uploadProps","beforeUpload","placeholder","user","CloudUploadOutlined","form","FormData","append","fileType","name","batchUpdatePapers","UploadOutlined","App","exact","path","component","Analysis","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.8e2881cc.chunk.js","sourcesContent":["import qs from \"qs\";\n\nconst baseUrl = \"http://vis.pku.edu.cn/vis4vis/\";\n// const baseUrl = \"http://127.0.0.1:12357/\";\n\nconst fetchData = (url, params = \"\") => {\n  const getUrl =\n    baseUrl + url + (url.includes(\"?\") ? \"&\" : \"?\") + qs.stringify(params);\n  return new Promise((resolve, reject) => {\n    fetch(getUrl)\n      .then((res) => res.json())\n      .then((data) => resolve(data))\n      .catch((err) => reject(err));\n  });\n};\n\nexport const getPapers = async () => {\n  return await fetchData(\"get_papers\");\n};\n\nexport const getPublicTags = async () => {\n  return await fetchData(\"get_public_tags\");\n};\n\nexport const getPrivateTags = async ({ uid }) => {\n  return await fetchData(\"get_private_tags\", { uid });\n};\n\nexport const setPublicTags = ({ pid, paper }) => {\n  const tags = paper.publicTags;\n  fetchData(\"set_public_tags\", { pid, tags: tags.join(\",\") });\n  return \"OK\";\n};\n\nexport const setPrivateTags = ({ uid, pid, paper }) => {\n  const { privateTags, read } = paper;\n  uid &&\n    fetchData(\"set_private_tags\", {\n      uid,\n      pid,\n      tags: [...privateTags, read && \"read\"].filter((a) => a).join(\",\"),\n    });\n  return \"OK\";\n};\n\nfunction postData(url, data) {\n  return fetch(url, {\n    body: JSON.stringify(data), // must match 'Content-Type' header\n    // cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n    // credentials: 'same-origin', // include, same-origin, *omit\n    headers: {\n      \"user-agent\": \"Mozilla/4.0 MDN Example\",\n      \"content-type\": \"application/json\",\n    },\n    method: \"POST\", // *GET, POST, PUT, DELETE, etc.\n    // mode: 'cors', // no-cors, cors, *same-origin\n    // redirect: 'follow', // manual, *follow, error\n    // referrer: 'no-referrer', // *client, no-referrer\n  }).then((response) => response.json()); // parses response to JSON\n}\n\nexport const getLdaRes = ({ dois, uid, num_topics = 3, ldaState, tsneState }) => {\n  return postData(baseUrl + \"get_lda_results\", { dois, num_topics, uid, ldaState, tsneState });\n};\n\nexport const singleUpdatePaper = (oriDoi, newPaper) => {\n  return postData(baseUrl + \"update_single_paper\", { oriDoi, newPaper });\n};\n\nexport const batchUpdatePapers = ({\n  file,\n  conferenceName,\n  publicTags,\n  privateTags,\n  userId,\n}) => {\n  const form = new FormData();\n  form.append(\"file\", file);\n  form.append(\"conferenceName\", conferenceName);\n  form.append(\"publicTags\", publicTags);\n  form.append(\"privateTags\", privateTags);\n  form.append(\"uid\", userId);\n  const fileType = file.name.split(\".\").slice(-1)[0];\n  form.append(\"fileType\", fileType);\n  return fetch(baseUrl + \"add_papers\", {\n    body: form, // must match 'Content-Type' header\n    // cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n    // credentials: 'same-origin', // include, same-origin, *omit\n    // headers: {\n    //   \"user-agent\": \"Mozilla/4.0 MDN Example\",\n    //   \"content-type\": \"application/json\",\n    // },\n    method: \"POST\", // *GET, POST, PUT, DELETE, etc.\n    // mode: 'cors', // no-cors, cors, *same-origin\n    // redirect: 'follow', // manual, *follow, error\n    // referrer: 'no-referrer', // *client, no-referrer\n  }).then((response) => response.json()); // parses response to JSON\n};\n","// List A 必须包括 List B, 同时长度限制在count内\n\nconst mustInclude = (list, mustIncludeList, count) => {\n  list = list.slice(0, count);\n  mustIncludeList.forEach((mustItem) => {\n    if (!list.includes(mustItem)) {\n      let i = list.length - 1;\n      while (mustIncludeList.includes(list[i])) i -= 1;\n      list[i] = mustItem;\n    }\n  });\n  return list;\n}\n\nexport default mustInclude","const mostCommon = (items, n = 10) => {\n  const item2Count = {};\n  items.forEach((itemList) => {\n    itemList.forEach((item) => {\n      if (item) {\n        if (item in item2Count) {\n          item2Count[item] += 1;\n        } else {\n          item2Count[item] = 1;\n        }\n      }\n    });\n  });\n  const itemCountList = [];\n  for (let item in item2Count) {\n    itemCountList.push({\n      item,\n      count: item2Count[item],\n    });\n  }\n  itemCountList.sort((a, b) => b.count - a.count);\n  return itemCountList.slice(0, n).map(a => a.item);\n};\n\nexport default mostCommon;\n","import * as d3 from \"d3\";\nimport { toJS, runInAction } from \"mobx\";\nimport {\n  getPapers,\n  setPublicTags,\n  setPrivateTags,\n  getPublicTags,\n  getPrivateTags,\n  getLdaRes,\n  singleUpdatePaper,\n} from \"Server\";\nimport { get } from \"lodash\";\nimport { mostCommon, mustInclude, find_d } from \"Common\";\n\nconst debug = true;\n\nconst attr2func = {\n  publicTags: setPublicTags,\n  privateTags: setPrivateTags,\n  read: setPrivateTags,\n};\n\nconst createStore = () => {\n  return {\n    currentPage: \"Management\",\n    setCurrentPage() {\n      this.currentPage = window.location.hash.includes(\"/analysis\")\n        ? \"Analysis\"\n        : \"Management\";\n    },\n    tooltipX: 500,\n    tooltipY: 500,\n    setTooltipPos(x = -1, y = -1) {\n      this.tooltipX = x;\n      this.tooltipY = y;\n    },\n    titleSearch: \"\",\n    setTitleSearch(text) {\n      this.titleSearch = text.toLocaleLowerCase();\n    },\n    get searchPaperDoiSet() {\n      const searchPaperDois = this.titleSearch\n        ? this.papers\n            .filter(\n              (paper) =>\n                paper.title.toLocaleLowerCase().indexOf(this.titleSearch) > -1\n            )\n            .map((paper) => paper.doi)\n        : [];\n      const searchPaperDoiSet = new Set(searchPaperDois);\n      return searchPaperDoiSet;\n    },\n    papers: [],\n    commonAuthors: [],\n    commonCountries: [],\n    commonPublicTags: [],\n    commonPrivateTags: [],\n    // 实际上干两件事，papers + publicTags\n    async initPapers(update = false) {\n      if (this.papers.length === 0 || update) {\n        const papers = await getPapers();\n        this.setPapers(papers);\n      }\n    },\n    async setPapers(papers, compareAttr = \"citationCount\") {\n      debug && console.log(\"==> 初始化Papers\");\n      const doi2paper = {};\n      papers.forEach((paper) => {\n        // 初始化，一些特殊处理，比如如果没有doi或者引用量，就安排一个\n        // if (paper.doi === \"#\") paper.doi = `tmp-${i}`;\n        // if (paper.CitationCount === \"\") paper.CitationCount = 0;\n        // if (paper.Countries === \"#\" || paper.Countries === \"###\")\n        //   paper.Countries = \"\";\n        paper.privateTags = [];\n        paper.projection = [5, 5];\n        paper.topics = [];\n        paper.read = false;\n        paper.publicTags = [];\n        // paper.keywords = [];\n        paper.colors = [];\n        paper.innerColors = [];\n        paper.outerColors = [];\n        paper.internalRefList = [];\n        paper.internalCitedList = [];\n        paper.topics = [[0, 1]];\n        paper.isHighlight = false;\n        paper.indexByYear = 0;\n        paper.refList = paper.refList\n          .toLowerCase()\n          // .split(\";\")\n          .split(/[,;]/)\n          .map((a) => a.trim());\n        paper.doi = paper.doi.toLowerCase();\n        doi2paper[paper.doi] = paper;\n\n        // 提取authors\n        paper.authors = paper.authors\n          .split(\";\")\n          .map((a) => a.trim().replace(/\\{(.*)\\}/, \"$1\"));\n\n        // 提取countries\n        paper.countries = paper.countries\n          .split(\";\")\n          .map((s) => {\n            const part = s\n              .trim()\n              .split(\" \")\n              .map((a) => a.trim())\n              .filter((a) => a);\n            if (part.length === 0) return \"\";\n            let country = part[part.length - 1]\n              .toLowerCase()\n              .replace(/^\\w/, (s) => s.toUpperCase());\n            return country;\n          })\n          .filter((a) => a);\n\n        paper.year = +paper.year;\n\n        paper.keywords = paper.keywords\n          .split(/[;,]/)\n          .map((word) => word.trim().toLowerCase());\n      });\n\n      papers.forEach((paper) => {\n        paper.refList.forEach((ref) => {\n          if (ref in doi2paper) {\n            const refPaper = doi2paper[ref];\n            refPaper.internalCitedList.push(paper.doi);\n            paper.internalRefList.push(ref);\n          }\n        });\n      });\n\n      this.commonAuthors = mostCommon(\n        papers.map((paper) => paper.authors),\n        30\n      );\n      // console.log(\n      //   \"Authors Tags: \",\n      //   mostCommon(\n      //     papers.map((paper) => paper.authors),\n      //     100\n      //   )\n      // );\n      this.commonCountries = mostCommon(\n        papers.map((paper) => paper.countries),\n        30\n      );\n\n      // 先按引用量排序，再去统计分组的排序，这个时间消耗其实还挺大的。\n      papers.sort((a, b) => b[compareAttr] - a[compareAttr]);\n\n      // 开始计算位置\n      this.computedPosition(papers);\n      await this.initPublicTags(papers);\n\n      runInAction(() => {\n        this.papers = papers;\n        this.initPrivateTags();\n      });\n    },\n    setPaper(doi, attr, value) {\n      const paper = this.papers.find((p) => p.doi === doi);\n      paper[attr] = value;\n      // if (attr === \"read\") {\n      //   if (value) {\n      //     paper.privateTags.push(\"read\");\n      //   } else {\n      //     paper.privateTags = [...paper.privateTags].filter(\n      //       (a) => a !== \"read\"\n      //     );\n      //   }\n      // }\n      debug && console.log(\"==> 更新paper数据 by doi:\", doi, attr, value);\n      // attr === \"publicTags\" && setPublicTags(doi, value);\n      attr2func[attr]({\n        uid: this.userId,\n        pid: doi,\n        paper: toJS(paper),\n      });\n      this.doiUpdateColors(doi);\n    },\n    unitXAttr: \"year\",\n    get unitXAttrList() {\n      const xAttrSet = new Set();\n      this.papers.forEach((paper) => {\n        xAttrSet.add(paper[this.unitXAttr]);\n      });\n      const xAttrList = Array.from(xAttrSet);\n      xAttrList.sort((a, b) => b - a);\n      return xAttrList;\n    },\n    unitYAttr: \"conferenceName\",\n    unitYAttrList: [\n      \"SciVis\",\n      \"InfoVis\",\n      \"EuroVis\",\n      \"VAST\",\n      \"PacificVis\",\n      \"Others\",\n    ],\n    maxUnitBlockPaperCount: 0,\n    unitBlockCount: {},\n    computedPosition(papers) {\n      // 每一个block有多少单元\n      const unitBlockCount = {};\n      papers.forEach((paper) => {\n        const xAttr = paper[this.unitXAttr];\n        const yAttr = this.unitYAttrList.includes(paper[this.unitYAttr])\n          ? paper[this.unitYAttr]\n          : this.unitYAttrList[this.unitYAttrList.length - 1];\n        if (!(xAttr in unitBlockCount)) unitBlockCount[xAttr] = {};\n        if (!(yAttr in unitBlockCount[xAttr])) unitBlockCount[xAttr][yAttr] = 0;\n        paper.unitIndex = unitBlockCount[xAttr][yAttr];\n        unitBlockCount[xAttr][yAttr] += 1;\n      });\n      this.maxUnitBlockPaperCount =\n        Math.max(...papers.map((paper) => paper.unitIndex)) * 0.7;\n      this.unitBlockCount = unitBlockCount;\n    },\n\n    async initPublicTags(papers) {\n      const publicTags = await getPublicTags();\n      papers.forEach((paper) => {\n        if (paper.doi in publicTags) {\n          paper.publicTags = publicTags[paper.doi].filter((a) => a);\n        }\n      });\n      runInAction(() => {\n        this.commonPublicTags = mostCommon(Object.values(publicTags), 30);\n      });\n    },\n    async initPrivateTags() {\n      const privateTags = await getPrivateTags({ uid: this.userId });\n\n      runInAction(() => {\n        this.papers.forEach((paper) => {\n          if (paper.doi in privateTags) {\n            const readIndex = privateTags[paper.doi].indexOf(\"read\");\n            if (readIndex > -1) {\n              paper.read = true;\n              privateTags[paper.doi].splice(readIndex, 1);\n            }\n            paper.privateTags = privateTags[paper.doi].filter((a) => a);\n          }\n        });\n        this.commonPrivateTags = mostCommon(Object.values(privateTags), 30);\n      });\n\n      this.batchUpdateColors();\n    },\n\n    userId: \"\",\n    setUserId(userId) {\n      if (userId !== this.userId) {\n        this.userId = userId;\n        debug && console.log(\"==> change userId:\", this.userId);\n        localStorage.setItem(\"paper-management-system-userId\", userId);\n        userId && this.initPrivateTags();\n      }\n    },\n    initUserId() {\n      if (this.userId.length === 0) {\n        const userId = localStorage.getItem(\"paper-management-system-userId\");\n        userId && this.setUserId(userId);\n      }\n    },\n\n    get controlTagNameList() {\n      return this.generateCategory(10);\n    },\n    // get anaCategories() {\n    //   return this.generateCategory(18, true);\n    // },\n    get anaCategories() {\n      const count = 50;\n      const have_read = false;\n      const countries = mustInclude(\n        mostCommon(\n          this.analysisPapers.map((paper) => paper.countries),\n          30\n        ),\n        [\"Japan\", \"Korea\"],\n        count\n      );\n      const authors = mostCommon(\n        this.analysisPapers.map((paper) => paper.authors),\n        30\n      );\n      const privateTags = mustInclude(\n        this.commonPrivateTags,\n        have_read ? [\"read\"] : [],\n        count\n      );\n      const publicTags = mustInclude(this.commonPublicTags, [], count);\n      const keywords = mustInclude(\n        mostCommon(\n          this.analysisPapers.map((paper) => paper.keywords),\n          30\n        ),\n        [],\n        count\n      );\n      return [\n        {\n          label: \"Country\",\n          value: \"countries\",\n          list: countries,\n          highlightType: \"outer\",\n        },\n        {\n          label: \"Author\",\n          value: \"authors\",\n          list: authors,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Keywords\",\n          value: \"keywords\",\n          list: keywords,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Private Tag\",\n          value: \"privateTags\",\n          list: privateTags,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Public Tag\",\n          value: \"publicTags\",\n          list: publicTags,\n          highlightType: \"inner\",\n        },\n      ];\n    },\n\n    get commonKeywords() {\n      return mostCommon(\n        this.papers.map((paper) => paper.keywords),\n        30\n      );\n    },\n    generateCategory(count, have_read = false) {\n      const countries = mustInclude(\n        this.commonCountries,\n        [\"Japan\", \"Korea\"],\n        count\n      );\n      const authors = mustInclude(this.commonAuthors, [\"Xiaoru Yuan\"], count);\n      const privateTags = mustInclude(\n        this.commonPrivateTags,\n        have_read ? [\"read\"] : [],\n        count\n      );\n      const publicTags = mustInclude(this.commonPublicTags, [], count);\n      const keywords = mustInclude(this.commonKeywords, [], count);\n      return [\n        {\n          label: \"Country\",\n          value: \"countries\",\n          list: countries,\n          highlightType: \"outer\",\n        },\n        {\n          label: \"Author\",\n          value: \"authors\",\n          list: authors,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Keywords\",\n          value: \"keywords\",\n          list: keywords,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Private Tag\",\n          value: \"privateTags\",\n          list: privateTags,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Public Tag\",\n          value: \"publicTags\",\n          list: publicTags,\n          highlightType: \"inner\",\n        },\n      ];\n    },\n    get category2highlightType() {\n      const category2highlightType = {};\n      this.controlTagNameList.forEach((category) => {\n        category2highlightType[category.value] = category.highlightType;\n      });\n      return category2highlightType;\n    },\n    activeTags: {\n      countries: [],\n      authors: [],\n      privateTags: [],\n      publicTags: [],\n      keywords: [],\n    },\n    // 判断 至少有一个控制器被激活\n    get controlIsActive() {\n      let ans = false;\n      for (let key in this.activeTags) {\n        if (this.activeTags[key].length > 0) {\n          ans = true;\n        }\n      }\n      return ans;\n    },\n    // 判断 至少有一个outer被激活\n    get isUnitOuterHighlight() {\n      const outerCategories = this.controlTagNameList\n        .filter((category) => category.highlightType === \"outer\")\n        .map((category) => category.value);\n      let isUnitOuterHighlight = false;\n      outerCategories.forEach((outerCategory) => {\n        if (this.activeTags[outerCategory].length > 0)\n          isUnitOuterHighlight = true;\n      });\n      return isUnitOuterHighlight;\n    },\n    tag2color: {},\n    colorUse: {},\n    setTagColor(tag, category) {\n      debug && console.log(\"==> 设置tag颜色:\", category, tag);\n      const fullTag = `${category}---${tag}`;\n      if (fullTag in this.tag2color) {\n        // 回收该颜色\n        this.colorUse[this.tag2color[fullTag]] = false;\n        delete this.tag2color[fullTag];\n        this.activeTags[category] = [...this.activeTags[category]].filter(\n          (a) => a !== tag\n        );\n      } else {\n        // 分配一个新的颜色\n        this.activeTags[category].push(tag);\n        let i = 0;\n        let _color = d3.schemeTableau10[i];\n        while (this.colorUse[_color]) {\n          i += 1;\n          if (i === 10) {\n            _color = \"black\";\n            break;\n          }\n          _color = d3.schemeTableau10[i];\n        }\n        this.tag2color[fullTag] = _color;\n        this.colorUse[_color] = true;\n      }\n      this.batchUpdateColors();\n    },\n    batchUpdateColors() {\n      this.papers.forEach((paper) => {\n        paper.colors = [];\n        paper.innerColors = [];\n        paper.outerColors = [];\n        this.updateColor(paper);\n      });\n    },\n    doiUpdateColors(doi) {\n      const paper = this.papers.find((p) => p.doi === doi);\n      paper.colors = [];\n      paper.innerColors = [];\n      paper.outerColors = [];\n      this.updateColor(paper);\n    },\n    updateColor(paper) {\n      const isReadTagActive = this.activeTags.privateTags.indexOf(\"read\") > -1;\n      if (isReadTagActive && paper.read) {\n        paper.colors.push(this.tag2color[\"privateTags---read\"]);\n        paper.innerColors.push(this.tag2color[\"privateTags---read\"]);\n      }\n\n      for (let category in this.activeTags) {\n        const hightlightAttrs = this.activeTags[category];\n        if (this.category2highlightType[category] === \"inner\") {\n          hightlightAttrs.forEach((attr) => {\n            if (paper[category].indexOf(attr) > -1) {\n              const fullTag = `${category}---${attr}`;\n              paper.innerColors.push(this.tag2color[fullTag]);\n            }\n          });\n        } else {\n          hightlightAttrs.forEach((attr) => {\n            if (paper[category].indexOf(attr) > -1) {\n              const fullTag = `${category}---${attr}`;\n              paper.outerColors.push(this.tag2color[fullTag]);\n            }\n          });\n        }\n        hightlightAttrs.forEach((attr) => {\n          if (paper[category].indexOf(attr) > -1) {\n            const fullTag = `${category}---${attr}`;\n            paper.colors.push(this.tag2color[fullTag]);\n          }\n        });\n      }\n    },\n    maxCitationCount: 200,\n\n    currentSelected: \"\",\n    currentSelectedRefSet: new Set(),\n    currentSelectedCitedSet: new Set(),\n    isSelected: false,\n    setCurrentSelected(doi) {\n      debug && console.log(\"==> 选中文章:\", doi);\n      this.currentSelected = doi;\n      this.isSelected = !!doi;\n\n      const paper = this.papers.find((paper) => paper.doi === doi);\n      this.currentSelectedRefSet = new Set(paper.internalRefList);\n      this.currentSelectedCitedSet = new Set(paper.internalCitedList);\n    },\n    cancelSelect() {\n      debug && console.log(\"==> 点击背景，取消论文选中状态\");\n      this.isSelected = false;\n    },\n    get currentSelectedPaper() {\n      const currentSelectedPaper = this.papers.find(\n        (paper) => paper.doi === this.currentSelected\n      );\n      debug && console.log(\"currentSelectedPaper\", toJS(currentSelectedPaper));\n      return currentSelectedPaper;\n    },\n\n    get analysisPapers() {\n      return this.controlIsActive\n        ? this.papers.filter(\n            (paper) =>\n              paper.innerColors.length > 0 || paper.outerColors.length > 0\n          )\n        : this.papers;\n    },\n    get anaTimeData() {\n      const timeList = this.unitXAttrList.map((a) => +a).sort();\n      return timeList.map((year) => ({\n        x: year,\n        all: this.analysisPapers.filter((paper) => +paper.year === year).length,\n        highlight: this.anaHighPapers.filter((paper) => +paper.year === year)\n          .length,\n      }));\n    },\n\n    get minYearAna() {\n      return d3.min(this.analysisPapers.map((paper) => +paper.year));\n    },\n    get maxYearAna() {\n      return d3.max(this.analysisPapers.map((paper) => +paper.year));\n    },\n    get anaYearRange() {\n      return d3.range(this.minYearAna, this.maxYearAna + 1, 1);\n    },\n    get anaTagViewData() {\n      return this.anaCategories.map((category) => {\n        const { label, value } = category;\n        const data = category.list.map((tag) =>\n          tag === \"read\"\n            ? {\n                label: \"read\",\n                all: this.analysisPapers.filter((paper) => paper.read).length,\n                highlight: this.anaHighPapers.filter((paper) => paper.read)\n                  .length,\n                all_timeDis: this.anaYearRange.map(\n                  (year) =>\n                    this.analysisPapers.filter(\n                      (paper) => paper.read && paper.year == year\n                    ).length\n                ),\n                highlight_timeDis: this.anaYearRange.map(\n                  (year) =>\n                    this.anaHighPapers.filter(\n                      (paper) => paper.read && paper.year == year\n                    ).length\n                ),\n              }\n            : {\n                label: tag,\n                all: this.analysisPapers.filter((paper) =>\n                  paper[category.value].includes(tag)\n                ).length,\n                highlight: this.anaHighPapers.filter((paper) =>\n                  paper[category.value].includes(tag)\n                ).length,\n                all_timeDis: this.anaYearRange.map(\n                  (year) =>\n                    this.analysisPapers.filter(\n                      (paper) =>\n                        paper[category.value].includes(tag) &&\n                        paper.year == year\n                    ).length\n                ),\n                highlight_timeDis: this.anaYearRange.map(\n                  (year) =>\n                    this.anaHighPapers.filter(\n                      (paper) =>\n                        paper[category.value].includes(tag) &&\n                        paper.year == year\n                    ).length\n                ),\n              }\n        );\n        return {\n          label,\n          value,\n          data,\n        };\n      });\n    },\n\n    anaFilterType: \"none\", // \"none\", \"year\", \"tag\", \"topic\", \"lasso\"\n    setAnaFilterType(type) {\n      debug && console.log(\"setAnaFilterType\", type);\n      this.anaFilterType = type;\n    },\n    clearBrushTrigger: () => {},\n    setClearBrushTrigger(fn) {\n      this.clearBrushTrigger = fn;\n    },\n\n    anaHighCate: \"\",\n    anaHighTag: \"\",\n    anaHighTopic: \"\",\n    anaHighPapers: [],\n    setAnaHighPapersByTag({ anaHighCate, anaHighTag }) {\n      debug && console.log(\"setAnaHighPapersByTag\", anaHighCate, anaHighTag);\n      this.clearBrushTrigger();\n      // this.setAnaHighPapersByYear([0, 0])\n      if (this.anaHighCate === anaHighCate && this.anaHighTag === anaHighTag) {\n        this.anaHighTag = \"none\";\n        this.setAnaFilterType(\"none\");\n        this.anaHighPapers = this.analysisPapers;\n      } else {\n        this.anaHighCate = anaHighCate;\n        this.anaHighTag = anaHighTag;\n        this.setAnaFilterType(anaHighCate);\n        this.anaHighPapers = this.analysisPapers.filter((paper) =>\n          get(paper, anaHighCate, []).includes(anaHighTag)\n        );\n      }\n    },\n    setAnaHighPapersByTopic(topic) {\n      debug && console.log(\"setAnaHighPapersByTopic\", topic);\n      this.clearBrushTrigger();\n      if (this.anaFilterType === \"topic\" && this.anaHighTopic === topic) {\n        this.anaHighTopic = \"none\";\n        this.anaHighTag = \"none\";\n        this.anaHighEntityTopic = -1;\n        this.setAnaFilterType(\"none\");\n        this.anaHighPapers = this.analysisPapers;\n      } else {\n        this.anaHighTopic = topic;\n        this.anaHighEntityTopic = -1;\n        this.anaHighTag = `topic ${topic + 1}`;\n        this.setAnaFilterType(\"topic\");\n        this.anaHighPapers = this.analysisPapers.filter((paper) =>\n          paper.topics.map((a) => a[0]).includes(topic)\n        );\n      }\n    },\n    startYear: 0,\n    endYear: 0,\n    setAnaHighPapersByYear(yearRange) {\n      debug && console.log(\"setAnaHighPapersByYear\", yearRange);\n      // this.setAnaFilterType('year');\n      const [yearStart, yearEnd] = yearRange;\n      this.startYear = yearStart;\n      this.endYear = yearEnd;\n      this.anaHighTag = `${yearStart}-${yearEnd}`;\n      this.anaHighPapers = this.analysisPapers.filter(\n        (paper) => +paper.year >= yearStart && +paper.year <= yearEnd\n      );\n    },\n    anaSelectHighlightPaperDoi: \"\",\n    setAnaSelectHighlightPaperDoi(paperDoi) {\n      debug && console.log(\"setAnaSelectHighlightPaper\", paperDoi);\n      if (this.anaSelectHighlightPaperDoi === paperDoi) {\n        debug && console.log(\"reset anaSelectHighlightPaperDoi\");\n        this.anaSelectHighlightPaperDoi = \"\";\n      } else {\n        this.anaSelectHighlightPaperDoi = paperDoi;\n      }\n    },\n    get anaSelectHighlightPaper() {\n      return (\n        this.analysisPapers.find(\n          (paper) => paper.doi === this.anaSelectHighlightPaperDoi\n        ) || {}\n      );\n    },\n    topicColorScale: d3.schemeTableau10.slice(1),\n    defaultHighColor: d3.schemeTableau10[0],\n    drawProjectionFlag: false,\n    resetProjectionFlag() {\n      debug && console.log(\"reset drawProjectionFlag\");\n      this.drawProjectionFlag = false;\n    },\n    num_topics: 4,\n    setNumTopics(num) {\n      this.num_topics = num;\n      this.tryLda();\n    },\n    ldaState: 82970,\n    setLdaState(num) {\n      this.ldaState = num;\n      this.tryLda();\n    },\n    tsneState: 12711,\n    setTsneState(num) {\n      this.tsneState = num;\n      this.tryLda();\n    },\n    topics_detail: [],\n    topics_word_dis: [],\n    tryLda() {\n      const dois = this.analysisPapers.map((paper) => paper.doi);\n      const uid = this.userId;\n      const num_topics = this.num_topics;\n      const ldaState = this.ldaState;\n      const tsneState = this.tsneState;\n      debug && console.log(\"try lda Start!\", num_topics, ldaState, tsneState);\n      getLdaRes({ dois, uid, num_topics, ldaState, tsneState }).then((data) => {\n        debug && console.log(\"try lda OK!\", data);\n        runInAction(() => {\n          // console.log(\"data\", data);\n          const {\n            paper_lda_res,\n            topics_detail,\n            code = \"success\",\n            topics_word_dis,\n          } = data;\n          if (code === \"success\") {\n            this.analysisPapers.forEach((paper) => {\n              if (paper.doi in paper_lda_res) {\n                paper.projection = paper_lda_res[paper.doi].projection;\n                paper.topics = paper_lda_res[paper.doi].topics.sort(\n                  (a, b) => b[1] - a[1]\n                );\n              } else {\n                paper.projection = [5, 5];\n                paper.topics = [];\n              }\n            });\n            this.drawProjectionFlag = true;\n            this.topics_detail = topics_detail;\n            this.topics_word_dis = topics_word_dis;\n            // 初始化一下\n            this.anaHighPapers = this.analysisPapers;\n            this.startYear = d3.min(\n              this.analysisPapers.map((paper) => +paper.year)\n            );\n            this.endYear = d3.max(\n              this.analysisPapers.map((paper) => +paper.year)\n            );\n          }\n        });\n      });\n    },\n\n    anaHighEntityTopic: -1,\n    setAnaHighEntityTopic(topicIndex) {\n      if (this.anaHighEntityTopic === topicIndex) {\n        debug && console.log(\"setAnaHighEntityTopic\", false);\n        this.anaHighEntityTopic = -1;\n      } else {\n        debug && console.log(\"setAnaHighEntityTopic\", topicIndex);\n        this.anaHighEntityTopic = topicIndex;\n      }\n    },\n    anaHighEntityCitePaperDois: [],\n    anaHighEntityCitedPaperDois: [],\n    anaHighTopicIndenpentPaperDois: [],\n    setHighEntityLinkData(\n      citePaperDois,\n      citedPaperDois,\n      centralIndependentPaperDois\n    ) {\n      debug && console.log(\"citePaperDois\", citePaperDois);\n      debug && console.log(\"citedPaperDois\", citedPaperDois);\n      // debug &&\n      //   console.log(\"centralIndependentPaperDois\", centralIndependentPaperDois);\n      this.anaHighEntityCitePaperDois = citePaperDois;\n      this.anaHighEntityCitedPaperDois = citedPaperDois;\n      this.anaHighTopicIndenpentPaperDois = centralIndependentPaperDois;\n    },\n\n    // upload\n    uploadModalShow: false,\n    setUploadModalShow() {\n      debug && console.log(\"setUploadModalShow\", !this.uploadModalShow);\n      this.uploadModalShow = !this.uploadModalShow;\n    },\n\n    updatePaper(oriDoi, newPaper) {\n      debug && console.log(\"update paper info\", oriDoi, newPaper);\n      // newPaper.authors = newPaper.authors.join(\";\")\n      // newPaper.countries = newPaper.countries.join(\";\")\n      // newPaper.keywords = newPaper.keywords.join(\";\")\n      // newPaper.refList = newPaper.refList.join(\";\")\n      singleUpdatePaper(oriDoi, newPaper).then(() => {\n        runInAction(() => {\n          debug && console.log(\"singleUpdatePaper finished\", oriDoi, newPaper);\n          this.initPapers();\n        });\n      });\n    },\n\n    anaHoverPaperDoi: \"\",\n    get anaHoverPaper() {\n      return this.analysisPapers.find(\n        (paper) => paper.doi === this.anaHoverPaperDoi\n      );\n    },\n    anaHoverPaperPositionX: 0,\n    anaHoverPaperPositionY: 0,\n    setAnaHoverPaperDoi(clientX, clientY, doi) {\n      // debug && console.log(\"set hover paper doi\", clientX, clientY, doi);\n      this.anaHoverPaperDoi = doi;\n      this.anaHoverPaperPositionX = clientX;\n      this.anaHoverPaperPositionY = clientY;\n    },\n    removeHoverPaperDoi() {\n      // debug && console.log(\"remover hover paper doi\");\n      this.anaHoverPaperDoi = \"\";\n    },\n  };\n};\n\nexport default createStore;\n","import React from \"react\";\nimport createStore from \"./createStoreV0128\";\nimport { useLocalObservable } from \"mobx-react-lite\";\n\nconst storeContext = React.createContext(null);\n\nexport const StoreProvider = ({ children }) => {\n  const store = useLocalObservable(createStore);\n  return (\n    <storeContext.Provider value={store}>{children}</storeContext.Provider>\n  );\n};\n\nexport const useGlobalStore = () => {\n  const store = React.useContext(storeContext);\n  if (!store) {\n    throw new Error(\"no Provider\");\n  }\n  return store;\n};\n","import React from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"Store\";\nimport { debounce } from \"lodash\";\nimport { SearchOutlined } from \"@ant-design/icons\";\n// import {observer} from \"mobx-react-lite\";\n\nconst SearchView = () => {\n  const store = useGlobalStore();\n  // const { searchPaperDoiSet } = store;\n  // console.log(\"=====> searchPaperDoiSet\", searchPaperDoiSet);\n  const handleInput = debounce((e) => {\n    // console.log(\"===>\", e.target.value);\n    store.setTitleSearch(e.target.value);\n  }, 200);\n  return (\n    <div className=\"search-view\">\n      <div className=\"search-view-input\">\n        <input onInput={handleInput} />\n      </div>\n\n      <div className=\"search-view-icon\">\n        <SearchOutlined />\n      </div>\n    </div>\n  );\n};\n\nexport default SearchView;\n","import React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\n// import { toJS } from \"mobx\";\nimport SearchView from \"../SearchView\";\n\nconst ControlView = observer(() => {\n  const store = useGlobalStore();\n  const { controlTagNameList } = store;\n  return (\n    <div className=\"control-view\">\n      <div className=\"control-item\">\n        <div className=\"control-item-title\">Title Search</div>\n        <div className=\"control-item-search-input\">\n          <SearchView searchAttr={\"title\"} />\n        </div>\n      </div>\n\n      {controlTagNameList.map((tag) => (\n        <ControlItem key={tag.label} tagData={tag} />\n      ))}\n    </div>\n  );\n});\n\nexport default ControlView;\n\nconst ControlItem = observer(({ tagData }) => {\n  const store = useGlobalStore();\n  const { tag2color, papers } = store;\n  const [tags, setTags] = useState([]);\n  // 又是一个外挂逻辑，从ana界面切回来以后，需要初始化tag item，理论上这个应该放在store统一处理\n  useEffect(() => {\n    const initTags = Object.keys(tag2color)\n      .filter((tag) => tag.split(\"---\")[0] === tagData.value)\n      .map((tag) => tag.split(\"---\")[1])\n      .filter((tag) => tagData.list.indexOf(tag) > -1);\n    setTags(initTags);\n  }, []);\n  const handleClickOption = (value) => {\n    const currentTags = [...tags];\n    const index = currentTags.indexOf(value);\n    if (index > -1) {\n      currentTags.splice(index, 1);\n      setTags(currentTags);\n    } else {\n      currentTags.push(value);\n      setTags(currentTags);\n    }\n    store.setTagColor(value, tagData.value);\n  };\n\n  return (\n    <div className=\"control-item\">\n      <div className=\"control-item-title\">{tagData.label}</div>\n      <div className=\"control-item-options\">\n        {tagData.list.map((item) => (\n          <ControlOption\n            key={item}\n            value={item}\n            clickOption={handleClickOption}\n            isSelect={\n              tags.indexOf(item) > -1 && tag2color[`${tagData.value}---${item}`]\n            }\n            count={\n              tags.indexOf(item) > -1\n                ? papers.filter((paper) => paper[tagData.value].includes(item))\n                    .length\n                : 0\n            }\n          />\n        ))}\n      </div>\n    </div>\n  );\n});\n\nconst ControlOption = ({ value, clickOption, isSelect, count = 0 }) => {\n  const className = [\"control-item-option\", isSelect && \"option-active\"]\n    .filter((a) => a)\n    .join(\" \");\n  const style = isSelect\n    ? { background: isSelect, border: `1px solid ${isSelect}` }\n    : {};\n  const value_format = value === \"Usa\" ? \"USA\" : value;\n  return (\n    <div className={className} onClick={() => clickOption(value)} style={style}>\n      {value_format} {isSelect && `(${count})`}\n    </div>\n  );\n};\n","import React from \"react\";\n\nconst CircleUnit = React.memo(\n  ({\n    cx,\n    cy,\n    r,\n    // colors,\n    opacity,\n    doi,\n    handleClick,\n    // borderColor,\n    // borderOpacity,\n    title,\n    innerColors,\n    outerColors,\n    isBackgroundActive,\n    handleHover,\n    handleHoverOut,\n  }) => {\n    const polarX = (angle) => cx + Math.sin(angle) * r;\n    const polarY = (angle) => cy + Math.cos(angle) * r;\n    const innerStepAngle = (2 * Math.PI) / innerColors.length;\n    const innerPoints = innerColors.map((_, i) => ({\n      startX: polarX(innerStepAngle * i),\n      startY: polarY(innerStepAngle * i),\n      endX: polarX(innerStepAngle * (i + 1)),\n      endY: polarY(innerStepAngle * (i + 1)),\n    }));\n\n    // console.log('outerColors', outerColors)\n    const outerR = r * 1.5;\n    const outerPolarX = (angle) => cx + Math.sin(angle) * outerR;\n    const outerPolarY = (angle) => cy + Math.cos(angle) * outerR;\n    const outerStepAngle = (2 * Math.PI) / outerColors.length;\n    const outerPoints = outerColors.map((_, i) => ({\n      startX: outerPolarX(outerStepAngle * i),\n      startY: outerPolarY(outerStepAngle * i),\n      endX: outerPolarX(outerStepAngle * (i + 1)),\n      endY: outerPolarY(outerStepAngle * (i + 1)),\n    }));\n\n    // const borderOpacity = isSelect ? 1 : 0;\n\n    return (\n      <g\n        id=\"unit-g\"\n        onClick={(e) => handleClick(e, doi)}\n        cursor=\"pointer\"\n        onMouseEnter={() => handleHover(doi)}\n        onMouseLeave={() => handleHoverOut()}\n      >\n        <title>{title}</title>\n\n        {isBackgroundActive && (\n          <g id=\"unit-background-g\">\n            <rect\n              x={cx - 1.6 * r}\n              y={cy - 1.6 * r}\n              width={r * 3.2}\n              height={r * 3.2}\n              fill=\"#fc8d62\"\n              rx={r * 0.4}\n              ry={r * 0.4}\n            />\n            <circle cx={cx} cy={cy} r={1.3 * r} fill=\"#eee\" />\n          </g>\n        )}\n        <g id=\"unit-border-g\">\n          {/* <circle\n            cx={cx}\n            cy={cy}\n            r={1.4 * r}\n            fill=\"none\"\n            stroke={borderColor}\n            strokeWidth={0.6 * r}\n            opacity={borderOpacity}\n          /> */}\n          {outerPoints.length > 1 ? (\n            outerPoints.map((point, i) => (\n              <path\n                key={i}\n                d={`M ${cx} ${cy}\n              L ${point.startX} ${point.startY}\n              A ${outerR} ${outerR} 0 0 0 ${point.endX} ${point.endY}\n              Z\n              `}\n                // stroke=\"white\"\n                fill={outerColors[i]}\n                // strokeWidth={0.1 * r}\n                // fill-opacity=\"0.2\"\n              />\n            ))\n          ) : (\n            <circle\n              cx={cx}\n              cy={cy}\n              r={outerR}\n              fill={outerColors.length > 0 ? outerColors[0] : \"none\"}\n              // stroke=\"red\"\n              // strokeWidth={0.15 * r}\n            />\n          )}\n          {/* {outerPoints.length > 0 && <circle\n            cx={cx}\n            cy={cy}\n            r={1.2 * r}\n            fill=\"white\"\n            // stroke={borderColor}\n            // strokeWidth={0.6 * r}\n            // opacity={borderOpacity}\n          />} */}\n          <circle\n            cx={cx}\n            cy={cy}\n            r={1.1 * r}\n            fill=\"white\"\n            // stroke={borderColor}\n            // strokeWidth={0.6 * r}\n            opacity={outerPoints.length > 0 ? 1 : 0}\n          />\n        </g>\n        <g id=\"unit-sector-g\" opacity={opacity}>\n          {innerPoints.length > 1 ? (\n            innerPoints.map((point, i) => (\n              <path\n                key={i}\n                d={`M ${cx} ${cy}\n              L ${point.startX} ${point.startY}\n              A ${r} ${r} 0 0 0 ${point.endX} ${point.endY}\n              Z\n              `}\n                stroke=\"white\"\n                fill={innerColors[i]}\n                strokeWidth={0.1 * r}\n                // fill-opacity=\"0.2\"\n              />\n            ))\n          ) : (\n            <circle\n              cx={cx}\n              cy={cy}\n              r={r}\n              fill={innerColors[0]}\n              // stroke=\"red\"\n              // strokeWidth={0.15 * r}\n            />\n          )}\n        </g>\n      </g>\n    );\n  }\n);\n\nexport default CircleUnit;\n","import React from \"react\";\nimport { get } from \"lodash\";\n\nconst tooltipWidthRatio = 0.25;\n\nconst PaperTooltip = ({\n  isShow,\n  paper,\n  paperCircle,\n  containerWidth,\n  containerHeight,\n}) => {\n  const xRatio = paperCircle.cx / containerWidth;\n  const tooltipWidth = containerWidth * tooltipWidthRatio;\n  const tooltipX = paperCircle.cx - tooltipWidth * xRatio;\n  const tooltipY = paperCircle.cy + 15;\n  const bottomStyle =\n    paperCircle.cy + 200 > containerHeight ? \"translateY(-150%)\" : \"\";\n  const style = {\n    transform: `translate(${tooltipX}px,${tooltipY}px) ${bottomStyle}`,\n    opacity: isShow ? 1 : 0,\n  };\n  return (\n    <div className=\"unit-tooltip\" style={style}>\n      <div className=\"unit-tooltip-title\">{get(paper, \"title\", \"\")}</div>\n      <div className=\"unit-tooltip-authors\">\n        {get(paper, \"authors\", []).join(\"; \")} ({paper.year})\n      </div>\n    </div>\n  );\n};\n\nexport default PaperTooltip;\n","import React, { useEffect, useState } from \"react\";\nimport \"./index.scss\";\nimport CircleUnit from \"./CircleUnit\";\nimport PaperTooltip from \"./PaperTooltip\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { toJS } from \"mobx\";\nimport { get } from \"lodash\";\nimport * as d3 from \"d3\";\n\nconst unitLayoutPadding = {\n  top: 30,\n  left: 40,\n  right: 15,\n  bottom: 1,\n};\n\nconst unitBlockPadding = {\n  top: 2,\n  left: 3,\n  right: 3,\n  bottom: 1,\n};\n\nconst UnitView = observer(() => {\n  const store = useGlobalStore();\n  const {\n    papers,\n    unitXAttr,\n    unitYAttr,\n    unitXAttrList,\n    unitYAttrList,\n    unitBlockCount,\n    maxUnitBlockPaperCount,\n    // doi2paperBlockPos,\n    // doi2privateTags,\n    // doi2publicTags,\n    // doi2comments,\n    // doi2colors,\n    controlIsActive,\n    isUnitOuterHighlight,\n    currentSelected,\n    setCurrentSelected,\n    isSelected,\n    cancelSelect,\n    currentSelectedRefSet,\n    currentSelectedCitedSet,\n    searchPaperDoiSet,\n    // setTooltipPos,\n    // tooltipX,\n    // tooltipY,\n  } = store;\n\n  // const svg = document.querySelector(\"#unit-svg\");\n  // const svgWidth =\n  //   svg.clientWidth - unitLayoutPadding.left - unitLayoutPadding.right;\n  // const svgHeight =\n  //   svg.clientHeight - unitLayoutPadding.top - unitLayoutPadding.bottom;\n\n  const [svgWidth, setSvgWidth] = useState(0);\n  const [svgHeight, setSvgHeight] = useState(0);\n\n  // 初始化svg长宽\n  useEffect(() => {\n    const svg = document.querySelector(\"#unit-svg\");\n    setSvgWidth(\n      svg.clientWidth - unitLayoutPadding.left - unitLayoutPadding.right\n    );\n    setSvgHeight(\n      svg.clientHeight - unitLayoutPadding.top - unitLayoutPadding.bottom\n    );\n  }, []);\n  const unitBlockWidth =\n    unitXAttrList.length > 0\n      ? svgWidth / unitXAttrList.length -\n        unitBlockPadding.left -\n        unitBlockPadding.right\n      : 0;\n  const unitBlockHeight =\n    unitYAttrList.length > 0\n      ? svgHeight / unitYAttrList.length -\n        unitBlockPadding.top -\n        unitBlockPadding.bottom\n      : 0;\n  // console.log(unitBlockWidth, unitBlockHeight);\n\n  const aspectRatio = Math.floor(\n    unitBlockWidth > 0 ? unitBlockHeight / unitBlockWidth : 1\n  );\n\n  const blockCountX = Math.ceil(\n    Math.sqrt(maxUnitBlockPaperCount / aspectRatio)\n  );\n  // console.log('blockCountX', blockCountX);\n\n  const xAttr2blockCountX = unitXAttrList.map((xAttr, i) => {\n    const maxColumnBlockCount = Math.max(\n      ...unitYAttrList.map((yAttr, j) => get(unitBlockCount, [xAttr, yAttr], 0))\n    );\n    let blockCountX = Math.ceil(\n      Math.sqrt(maxUnitBlockPaperCount / aspectRatio)\n    );\n    if (maxColumnBlockCount > maxUnitBlockPaperCount) {\n      blockCountX += 1;\n    }\n    return blockCountX;\n  });\n  // console.log(\"xAttr2blockCountX\", xAttr2blockCountX);\n\n  // const blockCountY = Math.ceil(aspectRatio * blockCountX);\n\n  let r = unitBlockWidth / blockCountX;\n  // console.log(\"r\", r);\n\n  const xAttr2blockCountX_StartCount = [0];\n  const xAttr2blockCountX_StartPos = [0];\n\n  for (let i = 1; i < unitXAttrList.length; i++) {\n    xAttr2blockCountX_StartCount.push(\n      xAttr2blockCountX_StartCount[i - 1] + xAttr2blockCountX[i - 1]\n    );\n  }\n\n  r =\n    (svgWidth -\n      (unitBlockPadding.left + unitBlockPadding.right) * unitXAttrList.length) /\n    (xAttr2blockCountX_StartCount[xAttr2blockCountX_StartCount.length - 1] +\n      xAttr2blockCountX[xAttr2blockCountX.length - 1]);\n  // console.log(\"new r\", r);\n\n  for (let i = 1; i < unitXAttrList.length; i++) {\n    xAttr2blockCountX_StartPos.push(\n      xAttr2blockCountX_StartCount[i] * r +\n        (unitBlockPadding.left + unitBlockPadding.right) * i\n    );\n  }\n  // console.log(\"xAttr2blockCountX_StartCount\", xAttr2blockCountX_StartCount);\n  // console.log(\"xAttr2blockCountX_StartPos\", xAttr2blockCountX_StartPos);\n  const scale = d3.scaleLinear().domain([0, 100]).range([0.25, 0.8]);\n  const citeCount2grey = (count) => d3.interpolateGreys(scale(count));\n  const paperCircles = papers.map((paper) => {\n    const paperCircle = {};\n    paperCircle.oriData = toJS(paper);\n\n    paperCircle.BlockIndexX = unitXAttrList.indexOf(paper[unitXAttr]);\n    paperCircle.BlockIndexY = unitYAttrList.includes(paper[unitYAttr])\n      ? unitYAttrList.indexOf(paper[unitYAttr])\n      : unitYAttrList.length - 1;\n\n    const doi = paper.doi;\n    paperCircle.doi = doi;\n\n    paperCircle.circleIndexX =\n      paper.unitIndex % xAttr2blockCountX[paperCircle.BlockIndexX];\n    paperCircle.circleIndexY = Math.floor(\n      paper.unitIndex / xAttr2blockCountX[paperCircle.BlockIndexX]\n    );\n\n    // paperCircle.cx =\n    //   unitLayoutPadding.left +\n    //   paperCircle.BlockIndexX *\n    //     (unitBlockWidth + unitBlockPadding.left + unitBlockPadding.right) +\n    //   (paperCircle.circleIndexX + 0.5) * r;\n    paperCircle.cy =\n      unitLayoutPadding.top +\n      paperCircle.BlockIndexY *\n        (unitBlockHeight + unitBlockPadding.top + unitBlockPadding.bottom) +\n      (paperCircle.circleIndexY + 0.5) * r;\n\n    // 外挂逻辑\n    if (paper[\"year\"] === \"2004\" && paperCircle.BlockIndexY > 0) {\n      paperCircle.cy += 50 - paperCircle.BlockIndexY * 10;\n    }\n\n    paperCircle.cx =\n      unitLayoutPadding.left +\n      xAttr2blockCountX_StartPos[paperCircle.BlockIndexX] +\n      (paperCircle.circleIndexX + 0.5) * r;\n\n    paperCircle.citationGrey = citeCount2grey(paper.citationCount);\n    paperCircle.activeColors = paper.innerColors;\n    // paperCircle.colors =\n    //   paperCircle.activeColors.length > 0\n    //     ? paperCircle.activeColors\n    //     : [paperCircle.citationGrey];\n    paperCircle.innerColors =\n      paperCircle.activeColors.length > 0\n        ? paperCircle.activeColors\n        : [paperCircle.citationGrey];\n    // paperCircle.outerColors\n    paperCircle.outerColors = [\"none\"];\n    if (isUnitOuterHighlight) {\n      paperCircle.outerColors = paper.outerColors;\n    } else {\n      if (isSelected) {\n        if (currentSelected === paper.doi)\n          paperCircle.outerColors = [\"#d95f02\"];\n        if (currentSelectedRefSet.has(paper.doi))\n          paperCircle.outerColors = [\"#1b9e77\"];\n        if (currentSelectedCitedSet.has(paper.doi))\n          paperCircle.outerColors = [\"#7570b3\"];\n      } else {\n        paperCircle.outerColors = [\"none\"];\n      }\n    }\n\n    paperCircle.opacity = controlIsActive\n      ? paper.innerColors.length + paper.outerColors.length > 0\n        ? 0.8\n        : 0.4\n      : 0.8;\n\n    paperCircle.title = paper.Title;\n\n    if (isSelected) {\n      if (currentSelected === paper.doi) paperCircle.borderColor = \"#d95f02\";\n      if (currentSelectedRefSet.has(paper.doi))\n        paperCircle.borderColor = \"#1b9e77\";\n      if (currentSelectedCitedSet.has(paper.doi))\n        paperCircle.borderColor = \"#7570b3\";\n    } else {\n      paperCircle.borderColor = \"none\";\n    }\n\n    paperCircle.isBackgroundActive = searchPaperDoiSet.has(paper.doi);\n\n    return paperCircle;\n  });\n\n  const xLabels = unitXAttrList.map((xAttr, i) => {\n    const startX = unitLayoutPadding.left + xAttr2blockCountX_StartPos[i];\n    const middleX = startX + (xAttr2blockCountX[i] * r) / 2;\n    return {\n      value: xAttr,\n      x: middleX,\n      y: unitLayoutPadding.top * 0.8,\n    };\n  });\n\n  const yLabels = unitYAttrList.map((yAttr, i) => {\n    const startY =\n      unitLayoutPadding.top +\n      (unitBlockHeight + unitBlockPadding.top + unitBlockPadding.bottom) * i;\n    return {\n      value: yAttr,\n      x: unitLayoutPadding.left * 0.35,\n      y: startY,\n    };\n  });\n\n  const handleClickPaper = (e, doi) => {\n    // console.log(\"click\", e, doi);\n    e.stopPropagation();\n    setCurrentSelected(doi);\n  };\n\n  const handleClickBackground = () => {\n    cancelSelect();\n  };\n\n  const [hoverDoi, setHoverDoi] = useState(\"\");\n  const hoverPaper =\n    hoverDoi.length > 0 ? papers.find((paper) => paper.doi === hoverDoi) : {};\n  const hoverPaperCircle =\n    hoverDoi.length > 0\n      ? paperCircles.find((paper) => paper.doi === hoverDoi)\n      : {};\n\n  const handleHover = (doi) => {\n    console.log(\"===> hover\", doi);\n    setHoverDoi(doi);\n  };\n  const handleHoverOut = () => {\n    console.log(\"===> mouse leave\");\n    setHoverDoi(\"\");\n  };\n\n  return (\n    <div className=\"unit-view\">\n      <svg\n        id=\"unit-svg\"\n        width=\"100%\"\n        height=\"100%\"\n        onClick={handleClickBackground}\n      >\n        <g id=\"units\">\n          {r > 0 &&\n            paperCircles.map((paper, i) => (\n              <CircleUnit\n                key={i}\n                cx={paper.cx}\n                cy={paper.cy}\n                r={r / 2.4}\n                // grey={paper.citationGrey}\n                // oriData={paper.oriData}\n                doi={paper.doi}\n                colors={paper.colors}\n                opacity={paper.opacity}\n                innerColors={paper.innerColors}\n                outerColors={paper.outerColors}\n                handleClick={handleClickPaper}\n                // isSelect={isSelected && currentSelected === paper.doi}\n                borderOpacity={paper.borderOpacity}\n                borderColor={paper.borderColor}\n                title={paper.title}\n                isBackgroundActive={paper.isBackgroundActive}\n                handleHover={handleHover}\n                handleHoverOut={handleHoverOut}\n              />\n            ))}\n        </g>\n        <g id=\"x-label\">\n          {r > 0 &&\n            xLabels.map((label) => (\n              <text\n                key={label.value}\n                x={label.x}\n                y={label.y}\n                textAnchor=\"middle\"\n                fontSize={r * 1.6}\n                fill=\"rgb(78, 78, 78)\"\n              >\n                {label.value}\n              </text>\n            ))}\n        </g>\n        <g id=\"y-label\">\n          {r > 0 &&\n            yLabels.map((label) => (\n              <text\n                key={label.value}\n                // x={label.x}\n                // y={label.y}\n                // textAnchor=\"start\"\n                transform={`translate(${label.x}, ${label.y}) rotate(90)`}\n                fontSize={r * 1.6}\n                fill=\"rgb(78, 78, 78)\"\n              >\n                {label.value}\n              </text>\n            ))}\n        </g>\n      </svg>\n      <PaperTooltip\n        isShow={hoverDoi.length > 0}\n        paper={hoverPaper}\n        containerWidth={svgWidth}\n        containerHeight={svgHeight}\n        paperCircle={hoverPaperCircle}\n      />\n    </div>\n  );\n});\n\nexport default UnitView;\n","import React, { useState, useRef, useEffect } from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { get } from \"lodash\";\nimport { Switch, Modal, Tag, Input } from \"antd\";\nimport {\n  CloseOutlined,\n  CheckOutlined,\n  PlusOutlined,\n  SettingOutlined,\n} from \"@ant-design/icons\";\nimport { toJS } from \"mobx\";\n\nconst debug = true;\n\nconst keys = [\n  \"title\",\n  \"doi\",\n  \"year\",\n  \"conferenceName\",\n  \"authors\",\n  \"citationCount\",\n  \"affiliation\",\n  \"countries\",\n  \"abstract\",\n  \"keywords\",\n  \"refList\",\n];\nconst DetailView = observer(() => {\n  const store = useGlobalStore();\n  const { currentSelectedPaper, setPaper, updatePaper } = store;\n  const paper = currentSelectedPaper;\n  const [uploadModalShow, _setUploadModalShow] = useState(false);\n  const [newPaper, setNewPaper] = useState({});\n  const setUploadModalShow = () => {\n    if (!uploadModalShow) {\n      const _newPaper = {};\n      keys.forEach(\n        (key) =>\n          (_newPaper[key] = Array.isArray(currentSelectedPaper[key])\n            ? currentSelectedPaper[key].join(\"; \")\n            : currentSelectedPaper[key])\n      );\n      setNewPaper(_newPaper);\n    }\n    _setUploadModalShow(!uploadModalShow);\n  };\n\n  if (!currentSelectedPaper) {\n    return <div></div>;\n  }\n\n  const doi = get(paper, \"doi\", \"\");\n\n  const editTags = [\n    {\n      title: \"Private Tags\",\n      value: \"privateTags\",\n      initTags: get(paper, \"privateTags\", []),\n    },\n    {\n      title: \"Public Tags\",\n      value: \"publicTags\",\n      initTags: get(paper, \"publicTags\", []),\n    },\n  ];\n  const handleChangeTags = (attr, value) => {\n    doi && setPaper(doi, attr, value);\n  };\n  const handleChangeRead = (value) => {\n    setPaper(doi, \"read\", value);\n  };\n\n  const handleSubmit = () => {\n    updatePaper(currentSelectedPaper.doi, newPaper);\n    setUploadModalShow();\n  };\n\n  return (\n    <div className=\"detail-view\" key={doi}>\n      {paper && (\n        <>\n          <div className=\"detail-header\">\n            <div className=\"detail-header-content\">\n              <div className=\"detail-title\">{paper.title}</div>\n              <div className=\"detail-authors\">\n                {get(paper, \"authors\", []).join(\"; \")} ({paper.year})\n              </div>\n            </div>\n            <div className=\"detail-header-icons\">\n              <SettingOutlined onClick={setUploadModalShow} />\n            </div>\n          </div>\n          <div className=\"detail-edit-tags\">\n            <div className=\"detail-edit-read\">\n              <div className=\"detail-edit-title\">Read</div>\n              <Switch\n                size=\"small\"\n                checkedChildren={<CheckOutlined />}\n                unCheckedChildren={<CloseOutlined />}\n                defaultChecked={get(paper, \"read\", false)}\n                onChange={handleChangeRead}\n              />\n            </div>\n            {editTags.map((editTag) => (\n              <DetailEditTags\n                key={editTag.value}\n                title={editTag.title}\n                initTags={editTag.initTags}\n                handleChangeTags={(value) =>\n                  handleChangeTags(editTag.value, value)\n                }\n              />\n            ))}\n          </div>\n          <div className=\"detail-attrs\">\n            <div className=\"detail-attr\">\n              <div className=\"detail-key\">keywords:</div>\n              <div className=\"detail-content\">\n                {get(paper, \"keywords\", []).join(\"; \")}\n              </div>\n            </div>\n            <DetailItem paper={paper} label={\"doi\"} />\n            <DetailItem\n              paper={paper}\n              label={\"conference/journal\"}\n              value={\"conferenceName\"}\n            />\n            <DetailItem paper={paper} label={\"affiliation\"} />\n            <DetailItem paper={paper} label={\"abstract\"} />\n          </div>\n          <Modal\n            key={currentSelectedPaper.doi}\n            title=\"Upload\"\n            visible={uploadModalShow}\n            onOk={handleSubmit}\n            onCancel={setUploadModalShow}\n            centered\n          >\n            {keys.map((key) => (\n              <div className=\"detail-new-paper-item\" key={key}>\n                <div className=\"detail-new-paper-label\">{key}</div>\n                <div className=\"detail-new-paper-input\">\n                  <Input\n                    value={newPaper[key]}\n                    onChange={(e) => {\n                      const new_paper = { ...newPaper };\n                      new_paper[key] = e.target.value;\n                      setNewPaper(new_paper);\n                    }}\n                  />\n                </div>\n              </div>\n            ))}\n          </Modal>\n        </>\n      )}\n    </div>\n  );\n});\n\nexport default DetailView;\n\nconst DetailItem = ({ paper, label, value = \"\" }) => {\n  if (value.length === 0) value = label;\n  return (\n    <div className=\"detail-attr\">\n      <div className=\"detail-key\">{label}:</div>\n      <div className=\"detail-content\">{get(paper, value, \"\")}</div>\n    </div>\n  );\n};\n\nconst DetailEditTags = ({ title, initTags, handleChangeTags }) => {\n  const [tags, _setTags] = useState(initTags);\n  const setTags = (newTags) => {\n    handleChangeTags(newTags);\n    _setTags(newTags);\n  };\n  const [editInputIndex, setEditInputIndex] = useState(-1);\n  // const [editInput, setEditInput] = useState();\n  // const saveEditInputRef = (input) => setEditInput(input);\n  const input = useRef();\n  // const saveInputRef = (input) => setInput(input);\n\n  const [editInputValue, setEditInputValue] = useState(\"\");\n  const handleEditInputConfirm = () => {\n    const newTags = [...tags];\n    newTags[editInputIndex] = editInputValue;\n    setTags(newTags);\n    setEditInputIndex(-1);\n    setEditInputValue(\"\");\n  };\n\n  const [inputValue, setInputValue] = useState(\"\");\n  const handleInputConfirm = () => {\n    if (inputValue && tags.indexOf(inputValue) < 0) {\n      setTags([...tags, inputValue]);\n      setInputVisible(false);\n      setInputValue(\"\");\n    }\n  };\n\n  const handleClose = (removeTag) => {\n    setTags(tags.filter((tag) => tag !== removeTag));\n  };\n\n  const [inputVisible, setInputVisible] = useState(false);\n  const showInput = () => {\n    setInputVisible(true);\n    // input.focus();\n  };\n  return (\n    <div className=\"detail-edit-tag\">\n      <div className=\"detail-edit-title\">{title}:</div>\n      <div className=\"detail-edit-tags\">\n        <>\n          {tags.map((tag, index) => {\n            if (editInputIndex === index) {\n              return (\n                <Input\n                  // ref={saveEditInputRef}\n                  key={tag}\n                  size=\"small\"\n                  className=\"tag-input\"\n                  value={editInputValue}\n                  onchange={(e) => setEditInputValue(e.target.value)}\n                  onBlur={handleEditInputConfirm}\n                  onPressEnter={handleEditInputConfirm}\n                />\n              );\n            }\n\n            const tagElem = (\n              <Tag\n                className=\"edit-tag\"\n                key={tag}\n                closable={true}\n                onClose={() => handleClose(tag)}\n              >\n                <span\n                // onDoubleClick={(e) => {\n                //   setEditInputIndex(index);\n                //   setEditInputValue(tag);\n                //   editInput.focus();\n                //   e.preventDefault();\n                // }}\n                >\n                  {tag}\n                </span>\n              </Tag>\n            );\n            return tagElem;\n          })}\n          {inputVisible && (\n            <Input\n              ref={input}\n              type=\"text\"\n              size=\"small\"\n              className=\"tag-input\"\n              value={inputValue}\n              onChange={(e) => setInputValue(e.target.value)}\n              onBlur={handleInputConfirm}\n              onPressEnter={handleInputConfirm}\n            />\n          )}\n          {!inputVisible && (\n            <Tag className=\"site-tag-plus\" onClick={showInput}>\n              <PlusOutlined /> New Tag\n            </Tag>\n          )}\n        </>\n      </div>\n    </div>\n  );\n};\n","import React, { useEffect } from \"react\";\nimport { useGlobalStore } from \"Store\";\n\nimport ControlView from \"./ControlView\";\nimport UnitView from \"./UnitView\";\nimport DetailView from \"./DetailView\";\n\nconst ManagePage = () => {\n  const store = useGlobalStore();\n  useEffect(() => {\n    store.setCurrentPage();\n    store.initPapers();\n    store.initUserId();\n  }, []);\n  return (\n    <div className=\"main-container\">\n      <div className=\"control-main-container\">\n        <div className=\"control-view-container\">\n          <ControlView />\n        </div>\n        <div className=\"unit-view-container\">\n          <UnitView />\n        </div>\n      </div>\n      <div className=\"detail-view-container\">\n        <DetailView />\n      </div>\n    </div>\n  );\n};\n\nexport default ManagePage;\n","import { useEffect, useState } from \"react\";\nimport * as d3 from \"d3\";\n\n// 初始化，确定长宽\nconst useClientRect = ({ svgId }) => {\n  const [clientRect, setClientRect] = useState({ width: 0, height: 0 });\n  useEffect(() => {\n    const svg = d3.select(`#${svgId}`);\n    // svg.selectAll(\"*\").remove();\n    const clientRect = svg.node().getClientRects()[0];\n    setClientRect(clientRect);\n  }, [svgId]);\n  return clientRect;\n};\n\nexport default useClientRect;\n","import React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport { useClientRect } from \"Hooks\";\nimport * as d3 from \"d3\";\nimport { Slider, InputNumber } from \"antd\";\nimport { find_d } from \"Common\";\nimport { get } from \"lodash\";\n\nconst ProjectionView = observer(() => {\n  const svgId = \"ana-projection-map-svg\";\n  const store = useGlobalStore();\n  const {\n    drawProjectionFlag,\n    analysisPapers,\n    anaHighPapers,\n    num_topics,\n    resetProjectionFlag,\n    setNumTopics,\n    defaultHighColor,\n    topicColorScale,\n    anaFilterType,\n    anaHighTopic,\n    setAnaSelectHighlightPaperDoi,\n    anaSelectHighlightPaperDoi,\n    setHighEntityLinkData,\n    anaHighEntityTopic,\n    setAnaHighEntityTopic,\n    setAnaHoverPaperDoi,\n    removeHoverPaperDoi,\n    anaHoverPaperDoi,\n    ldaState,\n    setLdaState,\n    tsneState,\n    setTsneState,\n  } = store;\n  const [num_topics_ing, set_num_topics_ing] = useState(num_topics);\n\n  const clientRect = useClientRect({\n    svgId,\n  });\n  const { width, height } = clientRect;\n  useEffect(() => {\n    store.tryLda();\n  }, []);\n\n  const padding = {\n    left: 30,\n    right: 30,\n    top: 30,\n    bottom: 30,\n  };\n  const x = d3\n    .scaleLinear()\n    .domain([\n      d3.min(analysisPapers, (d) => d.projection[0]),\n      d3.max(analysisPapers, (d) => d.projection[0]),\n    ])\n    .nice()\n    .range([padding.left, width - padding.right]);\n  const y = d3\n    .scaleLinear()\n    .domain([\n      d3.min(analysisPapers, (d) => d.projection[1]),\n      d3.max(analysisPapers, (d) => d.projection[1]),\n    ])\n    .nice()\n    .range([height - padding.bottom, padding.top]);\n\n  // contour相关\n  const contours = d3.range(num_topics).map(\n    (topic_i) =>\n      d3\n        .contourDensity()\n        .x((d) => x(d.projection[0]))\n        .y((d) => y(d.projection[1]))\n        .size([width, height])\n        .bandwidth(30)\n        .thresholds(35)(\n        analysisPapers.filter((paper) =>\n          paper.topics.map((topic) => topic[0]).includes(topic_i)\n        )\n      )[topic_i % 5]\n  );\n  const contourOpacity = (topicIndex) => {\n    // return 1\n    if (anaFilterType === \"none\") return 0.25;\n    else if (anaFilterType !== \"topic\") return 0.1;\n    else return topicIndex === anaHighTopic ? 0.36 : 0.1;\n  };\n\n  // paperCircle相关\n  const paperCircleR = d3\n    .scaleLinear()\n    .domain([0, d3.max(analysisPapers, (d) => +d.citationCount)])\n    .range([3, 15]);\n\n  const paperCircleColor = (paper) => {\n    if (paper.topics.length === 0) {\n      return \"#ccc\";\n    } else {\n      let mainTopic = paper.topics[0];\n      paper.topics.forEach((topic) => {\n        if (topic[1] > mainTopic[1]) {\n          mainTopic = topic;\n        }\n      });\n      return topicColorScale[mainTopic[0]];\n    }\n  };\n  const paperCircleOpacity = (paper) => {\n    if (anaSelectHighlightPaperDoi === paper.doi) return 1;\n    if (anaFilterType === \"none\") return 1;\n    return anaHighPapers.map((paper) => paper.doi).includes(paper.doi)\n      ? 0.8\n      : 0.2;\n  };\n  const paperCircleStrokeWidth = (paper) => {\n    if (anaSelectHighlightPaperDoi === paper.doi) return 6;\n    if (anaFilterType === \"none\") return 1;\n    if (anaFilterType === \"topic\") return 1;\n    return anaHighPapers.map((paper) => paper.doi).includes(paper.doi) ? 3 : 1;\n  };\n  const paperCircleDasharray = (paper) => {\n    if (anaSelectHighlightPaperDoi === paper.doi) return [4, 8];\n    if (anaFilterType === \"none\" || anaFilterType === \"topic\") return \"none\";\n    return anaHighPapers.map((paper) => paper.doi).includes(paper.doi)\n      ? [5, 5]\n      : \"none\";\n  };\n  const paperCircleStroke = (paper) => {\n    if (anaSelectHighlightPaperDoi === paper.doi) return \"red\";\n    if (anaFilterType === \"none\" || anaFilterType === \"topic\") return \"#fff\";\n    else\n      return anaHighPapers.map((paper) => paper.doi).includes(paper.doi)\n        ? \"#333\"\n        : \"none\";\n  };\n\n  // 主题Entity相关\n  const generateEntity = (topicIndex) => {\n    const allPapers = analysisPapers.filter((paper) =>\n      paper.topics.map((a) => a[0]).includes(topicIndex)\n    );\n    const mainPapers = analysisPapers.filter(\n      (paper) => paper.topics[0][0] === topicIndex\n    );\n    const positionX = x(\n      mainPapers.reduce((s, a) => s + a.projection[0], 0) / mainPapers.length\n    );\n    const positionY = y(\n      mainPapers.reduce((s, a) => s + a.projection[1], 0) / mainPapers.length\n    );\n    return {\n      allPapers,\n      topicIndex,\n      mainPapers,\n      positionX,\n      positionY,\n      color: topicColorScale[topicIndex],\n    };\n  };\n  const anaHighTopicEntity = generateEntity(anaHighTopic);\n  const anaHighTopicPaperDoiSet = new Set(\n    anaHighTopicEntity.allPapers.map((paper) => paper.doi)\n  );\n  const anaOtherEntities = d3\n    .range(num_topics)\n    .filter((a) => a !== anaHighTopic)\n    .map((topicIndex) => generateEntity(topicIndex));\n  anaOtherEntities.forEach((entity) => {\n    entity.intersectionPapers = entity.allPapers.filter((paper) =>\n      anaHighTopicPaperDoiSet.has(paper.doi)\n    );\n  });\n  const entityR = d3\n    .scaleLinear()\n    .domain(\n      d3.extent(\n        [...anaOtherEntities, anaHighTopicEntity],\n        (d) => d.allPapers.length\n      )\n    )\n    .range([30, 45]);\n  const getEntitySectorD = (entity) => {\n    const angle =\n      (2 * Math.PI * entity.intersectionPapers.length) /\n      entity.allPapers.length;\n    const r = entityR(entity.allPapers.length);\n    const start = {\n      x: entity.positionX,\n      y: entity.positionY - r,\n    };\n    const end = {\n      x: entity.positionX + Math.sin(angle) * r,\n      y: entity.positionY - Math.cos(angle) * r,\n    };\n    return `M ${entity.positionX} ${entity.positionY}\n          L ${start.x} ${start.y}\n          A ${r} ${r} 0 0 1 ${end.x} ${end.y}\n          Z\n          `;\n  };\n  const entityOpacity = (entity) => {\n    if (anaHighEntityTopic < 0) return 0.8;\n    else return entity.topicIndex === anaHighEntityTopic ? 1 : 0.6;\n  };\n\n  // 主题间Link相关\n  const topicLinks = anaOtherEntities.map((entity) => {\n    const topicIndex = entity.topicIndex;\n    const source = {\n      x: entity.positionX,\n      y: entity.positionY,\n    };\n    const target = {\n      x: anaHighTopicEntity.positionX,\n      y: anaHighTopicEntity.positionY,\n    };\n\n    const res = find_d(source.x, source.y, target.x, target.y, 25);\n    const citeControlPoints = [\n      {\n        x: res.x_1_3_negative,\n        y: res.y_1_3_negative,\n      },\n      {\n        x: res.x_2_3_negative,\n        y: res.y_2_3_negative,\n      },\n    ];\n    const citedControlPoints = [\n      {\n        x: res.x_1_3_positive,\n        y: res.y_1_3_positive,\n      },\n      {\n        x: res.x_2_3_positive,\n        y: res.y_2_3_positive,\n      },\n    ];\n    const interPapers = entity.allPapers.filter((paper) =>\n      anaHighTopicPaperDoiSet.has(paper.doi)\n    );\n    const interCount = interPapers.length;\n    const interPapersDoiSet = new Set(interPapers.map((paper) => paper.doi));\n    const independentPapers = entity.allPapers.filter(\n      (paper) => !interPapersDoiSet.has(paper.doi)\n    );\n    const centralEntityIndependentPapers = anaHighTopicEntity.allPapers.filter(\n      (paper) => !interPapersDoiSet.has(paper.doi)\n    );\n\n    const citeDoiSet = new Set(\n      independentPapers.reduce((s, a) => s.concat(a.refList), [])\n    );\n    const citePapers = centralEntityIndependentPapers.filter((paper) =>\n      citeDoiSet.has(paper.doi)\n    );\n    const citePapersDoiSet = new Set(citePapers.map((paper) => paper.doi));\n    const citeLinkCount = independentPapers.reduce(\n      (s, paper) =>\n        s + paper.refList.filter((doi) => citePapersDoiSet.has(doi)).length,\n      0\n    );\n    const citePaperCount = citePapers.length;\n\n    const citeSourcePapers = independentPapers.filter(\n      (paper) =>\n        paper.refList.filter((doi) => citePapersDoiSet.has(doi)).length > 0\n    );\n\n    const citedDoiSet = new Set(\n      centralEntityIndependentPapers.reduce((s, a) => s.concat(a.refList), [])\n    );\n    const citedPapers = independentPapers.filter((paper) =>\n      citedDoiSet.has(paper.doi)\n    );\n    const citedPapersDoiSet = new Set(citedPapers.map((paper) => paper.doi));\n    const citedLinkCount = centralEntityIndependentPapers.reduce(\n      (s, paper) =>\n        s + paper.refList.filter((doi) => citedPapersDoiSet.has(doi)).length,\n      0\n    );\n    const citedPaperCount = citedPapers.length;\n\n    return {\n      topicIndex,\n      source,\n      target,\n      citeControlPoints,\n      citedControlPoints,\n      independentPapers,\n      interPapers,\n      centralEntityIndependentPapers,\n      citeDoiSet,\n      citedDoiSet,\n      interCount,\n      citePapers,\n      citePaperCount,\n      citeLinkCount,\n      citedPapers,\n      citedPaperCount,\n      citedLinkCount,\n\n      citeSourcePapers,\n      citePapersDoiSet,\n    };\n  });\n  const _linkWidth = d3\n    .scaleLinear()\n    .domain([\n      0,\n      d3.max(topicLinks, (d) =>\n        d3.max([d.interCount, d.citeLinkCount, d.citedLinkCount])\n      ),\n    ])\n    .range([5, 20]);\n  const linkWidth = (weight) => (weight === 0 ? 0 : _linkWidth(weight));\n  const topicLinkOpacity = (topicLink) => {\n    if (anaHighEntityTopic < 0) return 0.7;\n    else return topicLink.topicIndex === anaHighEntityTopic ? 1 : 0.3;\n  };\n  const handleClickLinks = (link) => {\n    setAnaHighEntityTopic(link.topicIndex);\n    setHighEntityLinkData(\n      link.citeSourcePapers.map((paper) => paper.doi),\n      link.citedPapers.map((paper) => paper.doi),\n      link.centralEntityIndependentPapers.map((paper) => paper.doi)\n    );\n  };\n\n  // const mostCitedPapers = d3\n  //   .sort([...anaHighPapers], (p) => +p.citationCount)\n  //   .slice(anaFilterType === \"topic\" ? -3 : -8);\n  // const mostCitedPaperDoiSet = new Set(\n  //   mostCitedPapers.map((paper) => paper.doi)\n  // );\n  const papersSortByCite = d3\n    .sort([...anaHighPapers], (p) => +p.citationCount)\n    .reverse();\n  const mostCitedPapers = [];\n  const countLimit = 16;\n  const xDis = 200;\n  const yDis = 30;\n  const isCover = (p1, p2) =>\n    Math.abs(x(p1.projection[0]) - x(p2.projection[0])) < xDis &&\n    Math.abs(y(p1.projection[1]) - y(p2.projection[1])) < yDis;\n  const isShow = (paper) =>\n    mostCitedPapers.find((p) => isCover(paper, p)) ? false : true;\n  papersSortByCite.forEach((paper) => {\n    if (mostCitedPapers.length < countLimit) {\n      if (isShow(paper)) {\n        mostCitedPapers.push(paper);\n      }\n    }\n  });\n  const mostCitedPaperDoiSet = new Set(\n    mostCitedPapers.map((paper) => paper.doi)\n  );\n  const labelFontS = d3\n    .scaleLinear()\n    .domain(d3.extent(mostCitedPapers, (p) => +p.citationCount))\n    .range([16, 22])\n    .clamp(true);\n\n  const abbr = (paper) => {\n    const author = get(paper, \"authors[0]\", \"\").split(\" \").slice(-1);\n    const conference = get(paper, \"conferenceName\", \"\");\n    const year = `${get(paper, \"year\", \"\")}`.slice(-2);\n    return mostCitedPaperDoiSet.has(paper.doi) ||\n      anaSelectHighlightPaperDoi === paper.doi || anaHoverPaperDoi === paper.doi\n      ? `[${author}. ${conference}${year}]`\n      : \"\";\n  };\n\n  const handleHover = (e, doi) => {\n    const { clientX, clientY } = e;\n    setAnaHoverPaperDoi(clientX, clientY, doi);\n  };\n\n  const handleChangeLdaState = (value) => {}\n\n  return (\n    <div className=\"projection-view\">\n      <svg id={svgId} width=\"100%\" height=\"100%\">\n        <g id=\"topic-contours-g\" strokeLinejoin=\"round\" strokeWidth=\"1.5\">\n          {contours.map((contour, topicIndex) => (\n            <>\n              <path\n                key={topicIndex}\n                d={d3.geoPath()(contour)}\n                fill={topicColorScale[topicIndex]}\n                opacity={contourOpacity(topicIndex)}\n                stroke={\n                  topicIndex === anaHighTopic\n                    ? \"#111\"\n                    : topicColorScale[topicIndex]\n                }\n                strokeDasharray={topicIndex === anaHighTopic ? 5 : \"none\"}\n              />\n              {/* <path\n                key={`${topicIndex}-border`}\n                d={d3.geoPath()(contour)}\n                fill={\"none\"}\n                opacity={1}\n                stroke={topicColorScale[topicIndex]}\n                strokeDasharray={5}\n              /> */}\n            </>\n          ))}\n        </g>\n        <g id=\"paper-circles-g\" stroke=\"#fff\">\n          {analysisPapers.map((paper) => (\n            <g\n              key={paper.doi}\n              transform={`translate(${x(paper.projection[0])}, ${y(\n                paper.projection[1]\n              )})`}\n            >\n              <circle\n                r={\n                  paperCircleR(+paper.citationCount) +\n                  paperCircleStrokeWidth(paper)\n                }\n                fill={paperCircleColor(paper)}\n                strokeLinecap=\"round\"\n                strokeWidth={paperCircleStrokeWidth(paper)}\n                opacity={paperCircleOpacity(paper)}\n                strokeDasharray={paperCircleDasharray(paper)}\n                stroke={paperCircleStroke(paper)}\n                cursor=\"pointer\"\n                onClick={() => setAnaSelectHighlightPaperDoi(paper.doi)}\n                onMouseEnter={(e) => handleHover(e, paper.doi)}\n                onMouseLeave={removeHoverPaperDoi}\n              />\n            </g>\n          ))}\n        </g>\n        {anaFilterType === \"topic\" && (\n          <>\n            <g id=\"topic-links-g\" strokeLinecap=\"round\">\n              {topicLinks.map((topicLink) => (\n                <g\n                  key={topicLink.topicIndex}\n                  fill=\"none\"\n                  opacity={topicLinkOpacity(topicLink)}\n                  cursor=\"pointer\"\n                  onClick={() => handleClickLinks(topicLink)}\n                >\n                  <path\n                    className=\"cited\"\n                    stroke={topicColorScale[topicLink.topicIndex]}\n                    strokeWidth={linkWidth(topicLink.citedLinkCount)}\n                    d={`M${topicLink.source.x},${topicLink.source.y} \n                    C${topicLink.citedControlPoints[0].x},${topicLink.citedControlPoints[0].y}, \n                    ${topicLink.citedControlPoints[1].x},${topicLink.citedControlPoints[1].y}, \n                    ${topicLink.target.x},${topicLink.target.y}`}\n                  />\n                  <path\n                    className=\"cite\"\n                    stroke={topicColorScale[anaHighTopic]}\n                    strokeWidth={linkWidth(topicLink.citeLinkCount)}\n                    d={`M${topicLink.target.x},${topicLink.target.y}\n                    C${topicLink.citeControlPoints[1].x},${topicLink.citeControlPoints[1].y}, \n                    ${topicLink.citeControlPoints[0].x},${topicLink.citeControlPoints[0].y}, \n                    ${topicLink.source.x},${topicLink.source.y}`}\n                  />\n                </g>\n              ))}\n            </g>\n            <g id=\"topic-entities-g\">\n              <g id=\"selected-topic-entity-g\"></g>\n              <g id=\"others-topic-entities-g\" stroke=\"#fff\" strokeWidth=\"3\">\n                {anaOtherEntities.map((entity) => (\n                  <g key={entity.topicIndex} opacity={entityOpacity(entity)}>\n                    <circle\n                      cx={entity.positionX}\n                      cy={entity.positionY}\n                      r={entityR(entity.allPapers.length)}\n                      fill={entity.color}\n                    />\n                    <path\n                      fill={topicColorScale[anaHighTopic]}\n                      d={getEntitySectorD(entity)}\n                    />\n                  </g>\n                ))}\n              </g>\n            </g>\n          </>\n        )}\n        <g id=\"paper-circles-lables-g\" stroke=\"#fff\">\n          {analysisPapers.map((paper) => (\n            <g\n              key={paper.doi}\n              transform={`translate(${x(paper.projection[0])}, ${y(\n                paper.projection[1]\n              )})`}\n            >\n              <text\n                fontSize={labelFontS(+paper.citationCount)}\n                fill=\"#333\"\n                stroke=\"none\"\n                textAnchor=\"middle\"\n                y=\"-10\"\n                opacity={0.9}\n                pointerEvents=\"none\"\n              >\n                {abbr(paper)}\n              </text>\n            </g>\n          ))}\n        </g>\n      </svg>\n      <div className=\"topics-number-input\">\n        <div className=\"topics-number-input-text\">\n          Topics Num: {num_topics_ing}\n        </div>\n        <Slider\n          min={2}\n          max={10}\n          onAfterChange={setNumTopics}\n          onChange={set_num_topics_ing}\n          value={num_topics_ing}\n        />\n      </div>\n      {/* <div className=\"lda-state-input\">\n        <div className=\"lda-state-input-text\">\n          LDA State:\n        </div>\n        <InputNumber\n          style={{width: 100}}\n          min={1}\n          max={999999}\n          defaultValue={12357}\n          onChange={setLdaState}\n          size=\"small\"\n        />\n      </div>\n      <div className=\"tsne-state-input\">\n        <div className=\"tsne-state-input-text\">\n          T-SNE State:\n        </div>\n        <InputNumber\n          style={{width: 100}}\n          min={1}\n          max={999999}\n          defaultValue={45629}\n          onChange={setTsneState}\n          size=\"small\"\n        />\n      </div> */}\n    </div>\n  );\n});\n\nexport default ProjectionView;\n","export default function find_distance_d(x0, y0, x1, y1, d) {\n  let points_dist = Math.sqrt( (x0 - x1) * (x0 - x1) + (y0 - y1) * (y0 - y1) )\n  let delta_x = (y1 - y0) * d / points_dist\n  let delta_y = (x1 - x0) * d / points_dist\n\n  let a0_positive, b0_positive\n  a0_positive = x0 - delta_x\n  b0_positive = y0 + delta_y\n  let x_1_3_positive, y_1_3_positive, x_2_3_positive, y_2_3_positive\n  x_1_3_positive = a0_positive + (x1 - x0) / 3\n  y_1_3_positive = b0_positive + (y1 - y0) / 3\n  x_2_3_positive = a0_positive + (x1 - x0) * 2 / 3\n  y_2_3_positive = b0_positive + (y1 - y0) * 2 / 3\n\n  let a0_negative, b0_negative\n  a0_negative = x0 + delta_x\n  b0_negative = y0 - delta_y\n  let x_1_3_negative, y_1_3_negative, x_2_3_negative, y_2_3_negative\n  x_1_3_negative = a0_negative + (x1 - x0) / 3\n  y_1_3_negative = b0_negative + (y1 - y0) / 3\n  x_2_3_negative = a0_negative + (x1 - x0) * 2 / 3\n  y_2_3_negative = b0_negative + (y1 - y0) * 2 / 3\n\n  return {\n    'x_1_3_positive': x_1_3_positive,\n    'y_1_3_positive': y_1_3_positive,\n    'x_2_3_positive': x_2_3_positive,\n    'y_2_3_positive': y_2_3_positive,\n    'x_1_3_negative': x_1_3_negative,\n    'y_1_3_negative': y_1_3_negative,\n    'x_2_3_negative': x_2_3_negative,\n    'y_2_3_negative': y_2_3_negative\n  }\n}\n","import React, { useState } from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport { useClientRect } from \"Hooks\";\nimport * as d3 from \"d3\";\nimport { Select } from \"antd\";\n\nconst { Option } = Select;\n\nconst NetworkView = observer(() => {\n  const svgId = \"ana-network-svg\";\n  const padding = {\n    left: 60,\n    right: 60,\n    top: 50,\n    bottom: 45,\n  };\n  const clientRect = useClientRect({\n    svgId,\n  });\n  const { width = 0, height = 0 } = clientRect;\n\n  const store = useGlobalStore();\n  const {\n    analysisPapers,\n    topicColorScale,\n    anaFilterType,\n    anaHighTopic,\n    anaHighPapers,\n    setAnaSelectHighlightPaperDoi,\n    anaSelectHighlightPaperDoi,\n    anaHighEntityTopic,\n    anaHighEntityCitePaperDois,\n    anaHighEntityCitedPaperDois,\n    anaHighTopicIndenpentPaperDois,\n    anaYearRange,\n    setAnaHoverPaperDoi,\n    removeHoverPaperDoi,\n  } = store;\n\n  // rect\n  const anaHighPapersDoiSet = new Set(anaHighPapers.map((p) => p.doi));\n  const yearRange = d3.extent(analysisPapers, (d) => +d.year);\n  const paperCountByYear = d3\n    .range(...yearRange.map((d, i) => d + i))\n    .map(\n      (year) => analysisPapers.filter((paper) => +paper.year === +year).length\n    );\n\n  const rectWidth = d3.min([\n    ((width - padding.left - padding.right) /\n      (yearRange[1] - yearRange[0] + 1)) *\n      0.68,\n    36,\n  ]);\n  const rectHeight = d3.max([\n    d3.min([\n      rectWidth * 0.4,\n      ((height - padding.bottom - padding.top) / d3.max(paperCountByYear)) *\n        0.7,\n    ]),\n    0,\n  ]);\n  const x = d3\n    .scaleLinear()\n    .domain(yearRange)\n    .range([padding.left, width - padding.right]);\n  const y = d3\n    .scaleLinear()\n    .domain([0, d3.max(paperCountByYear) - 1])\n    .range([padding.top, height - padding.bottom]);\n  const year2count = {};\n  const data = analysisPapers.slice();\n  const compareIndexByTopic = (a, b) => {\n    if (a.topics[0][0] === b.topics[0][0]) {\n      return a.topics[0][1] - b.topics[0][1];\n    } else {\n      return a.topics[0][0] - b.topics[0][0];\n    }\n  };\n  data.sort(compareIndexByTopic);\n  const doi2indexByYear = {};\n  data.forEach((paper) => {\n    if (!(paper.year in year2count)) {\n      year2count[paper.year] = 0;\n    }\n    doi2indexByYear[paper.doi] = year2count[paper.year];\n    year2count[paper.year] += 1;\n  });\n  const rectOpacity = (paper) => {\n    if (paper.doi === anaSelectHighlightPaperDoi) return 1;\n    if (anaHighPapersDoiSet.has(paper.doi)) return 1;\n    if (anaHighEntityTopic >= 0) {\n      if (anaHighEntityCitePaperDois.includes(paper.doi)) return 0.9;\n      if (anaHighEntityCitedPaperDois.includes(paper.doi)) return 0.9;\n    }\n    return 0.3;\n  };\n  const rectStroke = (paper) => {\n    if (paper.doi === anaSelectHighlightPaperDoi) return \"red\";\n    if (\n      anaSelectHighlightPaperDoi.length > 0 &&\n      anaHighPapersDoiSet.has(paper.doi)\n    ) {\n      if (paper.refList.includes(anaSelectHighlightPaperDoi)) return \"#333\";\n      if (doi2paper[anaSelectHighlightPaperDoi].refList.includes(paper.doi))\n        return \"#333\";\n    }\n    if (anaHighEntityTopic >= 0) {\n      if (anaHighEntityCitePaperDois.includes(paper.doi)) return \"#666\";\n      if (anaHighEntityCitedPaperDois.includes(paper.doi)) return \"#666\";\n    }\n    if (anaFilterType === \"none\") return \"#fff\";\n    if (anaHighPapersDoiSet.has(paper.doi)) return \"#666\";\n    else return \"#fff\";\n  };\n  const rectStrokeWidth = (paper) => {\n    if (paper.doi === anaSelectHighlightPaperDoi) return 2;\n    else if (\n      anaSelectHighlightPaperDoi.length > 0 &&\n      anaHighPapersDoiSet.has(paper.doi)\n    ) {\n      if (paper.refList.includes(anaSelectHighlightPaperDoi)) return 1;\n      if (doi2paper[anaSelectHighlightPaperDoi].refList.includes(paper.doi))\n        return 1;\n    }\n    return 1;\n  };\n  const rectStrokeDashArray = (paper) => {\n    if (paper.doi === anaSelectHighlightPaperDoi) return [4, 7];\n    if (\n      anaSelectHighlightPaperDoi.length > 0 &&\n      anaHighPapersDoiSet.has(paper.doi)\n    ) {\n      if (paper.refList.includes(anaSelectHighlightPaperDoi)) return \"none\";\n      if (doi2paper[anaSelectHighlightPaperDoi].refList.includes(paper.doi))\n        return \"none\";\n    }\n    if (anaHighEntityTopic >= 0) {\n      if (anaHighEntityCitePaperDois.includes(paper.doi)) return \"none\";\n      if (anaHighEntityCitedPaperDois.includes(paper.doi)) return \"none\";\n    }\n    if (anaFilterType === \"none\") return \"none\";\n    if (anaHighPapersDoiSet.has(paper.doi)) return [5, 4];\n    else return \"none\";\n  };\n\n  // contour\n  const contourFunc = d3\n    .contourDensity()\n    .x((paper) => x(+paper.year))\n    .y((paper) => y(doi2indexByYear[paper.doi]))\n    .size([width, height])\n    .bandwidth(30)\n    .thresholds(5);\n  const contour = contourFunc(anaHighPapers)[0];\n  const contourColor =\n    anaFilterType === \"none\"\n      ? \"none\"\n      : anaFilterType === \"topic\"\n      ? topicColorScale[anaHighTopic]\n      : \"#aaa\";\n  const contourOpacity = anaFilterType === \"none\" ? 0 : 0.25;\n\n  // internal-links\n  const doi2paper = {};\n  analysisPapers.forEach((paper) => (doi2paper[paper.doi] = paper));\n  const internalLinks = [];\n  analysisPapers.forEach((paper) => {\n    paper.refList.forEach((refPaperDoi) => {\n      if (refPaperDoi in doi2paper) {\n        // const refPaper = doi2paper[refPaperDoi]\n        const link = {\n          source: refPaperDoi,\n          target: paper.doi,\n          weight: 1,\n        };\n        internalLinks.push(link);\n      }\n    });\n  });\n  const diagonal = d3\n    .linkHorizontal()\n    .x((doi) => x(doi2paper[doi].year))\n    .y((doi) => y(doi2indexByYear[doi]));\n  const computedPath = (d) => {\n    if (y(doi2indexByYear[d.source]) === y(doi2indexByYear[d.target])) {\n      const x0 = x(doi2paper[d.source].year);\n      const y0 = y(doi2indexByYear[d.source]);\n      const x3 = x(doi2paper[d.target].year);\n      const y3 = y0;\n\n      const x1 = x0 + (x3 - x0) * 0.3;\n      const x2 = x0 + (x3 - x0) * 0.7;\n      const y1 =\n        y0 +\n        ((height - padding.bottom - padding.top) / d3.max(paperCountByYear)) *\n          0.8;\n      const y2 = y1;\n      return `M${x0},${y0} C ${x1},${y1},${x2},${y2},${x3},${y3}`;\n    } else {\n      return diagonal(d);\n    }\n  };\n  const linkStroke = (link) => {\n    // 选中中心文献，高亮“中心文献”与“子集合内部”的所有引用连边。\n    if (\n      (link.source === anaSelectHighlightPaperDoi &&\n        anaHighPapersDoiSet.has(link.target)) ||\n      (link.target === anaSelectHighlightPaperDoi &&\n        anaHighPapersDoiSet.has(link.source))\n    )\n      return \"#333\";\n\n    // 有高亮主题且高亮连边的情况下，主题影响力颜色方向\n    if (anaHighEntityTopic >= 0) {\n      if (\n        anaHighEntityCitePaperDois.includes(link.target) &&\n        anaHighTopicIndenpentPaperDois.includes(link.source)\n      )\n        return topicColorScale[anaHighTopic];\n      if (\n        anaHighEntityCitedPaperDois.includes(link.source) &&\n        anaHighTopicIndenpentPaperDois.includes(link.target)\n      )\n        return topicColorScale[anaHighEntityTopic];\n    }\n\n    // 集合内部\n    if (\n      anaHighPapersDoiSet.has(link.source) &&\n      anaHighPapersDoiSet.has(link.target)\n    )\n      return \"#555\";\n    return \"#aaa\";\n  };\n  const linkOpacity = (link) => {\n    if (\n      (link.source === anaSelectHighlightPaperDoi &&\n        anaHighPapersDoiSet.has(link.target)) ||\n      (link.target === anaSelectHighlightPaperDoi &&\n        anaHighPapersDoiSet.has(link.source))\n    )\n      return 1;\n    if (anaFilterType === \"none\") return 0.1;\n    if (anaHighEntityTopic >= 0) {\n      if (\n        anaHighEntityCitePaperDois.includes(link.target) &&\n        anaHighTopicIndenpentPaperDois.includes(link.source)\n      )\n        return 0.9;\n      if (\n        anaHighEntityCitedPaperDois.includes(link.source) &&\n        anaHighTopicIndenpentPaperDois.includes(link.target)\n      )\n        return 0.9;\n    }\n    if (\n      anaHighEntityTopic < 0 &&\n      anaHighPapersDoiSet.has(link.source) &&\n      anaHighPapersDoiSet.has(link.target)\n    )\n      return 0.35;\n    return 0;\n  };\n  const strokeWidth = (link) => {\n    if (\n      link.source === anaSelectHighlightPaperDoi ||\n      link.target === anaSelectHighlightPaperDoi\n    )\n      return 1;\n    if (anaHighEntityTopic >= 0) {\n      if (\n        anaHighEntityCitePaperDois.includes(link.target) &&\n        anaHighTopicIndenpentPaperDois.includes(link.source)\n      )\n        return 1;\n      if (\n        anaHighEntityCitedPaperDois.includes(link.source) &&\n        anaHighTopicIndenpentPaperDois.includes(link.target)\n      )\n        return 1;\n    }\n    if (\n      anaHighPapersDoiSet.has(link.source) &&\n      anaHighPapersDoiSet.has(link.target)\n    )\n      return 1;\n    return 0;\n  };\n\n  const handleHover = (e, doi) => {\n    const { clientX, clientY } = e;\n    setAnaHoverPaperDoi(clientX, clientY, doi);\n  };\n\n  const [uniform, setUniform] = useState(\"on\");\n  const handleChange = (value) => {\n    setUniform(value);\n  };\n\n  return (\n    <div className=\"ana-network-view\" style={{ pointerEvents: \"none\" }}>\n      <svg id={svgId} width=\"100%\" height=\"100%\">\n        <g id=\"ana-network-axis\">\n          <path\n            d={`M${padding.left * 0.3},${padding.top * 0.63}H${\n              width - padding.right * 0.3\n            }`}\n            stroke=\"#666\"\n            strokeWidth=\"1\"\n          />\n          <g id=\"ana-network-axis-labels\">\n            {anaYearRange.map((year) => (\n              <text\n                key={year}\n                x={x(year)}\n                y={padding.top * 0.5}\n                fontSize=\"14\"\n                fill=\"#888\"\n                textAnchor=\"middle\"\n              >\n                {year}\n              </text>\n            ))}\n          </g>\n        </g>\n        <g id=\"network-contour-g\">\n          <path\n            d={d3.geoPath()(contour)}\n            fill={contourColor}\n            opacity={contourOpacity}\n            // stroke=\"#333\"\n            // strokeDasharray=\"8\"\n            // strokeWidth=\"2\"\n          />\n        </g>\n        <g id=\"network-links-g\" fill=\"none\">\n          {internalLinks.map((link) => (\n            <path\n              key={`${link.source}-${link.target}`}\n              d={computedPath(link)}\n              strokeLinecap=\"round\"\n              stroke={linkStroke(link)}\n              strokeWidth={strokeWidth(link)}\n              opacity={linkOpacity(link)}\n            />\n          ))}\n        </g>\n        <g id=\"network-rects-g\">\n          {analysisPapers.map((paper) => {\n            const topicsDis = paper.topics.map((t) => t[1]);\n            const topicsDisSum = topicsDis.reduce((s, a) => s + a, 0);\n            const topicsWidth = topicsDis\n              .slice(1)\n              .map(\n                (t) =>\n                  (t / topicsDisSum < 0.2 ? 0.2 : t / topicsDisSum) * rectWidth\n              );\n            topicsWidth.unshift(\n              rectWidth - topicsWidth.reduce((s, a) => s + a, 0)\n            );\n            const topicX = [0];\n            for (let i = 0; i < topicsWidth.length - 1; i++) {\n              topicX.push(topicX[i] + topicsWidth[i]);\n            }\n            return (\n              <g\n                key={paper.doi}\n                transform={`translate(${x(+paper.year)}, ${y(\n                  doi2indexByYear[paper.doi]\n                )})`}\n                cursor=\"pointer\"\n                opacity={rectOpacity(paper)}\n                onClick={() => setAnaSelectHighlightPaperDoi(paper.doi)}\n                onMouseEnter={(e) => handleHover(e, paper.doi)}\n                onMouseLeave={removeHoverPaperDoi}\n                style={{ pointerEvents: \"auto\" }}\n              >\n                <>\n                  {paper.topics.map((topic, i, s) => (\n                    <rect\n                      key={topic[0]}\n                      fill={topicColorScale[topic[0]]}\n                      // x={-rectWidth / 2 + (rectWidth / s.length) * i}\n                      x={\n                        uniform === \"on\"\n                          ? -rectWidth / 2 + (rectWidth / s.length) * i\n                          : -rectWidth / 2 + topicX[i]\n                      }\n                      y={-rectHeight / 2}\n                      // width={rectWidth / s.length}\n                      width={\n                        uniform === \"on\" ? rectWidth / s.length : topicsWidth[i]\n                      }\n                      height={rectHeight}\n                      stroke=\"#fff\"\n                      strokeWidth=\"1\"\n                    />\n                  ))}\n                  <rect\n                    x={-rectWidth / 2 - rectStrokeWidth(paper) / 2}\n                    y={-rectHeight / 2 - rectStrokeWidth(paper) / 2}\n                    fill=\"none\"\n                    width={rectWidth + rectStrokeWidth(paper)}\n                    height={rectHeight + rectStrokeWidth(paper)}\n                    stroke={rectStroke(paper)}\n                    strokeWidth={rectStrokeWidth(paper)}\n                    strokeLinecap=\"round\"\n                    strokeDasharray={rectStrokeDashArray(paper)}\n                  />\n                </>\n              </g>\n            );\n          })}\n        </g>\n      </svg>\n      <div className=\"topics-uniform-select\" style={{ pointerEvents: \"auto\" }}>\n        <div className=\"select-label\">uniform</div>\n        <Select\n          defaultValue=\"on\"\n          style={{ width: 60 }}\n          onChange={handleChange}\n          size=\"small\"\n        >\n          <Option value=\"on\">on</Option>\n          <Option value=\"off\">off</Option>\n        </Select>\n      </div>\n    </div>\n  );\n});\n\nexport default NetworkView;\n","import React from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport { useClientRect } from \"Hooks\";\nimport { get } from \"lodash\";\nimport * as d3 from \"d3\";\n\nconst TopicView = observer(() => {\n  const store = useGlobalStore();\n  const {\n    // topics_detail,\n    topics_word_dis,\n    topicColorScale,\n    // analysisPapers,\n    // anaHighPapers,\n    anaFilterType,\n    // setAnaHighPapersByTopic,\n    anaHighTopic,\n    setAnaHighPapersByTopic,\n    num_topics,\n  } = store;\n  const svgId = \"topic-list-content-svg\";\n  const clientRect = useClientRect({ svgId });\n  const { width, height } = clientRect;\n  const columnWidth = width / num_topics;\n  const paddingTop = 0.01;\n  const wordsHeight = 0.85;\n  const topicLableTop = 0.02;\n  // const topicLableHeight = 1 - paddingTop - wordsHeight;\n  const wordHeight = wordsHeight / get(topics_word_dis, `[0].length`, 1);\n\n  const fontSize = d3\n    .scaleLinear()\n    .domain([\n      d3.min(topics_word_dis.map((topics) => d3.min(topics, (d) => d[1]))),\n      d3.max(topics_word_dis.map((topics) => d3.max(topics, (d) => d[1]))),\n      // 10, 20,\n    ])\n    .range([wordHeight * 0.45 * height, wordHeight * 1.1 * height])\n    .clamp(true);\n\n  // const min_topics = [\n  //   [\n  //     \"visual\",\n  //     \"data\",\n  //     \"analysi\",\n  //     \"user\",\n  //     \"interact\",\n  //     \"explor\",\n  //     \"media\",\n  //     \"analyt\",\n  //     \"pattern\",\n  //     \"social\",\n  //   ],\n  //   [\n  //     \"visual\",\n  //     \"data\",\n  //     \"graph\",\n  //     \"interact\",\n  //     \"user\",\n  //     \"system\",\n  //     \"pattern\",\n  //     \"traffic\",\n  //     \"analysi\",\n  //     \"propos\",\n  //   ],\n  //   [\n  //     \"data\",\n  //     \"visual\",\n  //     \"flow\",\n  //     \"parallel\",\n  //     \"feature\",\n  //     \"particl\",\n  //     \"volum\",\n  //     \"method\",\n  //     \"propos\",\n  //     \"trace\",\n  //   ],\n  //   [\n  //     \"pm2\",\n  //     \"stream\",\n  //     \"5\",\n  //     \"visual\",\n  //     \"volume\",\n  //     \"transfer\",\n  //     \"model\",\n  //     \"function\",\n  //     \"event\",\n  //     \"seismic\",\n  //   ],\n  // ];\n\n  // const min_topics_2 = [\n  //   [\n  //     \"visual\",\n  //     \"topic\",\n  //     \"paper\",\n  //     \"citat\",\n  //     \"user\",\n  //     \"data\",\n  //     \"analysi\",\n  //     \"literatur\",\n  //     \"collect\",\n  //     \"use\",\n  //   ],\n  //   [\n  //     \"visual\",\n  //     \"document\",\n  //     \"topic\",\n  //     \"inform\",\n  //     \"collect\",\n  //     \"paper\",\n  //     \"use\",\n  //     \"set\",\n  //     \"analysi\",\n  //     \"text\",\n  //   ],\n  //   [\n  //     \"visual\",\n  //     \"influenc\",\n  //     \"graph\",\n  //     \"cluster\",\n  //     \"map\",\n  //     \"citat\",\n  //     \"use\",\n  //     \"can\",\n  //     \"network\",\n  //     \"summar\",\n  //   ],\n  //   [\n  //     \"visual\",\n  //     \"network\",\n  //     \"data\",\n  //     \"interact\",\n  //     \"research\",\n  //     \"inform\",\n  //     \"explor\",\n  //     \"dynam\",\n  //     \"analysi\",\n  //     \"citat\",\n  //   ],\n  // ];\n\n  // const topicDis_map = {\n  //   social: 9,\n  //   media: 8,\n  //   user: 5,\n  //   graph: 5,\n  //   traffic: 9,\n  //   interact: 6,\n  //   parallel: 6,\n  //   volum: 7,\n  //   trace: 5,\n  //   flow: 4,\n  //   transfer: 4,\n  //   model: 3,\n  //   function: 4,\n  //   event: 5,\n  //   topic: 9,\n  //   literatur: 8,\n  //   analysi: 6,\n  //   citat: 5,\n  //   text: 7,\n  //   document: 4,\n  //   influenc: 8,\n  //   network: 8,\n  //   dynam: 8,\n  //   interact: 5\n  // };\n\n  // const fakeSize = (word) => {\n  //   if (word in topicDis_map)\n  //     return 10 + topicDis_map[word] + Math.random() * 5;\n  //   else return 10 + Math.random() * 5;\n  // };\n\n  return (\n    <div className=\"topic-list-view\">\n      <div className=\"topic-list-header\">Topic List</div>\n      <div className=\"topic-list-content\">\n        <svg id={svgId} width=\"100%\" height=\"100%\">\n          <g\n            className=\"topic-list-words\"\n            transform={`translate(0, ${height * paddingTop})`}\n            textAnchor=\"middle\"\n          >\n            {topics_word_dis.map((topic_dis, i) => (\n              <g\n                className=\"topic-list-words-column\"\n                key={i}\n                transform={`translate(${columnWidth * (i + 0.5)}, 0)`}\n                opacity={\n                  anaFilterType === \"topic\" && anaHighTopic !== i ? 0.2 : 1\n                }\n              >\n                {topic_dis.map((topic, j) => (\n                  <g\n                    className=\"topic-list-word\"\n                    key={j}\n                    transform={`translate(0, ${wordHeight * height * (j + 1)})`}\n                  >\n                    <text fontSize={fontSize(topic[1])} fill=\"#333\">\n                      {/* <text fontSize={fakeSize(min_topics_2[i][j])} fill=\"#333\">\n                      {min_topics_2[i][j]} */}\n                      {topic[0]}\n                      {/* {min_topics_2[i][j]} */}\n                    </text>\n                  </g>\n                ))}\n              </g>\n            ))}\n          </g>\n          <g\n            className=\"topic-list-topics-label\"\n            transform={`translate(0, ${\n              height * (paddingTop + wordsHeight + topicLableTop)\n            })`}\n          >\n            {d3.range(num_topics).map((i) => (\n              <g\n                className=\"topic-list-topic-label\"\n                transform={`translate(${columnWidth * (i + 0.5)}, 0)`}\n                onClick={() => setAnaHighPapersByTopic(i)}\n                opacity={\n                  anaFilterType === \"topic\" && anaHighTopic !== i ? 0.2 : 1\n                }\n              >\n                <rect\n                  x={-columnWidth * 0.25}\n                  y={fontSize(30) * 0.1}\n                  width={columnWidth * 0.5}\n                  height={fontSize(30) * 0.95}\n                  fill={topicColorScale[i]}\n                />\n                <text\n                  fontSize={fontSize(30) * 0.5}\n                  fill=\"#fff\"\n                  textAnchor=\"middle\"\n                  x=\"0\"\n                  y={fontSize(30) * 0.77}\n                >\n                  Topic {i + 1}\n                </text>\n              </g>\n            ))}\n          </g>\n        </svg>\n      </div>\n    </div>\n  );\n});\n\nexport default TopicView;\n","import React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport { useClientRect } from \"Hooks\";\nimport * as d3 from \"d3\";\nimport { get } from \"mobx\";\n// import { UserOutlined } from \"@ant-design/icons\";\n\nconst fontL = 0.022;\nconst fontM = 0.02;\nconst fontS = 0.015;\n\nconst ratio = (r) => `${r * 100}%`;\n\nconst headerRatio = 0.045;\nconst timeDistributionRatio = 0.1;\n\nconst heatmapTitleRatio = 0.03;\nconst heatmapRowRatio = 0.024;\nconst heatmapRowLabelWidthRatio = 0.24;\nconst heatmapRowRectsLeftPaddingRatio = 0.05;\nconst heatmapRowRectsRightPaddingRatio = 0.03;\nconst heatmapRowRectsWidthRatio =\n  1 -\n  heatmapRowLabelWidthRatio -\n  heatmapRowRectsLeftPaddingRatio -\n  heatmapRowRectsRightPaddingRatio;\nconst heatmapRectHeightRatio = 0.018;\nconst heatmapRectWidthRatio = 0.75;\nconst heatmapBottomRatio = 0.01;\nconst heatmapColors = [\"#c6dbef\", \"#9ecae1\", \"#6baed6\", \"#3182bd\", \"#08519c\"];\n\nconst authorCount = 10;\nconst keywordsCount = 10;\n\nconst StatisticsView = observer(() => {\n  const svgId = \"statistics-view-svg\";\n  const clientRect = useClientRect({\n    svgId,\n  });\n  const { width, height } = clientRect;\n\n  const headerStyle = { transform: `translateY(${ratio(0)})` };\n  const timeDisStyle = { transform: `translateY(${ratio(headerRatio)})` };\n  const authorDisStyle = {\n    transform: `translateY(${ratio(headerRatio + timeDistributionRatio)})`,\n  };\n  const keywordDisStyle = {\n    transform: `translateY(${ratio(\n      headerRatio +\n        timeDistributionRatio +\n        (heatmapTitleRatio + heatmapRowRatio * authorCount + heatmapBottomRatio)\n    )})`,\n  };\n  const topicDisStyle = {\n    transform: `translateY(${ratio(\n      headerRatio +\n        timeDistributionRatio +\n        (heatmapTitleRatio +\n          heatmapRowRatio * authorCount +\n          heatmapBottomRatio) +\n        (heatmapTitleRatio +\n          heatmapRowRatio * keywordsCount +\n          heatmapBottomRatio)\n    )})`,\n  };\n\n  const store = useGlobalStore();\n  const {\n    analysisPapers,\n    anaHighPapers,\n    anaTagViewData,\n    anaYearRange,\n    num_topics,\n    topicColorScale,\n    anaFilterType,\n    anaHighTag,\n    anaHighTopic,\n    setAnaFilterType,\n    setAnaHighPapersByYear,\n    setAnaHighPapersByTag,\n    setAnaHighPapersByTopic,\n    startYear,\n    endYear,\n    setClearBrushTrigger,\n    clearBrushTrigger,\n  } = store;\n  // console.log(\"analysisPapers\", analysisPsapers);\n\n  const authorData = anaTagViewData\n    .find((d) => d.value === \"authors\")\n    .data.slice(0, authorCount);\n\n  const keywordData = anaTagViewData\n    .find((d) => d.value === \"keywords\")\n    .data.slice(0, keywordsCount);\n\n  const topicData = d3.range(0, num_topics).map((topic_index) => {\n    const papers = analysisPapers.filter((paper) =>\n      paper.topics.map((a) => a[0]).includes(topic_index)\n    );\n    const highlightPapers = anaHighPapers.filter((paper) =>\n      paper.topics.map((a) => a[0]).includes(topic_index)\n    );\n    return {\n      label: `topic ${topic_index + 1}`,\n      allCount: papers.length,\n      highlightCount: highlightPapers.length,\n      allDis: anaYearRange.map(\n        (year) => papers.filter((paper) => paper.year == year).length\n      ),\n      highLightDis: anaYearRange.map(\n        (year) => highlightPapers.filter((paper) => paper.year == year).length\n      ),\n      color: topicColorScale[topic_index],\n    };\n  });\n  const fakeTopicData_siming = [\n    {\n      label: `topic 1`,\n      allCount: 42,\n      highlightCount: 17,\n      allDis: [0,1,3,0,2,0,0,3,8,2,4,6,4,4,4,1],\n      highLightDis: [0,0,0,0,0,0,0,0,4,1,2,5,2,1,1,1],\n      color: topicColorScale[0]\n    },\n    {\n      label: `topic 2`,\n      allCount: 39,\n      highlightCount: 3,\n      allDis: [0,1,3,3,2,1,2,3,6,5,4,1,0,2,5,1],\n      highLightDis: [0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0],\n      color: topicColorScale[1]\n    },\n    {\n      label: `topic 3`,\n      allCount: 31,\n      highlightCount: 1,\n      allDis: [1,1,1,0,0,2,3,3,7,2,2,2,5,0,1,1],\n      highLightDis: [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],\n      color: topicColorScale[2]\n    },\n    {\n      label: `topic 4`,\n      allCount: 12,\n      highlightCount: 3,\n      allDis: [0,0,0,1,1,1,0,0,5,0,0,1,0,2,0,1],\n      highLightDis: [0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1],\n      color: topicColorScale[3]\n    },\n  ]\n  const fakeTopicData_hanqi = [\n    {\n      label: `topic 1`,\n      allCount: 42,\n      highlightCount: 4,\n      allDis: [0,1,3,0,2,0,0,3,8,2,4,6,4,4,4,1],\n      highLightDis: [0,0,0,0,1,0,0,1,1,0,0,1,0,0,0,0],\n      color: topicColorScale[0]\n    },\n    {\n      label: `topic 2`,\n      allCount: 39,\n      highlightCount: 5,\n      allDis: [0,1,3,3,2,1,2,3,6,5,4,1,0,2,5,1],\n      highLightDis: [0,0,0,0,0,1,0,0,1,1,2,0,0,0,0,0],\n      color: topicColorScale[1]\n    },\n    {\n      label: `topic 3`,\n      allCount: 31,\n      highlightCount: 19,\n      allDis: [1,1,1,0,0,2,3,3,7,2,2,2,5,0,1,1],\n      highLightDis: [0,0,0,0,0,2,2,2,5,2,2,2,2,0,0,0],\n      color: topicColorScale[2]\n    },\n    {\n      label: `topic 4`,\n      allCount: 12,\n      highlightCount: 5,\n      allDis: [0,0,0,1,1,1,0,0,5,0,0,1,0,2,0,1],\n      highLightDis: [0,0,0,0,1,1,0,0,3,0,0,0,0,0,0,0],\n      color: topicColorScale[3]\n    },\n  ]\n  // console.log(\"topicData\", topicData);\n  const allDisData = anaYearRange.map((year) => ({\n    year,\n    all: analysisPapers.filter((paper) => paper.year == year).length,\n    highlight: anaHighPapers.filter((paper) => paper.year == year).length,\n  }));\n\n  // brush\n\n  const brushStart = () => {\n    setAnaFilterType(\"year\");\n  };\n\n  const brushing = ({ selection }) => {\n    const x2year = (x) =>\n      (x / (width * heatmapRowRectsWidthRatio)) * anaYearRange.length;\n    const start = Math.floor(x2year(selection[0]));\n    const selectStartYear = anaYearRange[start > 0 ? start : 0];\n    const end = Math.floor(x2year(selection[1]));\n    const selectEndYear =\n      anaYearRange[\n        end < anaYearRange.length - 1 ? end : anaYearRange.length - 1\n      ];\n    (startYear !== selectStartYear || endYear !== selectEndYear) &&\n      setAnaHighPapersByYear([selectStartYear, selectEndYear]);\n  };\n\n  const brushEnd = (something) => {\n    if (something && something.selection) {\n    } else {\n      setAnaFilterType(\"none\");\n      setAnaHighPapersByYear([\n        anaYearRange[0],\n        anaYearRange[anaYearRange.length - 1],\n      ]);\n    }\n  };\n\n  const handleClickAuthor = (author) => {\n    setAnaHighPapersByTag({ anaHighCate: \"authors\", anaHighTag: author });\n  };\n\n  const handleClickTag = (keyword) => {\n    setAnaHighPapersByTag({ anaHighCate: \"keywords\", anaHighTag: keyword });\n  };\n\n  const handleClickTopic = (topic) => {\n    setAnaHighPapersByTopic(topic);\n  };\n\n  return (\n    <svg id={svgId} width=\"100%\" height=\"100%\">\n      <defs>\n        <linearGradient id=\"grad1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n          <stop\n            offset=\"20%\"\n            style={{ \"stop-color\": \"#777\", \"stop-opacity\": 1 }}\n          />\n          <stop\n            offset=\"100%\"\n            style={{ \"stop-color\": \"#fff\", \"stop-opacity\": 1 }}\n          />\n        </linearGradient>\n      </defs>\n      <g id=\"header-g\" style={headerStyle}>\n        <StatisticsHeader\n          allCount={analysisPapers.length}\n          highlightCount={anaHighPapers.length}\n          anaFilterType={anaFilterType}\n          width={width}\n          height={height}\n        />\n      </g>\n      <g id=\"time-distribution-g\" style={timeDisStyle}>\n        <TimeLine\n          data={allDisData}\n          width={width}\n          height={height}\n          startYear={startYear}\n          endYear={endYear}\n          brushStart={brushStart}\n          brushing={brushing}\n          brushEnd={brushEnd}\n          setClearBrushTrigger={setClearBrushTrigger}\n        />\n      </g>\n      <g id=\"authors-distribution-g\" style={authorDisStyle}>\n        <HeatmapContent height={height} title={\"Author\"} width={width}>\n          <HeatMap\n            data={authorData}\n            width={width}\n            height={height}\n            handleClick={handleClickAuthor}\n            anaHighTag={anaHighTag}\n          />\n        </HeatmapContent>\n      </g>\n      <g id=\"keywords-distribution-g\" style={keywordDisStyle}>\n        <HeatmapContent height={height} title={\"Tag\"} width={width}>\n          <HeatMap\n            data={keywordData}\n            width={width}\n            height={height}\n            handleClick={handleClickTag}\n            anaHighTag={anaHighTag}\n          />\n        </HeatmapContent>\n      </g>\n      <g id=\"topics-distribution-g\" style={topicDisStyle}>\n        <HeatmapContent height={height} title={\"Topic\"} width={width}>\n          <TopicDistribution\n            data={topicData}\n            width={width}\n            height={height}\n            handleClick={handleClickTopic}\n            anaHighTag={anaHighTag}\n          />\n        </HeatmapContent>\n      </g>\n    </svg>\n  );\n});\n\nconst StatisticsHeader = ({\n  allCount = 0,\n  highlightCount = 0,\n  anaFilterType = \"none\",\n  width = 0,\n  height = 0,\n}) => {\n  return (\n    <>\n      <text\n        x={width * 0.04}\n        y={headerRatio * height * 0.55}\n        fontSize={fontL * height}\n        fontWeight=\"600\"\n        fill=\"#444\"\n      >\n        {/* Papers: {anaFilterType === 'none' || `${highlightCount}/`}{allCount} */}\n        All Papers: {allCount}\n      </text>\n      <path\n        d={`M${width * 0.02}, ${headerRatio * height * 0.8} H${width * 0.98}`}\n        stroke=\"#ccc\"\n        strokeWidth=\"1.5\"\n      />\n      <g\n        className=\"statistics-header-legend\"\n        transform={`translate(${width * 0.61}, ${headerRatio * height * 0.1})`}\n      >\n        {heatmapColors.map((color, i) => (\n          <rect\n            key={color}\n            x={(width * 0.3 * i) / 5}\n            y={height * headerRatio * 0.1}\n            width={(width * 0.3) / 5}\n            height={height * headerRatio * 0.4}\n            fill={color}\n          />\n        ))}\n        <text\n          x={-width * 0.02}\n          y={height * headerRatio * 0.45}\n          fontSize={fontS * height}\n          textAnchor=\"end\"\n          fill=\"#999\"\n        >\n          0\n        </text>\n        <text\n          x={width * 0.32}\n          y={height * headerRatio * 0.45}\n          fontSize={fontS * height}\n          fill=\"#999\"\n        >\n          &ge;5\n        </text>\n      </g>\n    </>\n  );\n};\n\nconst timeDisYearLeftRatio = heatmapRowLabelWidthRatio * 0.7;\n\nconst timeDisBarRatio = timeDistributionRatio * 0.75;\nconst timeDisLineRatio = timeDisBarRatio + 0.05 * timeDistributionRatio;\nconst timeDisStickRatio = timeDisLineRatio + 0.05 * timeDistributionRatio;\nconst timeDisStickTextRatio = timeDisStickRatio + fontS;\n\nconst TimeLine = ({\n  data = [],\n  width = 0,\n  height = 0,\n  startYear = 0,\n  endYear = 0,\n  brushStart = () => {},\n  brushing = () => {},\n  brushEnd = () => {},\n  setClearBrushTrigger = () => {},\n}) => {\n  const maxCount = d3.max(data, (d) => d.all);\n  const yearCount = data.length === 0 ? 1 : data.length;\n  const x = (i) => ((width * heatmapRowRectsWidthRatio) / yearCount) * i;\n  const y = (count) =>\n    (height * timeDisBarRatio * (maxCount - count)) / maxCount;\n  const barWidth = ((width * heatmapRowRectsWidthRatio) / yearCount) * 0.8;\n\n  const brush = d3\n    .brushX()\n    .extent([\n      [0, 0],\n      [heatmapRowRectsWidthRatio * width, timeDisBarRatio * height],\n    ])\n    .on(\"start\", brushStart)\n    .on(\"brush\", brushing)\n    .on(\"end\", brushEnd);\n  useEffect(() => {\n    const timeline = d3.select(\".time-line-bar-chart\");\n    timeline.call(brush);\n    setClearBrushTrigger(() => {\n      d3.brush().move(timeline);\n      // brushEnd();\n    });\n  }, [width]);\n\n  const yearTextX = timeDisYearLeftRatio * width;\n  const startYearTextY = timeDistributionRatio * height * 0.3;\n  const endYearTextY = timeDistributionRatio * height * 0.8;\n  const yearTextLinkY = startYearTextY + timeDistributionRatio * height * 0.1;\n  const yearTextLinkHeight = timeDistributionRatio * height * 0.14;\n\n  return (\n    <g className=\"time-line-container\">\n      <g\n        className=\"time-line-time\"\n        fontSize={fontL * height}\n        fontWeight=\"600\"\n        fill=\"#888\"\n      >\n        <text x={yearTextX} y={startYearTextY} textAnchor=\"middle\">\n          {startYear}\n        </text>\n        <text x={yearTextX} y={endYearTextY} textAnchor=\"middle\">\n          {endYear}\n        </text>\n        <path\n          d={`M${yearTextX}, ${yearTextLinkY} v${yearTextLinkHeight} `}\n          stroke=\"#999\"\n        />\n      </g>\n      <g\n        className=\"time-line-bar-chart\"\n        transform={`translate(${\n          width * (heatmapRowLabelWidthRatio + heatmapRowRectsLeftPaddingRatio)\n        }, 0)`}\n      >\n        <g className=\"time-line-bars-background\">\n          {data.map((d, i) => (\n            <rect\n              key={i}\n              x={x(i)}\n              y={y(d.all)}\n              fill=\"#ccc\"\n              width={barWidth}\n              height={y(0) - y(d.all)}\n            />\n          ))}\n        </g>\n        <g className=\"time-line-bars-highlight\">\n          {data.map((d, i) => (\n            <rect\n              key={i}\n              x={x(i)}\n              y={y(d.highlight)}\n              fill=\"#888\"\n              width={barWidth}\n              height={y(0) - y(d.highlight)}\n            />\n          ))}\n        </g>\n        <g className=\"time-line-axis\">\n          <path\n            d={`M${-barWidth * 0.5},${timeDisLineRatio * height}h${\n              width * heatmapRowRectsWidthRatio + barWidth\n            }`}\n            stroke=\"#aaa\"\n            strokeWidth=\"1\"\n          />\n          {data.map(\n            (d, i) =>\n              +d.year % 5 === 0 && (\n                <g key={i}>\n                  <path\n                    d={`M${x(i) + barWidth * 0.5},${\n                      timeDisLineRatio * height\n                    }V${timeDisStickRatio * height}`}\n                    stroke=\"#888\"\n                    strokeWidth=\"1\"\n                  />\n                  <text\n                    x={x(i) + barWidth * 0.5}\n                    y={timeDisStickTextRatio * height}\n                    textAnchor=\"middle\"\n                    fontSize={fontS * height}\n                    fill=\"#aaa\"\n                    // fontWeight=\"600\"\n                  >\n                    {d.year}\n                  </text>\n                </g>\n              )\n          )}\n        </g>\n      </g>\n    </g>\n  );\n};\n\nconst topicBarChartBottomRatio = 0.005;\n\nconst TopicDistribution = ({\n  data = [],\n  width = 0,\n  height = 0,\n  handleClick = () => {},\n  anaHighTag = \"\",\n}) => {\n  const topicBarChartHeightRatio = data.length > 0 ? 0.21 / data.length : 0.22;\n  const maxCount = d3.max(data.map((topicData) => d3.max(topicData.allDis)));\n  const yearCount = data.length === 0 ? 1 : data[0].allDis.length;\n  const x = (i) => ((width * heatmapRowRectsWidthRatio) / yearCount) * i;\n  const y = (count) =>\n    (height * topicBarChartHeightRatio * (maxCount - count)) / maxCount;\n\n  return (\n    <g className=\"topic-bar-chart\">\n      {data.map((topicData, i) => (\n        <g\n          key={topicData.label}\n          transform={`translate(0, ${\n            (topicBarChartHeightRatio + topicBarChartBottomRatio) * height * i\n          })`}\n          fill={topicData.color}\n          style={{ pointerEvents: \"none\" }}\n        >\n          <rect\n            x={width * 0.01}\n            y={-(y(0) - y(maxCount)) * 0.04}\n            // rx={5}\n            // ry={5}\n            height={(y(0) - y(maxCount)) * 1.08}\n            width={width * 0.98}\n            fill=\"transparent\"\n            className={`svg-shadow-hover ${\n              anaHighTag === topicData.label ? \"svg-shadow-active\" : \"\"\n            }\n            `}\n            style={{ pointerEvents: \"auto\" }}\n            onClick={() => handleClick(i)}\n          />\n          <text\n            x={heatmapRowLabelWidthRatio * width}\n            y={topicBarChartHeightRatio * height * 0.42}\n            fontSize={fontS * height}\n            fontWeight=\"600\"\n            textAnchor=\"end\"\n          >\n            {topicData.label}\n          </text>\n          <text\n            x={heatmapRowLabelWidthRatio * width}\n            y={topicBarChartHeightRatio * height * 0.92}\n            fontSize={fontS * height}\n            fontWeight=\"600\"\n            textAnchor=\"end\"\n          >\n            {topicData.highlightCount}/{topicData.allCount}\n          </text>\n          <g\n            className=\"topic-bar-chart-background-bars\"\n            transform={`translate(${\n              width *\n              (heatmapRowLabelWidthRatio + heatmapRowRectsLeftPaddingRatio)\n            }, 0)`}\n          >\n            {topicData.allDis.map((count, j) => (\n              <rect\n                key={j}\n                x={x(j)}\n                y={y(count)}\n                width={((width * heatmapRowRectsWidthRatio) / yearCount) * 0.8}\n                fill={'#ccc'}\n                height={y(0) - y(count)}\n              />\n            ))}\n          </g>\n          <g\n            className=\"topic-bar-chart-active-bars\"\n            transform={`translate(${\n              width *\n              (heatmapRowLabelWidthRatio + heatmapRowRectsLeftPaddingRatio)\n            }, 0)`}\n          >\n            {topicData.highLightDis.map((count, j) => (\n              <rect\n                key={j}\n                x={x(j)}\n                y={y(count)}\n                width={((width * heatmapRowRectsWidthRatio) / yearCount) * 0.8}\n                height={y(0) - y(count)}\n              />\n            ))}\n          </g>\n        </g>\n      ))}\n    </g>\n  );\n};\n\nconst HeatmapContent = ({\n  icon = \"\",\n  title = \"\",\n  children = <></>,\n  height = 0,\n  width = 0,\n}) => {\n  const titleContentHeight = height * heatmapTitleRatio;\n  return (\n    <>\n      <g className=\"heatmap-title-g\">\n        <rect\n          className=\"heatmap-title-background\"\n          x=\"20\"\n          y={titleContentHeight * 0.05}\n          width={heatmapRowLabelWidthRatio * width - 20}\n          height={titleContentHeight * 0.8}\n          // fill=\"url(#grad1)\"\n          fill=\"#999\"\n        />\n        <g className=\"heatmap-title-content\">\n          {/* <icon /> */}\n          <text\n            x={heatmapRowLabelWidthRatio * width * 0.5 + 10}\n            y={titleContentHeight * 0.64}\n            fontSize={fontS * height}\n            fill=\"#fff\"\n            fontWeight=\"600\"\n            textAnchor=\"middle\"\n          >\n            {title}\n          </text>\n        </g>\n      </g>\n      <g\n        className=\"heatmap-rows-g\"\n        transform={`translate(0, ${titleContentHeight})`}\n      >\n        {children}\n      </g>\n    </>\n  );\n};\n\nconst HeatMap = ({\n  data = [],\n  width = 0,\n  height = 0,\n  handleClick = () => {},\n  anaHighTag = \"\",\n}) => {\n  const yearCount = data.length > 0 ? data[0].all_timeDis.length : 1;\n  const rectWidth = (width * heatmapRowRectsWidthRatio) / yearCount;\n  const heatmapRowStyle = (i) => ({\n    transform: `translateY(${ratio(heatmapRowRatio * i)})`,\n  });\n  const color = (count) => {\n    if (count === 0) return \"transparent\";\n    const index = count >= heatmapColors.length ? heatmapColors.length : count;\n    return heatmapColors[index - 1];\n  };\n  return (\n    <g style={{ pointerEvents: \"none\" }}>\n      {data.map((d, i) => (\n        <g className=\"heatmap-row-g\" key={d.label} style={heatmapRowStyle(i)}>\n          <rect\n            x={width * 0.01}\n            y={-heatmapRectHeightRatio * height * 0.1}\n            // rx={5}\n            // ry={5}\n            height={heatmapRectHeightRatio * height * 1.2}\n            width={width * 0.98}\n            fill=\"transparent\"\n            className={`svg-shadow-hover ${\n              anaHighTag === d.label ? \"svg-shadow-active\" : \"\"\n            }`}\n            style={{ pointerEvents: \"auto\" }}\n            onClick={() => handleClick(d.label)}\n          />\n          {d.label.length > 13 ? (\n            <text\n              x={width * heatmapRowLabelWidthRatio}\n              y={ratio(heatmapRectHeightRatio - 0.004)}\n              fontSize={fontS * height}\n              fill=\"#666\"\n              textAnchor=\"end\"\n              // textLength=\"100\"\n              // lengthAdjust=\"spacingAndGlyphs\"\n            >\n              {d.label.length > 13 ? `${d.label.slice(0, 11)}...` : d.label}\n              {/* {d.label} */}\n            </text>\n          ) : (\n            <text\n              x={width * heatmapRowLabelWidthRatio}\n              y={ratio(heatmapRectHeightRatio - 0.004)}\n              fontSize={fontS * height}\n              fill=\"#666\"\n              textAnchor=\"end\"\n            >\n              {d.label}\n            </text>\n          )}\n\n          <g\n            className=\"heatmap-row-background-rects-g\"\n            transform={`translate(${\n              width *\n              (heatmapRowLabelWidthRatio + heatmapRowRectsLeftPaddingRatio)\n            }, 0)`}\n          >\n            {d.all_timeDis.map((count, i) => (\n              <rect\n                key={i}\n                x={rectWidth * i}\n                y=\"0\"\n                width={rectWidth * heatmapRectWidthRatio}\n                height={heatmapRectHeightRatio * height}\n                fill={count > 0 ? \"#ddd\" : \"transparent\"}\n                opacity={0.8}\n              />\n            ))}\n          </g>\n\n          <g\n            className=\"heatmap-row-highlight-rects-g\"\n            transform={`translate(${\n              width *\n              (heatmapRowLabelWidthRatio + heatmapRowRectsLeftPaddingRatio)\n            }, 0)`}\n          >\n            {d.highlight_timeDis.map((count, i) => (\n              <rect\n                key={i}\n                x={rectWidth * i}\n                y=\"0\"\n                width={rectWidth * heatmapRectWidthRatio}\n                height={heatmapRectHeightRatio * height}\n                fill={color(count)}\n                opacity={0.8}\n              />\n            ))}\n          </g>\n        </g>\n      ))}\n    </g>\n  );\n};\n\nexport default StatisticsView;\n","import React, { useState } from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport { useClientRect } from \"Hooks\";\nimport * as d3 from \"d3\";\nimport { Table, Tag, Space } from \"antd\";\nimport { get } from \"lodash\";\nimport { toJS } from \"mobx\";\n\nconst PapersTable = observer(() => {\n  const store = useGlobalStore();\n  const {\n    analysisPapers,\n    anaHighPapers,\n    anaFilterType,\n    anaHighTag,\n    anaHighTopic,\n    anaSelectHighlightPaperDoi,\n    setAnaSelectHighlightPaperDoi,\n    setAnaHoverPaperDoi,\n    removeHoverPaperDoi,\n  } = store;\n  const [sortAttr, setSortAttr] = useState(\"year\");\n  const [order, setOrder] = useState(1);\n  const papers = [...anaHighPapers].sort(\n    (a, b) => order * (+a[sortAttr] - +b[sortAttr])\n  );\n  // const papers = [\n  //   ...anaHighPapers.filter(\n  //     (paper) => paper.doi === anaSelectHighlightPaperDoi\n  //   ),\n  //   ...[\n  //     ...anaHighPapers.filter(\n  //       (paper) => paper.doi !== anaSelectHighlightPaperDoi\n  //     ),\n  //   ].sort((a, b) => order * (+a[sortAttr] - +b[sortAttr])),\n  // ];\n  const handleClick = (attr) => {\n    if (attr === sortAttr) setOrder(order * -1);\n    else setSortAttr(attr);\n  };\n  const columns = [\n    {\n      title: \"Title\",\n      showText: (paper) => paper.title,\n      style: {\n        width: \"50%\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\",\n        whiteSpace: \"nowrap\",\n      },\n      onClick: () => {},\n    },\n    {\n      title: \"Authors\",\n      showText: (paper) => get(paper, \"authors[0]\", \"\"),\n      style: {\n        width: \"22%\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\",\n        whiteSpace: \"nowrap\",\n        textAlign: \"center\",\n      },\n      onClick: () => {},\n    },\n    {\n      title: \"Venue\",\n      showText: (paper) => get(paper, \"conferenceName\", \"\"),\n      style: {\n        width: \"13%\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\",\n        whiteSpace: \"nowrap\",\n        textAlign: \"center\",\n      },\n      onClick: () => {},\n    },\n    {\n      title: \"Year\",\n      showText: (paper) => paper.year,\n      style: {\n        width: \"10%\",\n        display: \"flex\",\n        justifyContent: \"center\",\n      },\n      onClick: () => handleClick(\"year\"),\n    },\n    {\n      title: \"Cite\",\n      showText: (paper) => paper.citationCount,\n      style: {\n        width: \"7%\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        border: \"none\",\n      },\n      onClick: () => handleClick(\"citationCount\"),\n    },\n  ];\n\n  const allCount = analysisPapers.length;\n  const highlightCount = anaHighPapers.length;\n  const handleClickPaperRow = (paper) =>\n    setAnaSelectHighlightPaperDoi(paper.doi);\n\n  const handleHover = (e, doi) => {\n    const { clientX, clientY } = e;\n    setAnaHoverPaperDoi(clientX, clientY, doi);\n  };\n\n  return (\n    <div className=\"papers-table-container\">\n      <div className=\"papers-table-title\">\n        <div>\n          Paper List (\n          {`${anaFilterType === \"none\" ? \"\" : `${highlightCount}/`}${allCount}`}\n          )\n        </div>\n        {anaFilterType === \"none\" || (\n          <div style={{ marginRight: 10 }}>\n            {anaHighTag}\n          </div>\n        )}\n      </div>\n      <div className=\"papers-table-content\">\n        <div className=\"papers-table-header\">\n          {columns.map((column) => (\n            <div\n              className=\"papers-table-header-column\"\n              style={column.style}\n              onClick={column.onClick}\n            >\n              {column.title}\n            </div>\n          ))}\n        </div>\n        <div className=\"papers-table-rows-container\">\n          {papers.map((paper) => (\n            <div\n              key={paper.doi}\n              className={`papers-table-row ${\n                anaSelectHighlightPaperDoi === paper.doi\n                  ? \"papers-table-row-active\"\n                  : \"\"\n              }`}\n              onClick={() => handleClickPaperRow(paper)}\n              onMouseEnter={(e) => handleHover(e, paper.doi)}\n              onMouseLeave={removeHoverPaperDoi}\n            >\n              {columns.map((column) => (\n                <div className=\"papers-table-column\" style={column.style}>\n                  {column.showText(paper)}\n                </div>\n              ))}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n});\n\nexport default PapersTable;\n","import React from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport { useClientRect } from \"Hooks\";\nimport * as d3 from \"d3\";\n\nconst HoverTooltip = observer(() => {\n  const store = useGlobalStore();\n  const width = document.querySelector(\"body\").clientWidth;\n  const height = document.querySelector(\"body\").clientHeight;\n  const {\n    anaHoverPaperDoi,\n    anaHoverPaperPositionX,\n    anaHoverPaperPositionY,\n    anaHoverPaper,\n  } = store;\n  const attrs = [\n    {\n      label: \"Keywords\",\n      showText: (paper) => paper.keywords.join(\"; \"),\n    },\n    // {\n    //   label: \"Affiliation\",\n    //   showText: (paper) => paper.affiliation,\n    // },\n    {\n      label: \"Abstract\",\n      showText: (paper) => paper.abstract,\n    },\n    // {\n    //   label: \"\",\n    //   showText: (paper) => paper,\n    // },\n    // {\n    //   label: \"\",\n    //   showText: (paper) => paper,\n    // },\n  ];\n  const style = {\n    left: anaHoverPaperPositionX - 20,\n    top: anaHoverPaperPositionY + 30,\n  };\n  return anaHoverPaperDoi.length === 0 ? (\n    <div className=\"ana-hover-tooltip-container\"></div>\n  ) : (\n    <div className=\"ana-hover-tooltip-container\" style={style}>\n      <div className=\"ana-tooltip-header\">\n        <div className=\"ana-tooltip-title\">{anaHoverPaper.title}</div>\n        <div className=\"ana-tooltip-authors-venue-year\">\n          {anaHoverPaper.authors.join(\"; \")} ({anaHoverPaper.conferenceName}{\" \"}\n          {anaHoverPaper.year})\n        </div>\n      </div>\n      <div className=\"ana-tooltip-content\">\n        {attrs.map((attr) => (\n          <div className=\"ana-tooltip-content-row\" key={attr.label}>\n            <span className=\"ana-tooltip-row-label\">{attr.label}:</span>\n            <span className=\"ana-tooltip-row-text\">\n              {attr.showText(anaHoverPaper)}\n            </span>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n});\n\nexport default HoverTooltip;\n","import React, { useEffect } from \"react\";\nimport { useGlobalStore } from \"Store\";\nimport \"./index.scss\";\n// import TagView from \"./TagView\";\n// import TagView from \"./TagView-Hor\";\nimport ProjectView from \"./ProjectView-New\";\nimport NetworkView from \"./NetworkView-New\";\n// import TopicView from \"./TopicView\";\nimport TopicView from \"./TopicView-New\";\n// import HighlightListView from \"./HighlightListView\";\n// import DetailView from \"./DetailView\";\nimport StatisticsView from \"./StatisticsView\";\nimport PapersTable from \"./PapersTable\";\nimport HoverTooltip from \"./HoverTooltip\";\n\nconst AnalysisPage = () => {\n  const store = useGlobalStore();\n  useEffect(() => {\n    store.setCurrentPage();\n    store.initPapers();\n    store.initUserId();\n  }, []);\n  return (\n    <div className=\"analysis-container\">\n      <HoverTooltip />\n      <div className=\"left-container\">\n        {/* <TagView /> */}\n        <StatisticsView />\n      </div>\n      <div className=\"middle-container\">\n        <div className=\"middle-top-container\">\n          <ProjectView />\n        </div>\n        <div className=\"middle-bottom-container\">\n          <NetworkView />\n        </div>\n      </div>\n      <div className=\"right-container\">\n        <div className=\"right-top-container\">\n          <TopicView />\n        </div>\n        {/* <div className=\"right-middle-container\">\n          <HighlightListView />\n        </div>\n        <div className=\"right-bottom-container\">\n          <DetailView /> \n        </div> */}\n        <div className=\"right-middle-bottom-container\">\n          <PapersTable />\n        </div>\n      </div>\n      <HoverTooltip />\n    </div>\n  );\n};\n\nexport default AnalysisPage;\n","export const userList = [\n  \"Prof. Yuan\",\n  \"Guozheng Li\",\n  \"Shuai Chen\",\n  \"Chenglei Yue\",\n  \"Ruike Jiang\",\n  \"Can Liu\",\n  \"Jincheng Li\",\n  \"Chaofan Yang\",\n  \"Hanning Shao\",\n  \"Yuchu Luo\",\n  \"Zhixian Lin\",\n  \"Min Tian\",\n  \"Dingyi Yang\",\n  \"Changhe Yang\",\n  \"Yanda Li\",\n  \"Datong Wei\",\n  \"Cong Wu\",\n  \"Hao Wu\",\n  \"Shaocong Tan\",\n  \"Jiacheng Yu\",\n  \"Sihang Li\",\n  \"Zhen Li\",\n  \"Haohua Liu\",\n  \"KaiChen Nie\"\n];\n\nexport default userList;\n","import React, { useState } from \"react\";\nimport \"./index.scss\";\nimport userList from \"Common/userList\";\nimport { useGlobalStore } from \"Store\";\nimport { batchUpdatePapers } from \"Server\";\nimport { observer } from \"mobx-react-lite\";\nimport { Link } from \"react-router-dom\";\nimport { Select, Modal, Input, Upload, Button } from \"antd\";\nimport { CloudUploadOutlined, UploadOutlined } from \"@ant-design/icons\";\n\nconst { Option } = Select;\n\nconst Header = observer(() => {\n  const store = useGlobalStore();\n  const handleChange = (userId) => {\n    store.setUserId(userId);\n  };\n  const { currentPage, userId, initPapers } = store;\n  const [uploadModalShow, _setUploadModalShow] = useState(false);\n  const setUploadModalShow = () => _setUploadModalShow(!uploadModalShow);\n  // const title = `Literature ${currentPage} System`;\n  const title = 'LitVis'\n  const switchPage = currentPage === \"Analysis\" ? \"management\" : \"analysis\";\n  const switchPageShowText = currentPage === \"Analysis\" ? \"Manage\" : \"Analyze\";\n  const SwitchButton = () => (\n    <Link to={switchPage} className=\"switch-button\">\n      {switchPageShowText}\n    </Link>\n  );\n\n  const [conferenceName, setConferenceName] = useState(\"\");\n  const [publicTags, setPublicTags] = useState(\"\");\n  const [privateTags, setPrivateTags] = useState(\"\");\n  const batchUpdateItems = [\n    {\n      label: \"Conference Name\",\n      setFunc: setConferenceName,\n    },\n    {\n      label: \"Public Tags\",\n      setFunc: setPublicTags,\n    },\n    {\n      label: \"Private Tags\",\n      setFunc: setPrivateTags,\n    },\n  ];\n\n  // console.log(\"????\", conferenceName, publicTags, privateTags);\n\n  const [file, setFile] = useState(\"\");\n\n  const uploadProps = {\n    maxCount: 1,\n    beforeUpload: (file) => {\n      setFile(file);\n      return false;\n    },\n  };\n\n  const handleSubmit = () => {\n    batchUpdatePapers({\n      file,\n      conferenceName,\n      publicTags,\n      privateTags,\n      userId,\n    }).then(() => {\n      initPapers(true);\n    });\n    setUploadModalShow();\n  };\n\n  return (\n    <div className=\"header\">\n      <div className=\"title\">{title}</div>\n      <div className=\"user-selector\">\n        User: &nbsp;\n        <Select\n          value={store.userId}\n          size=\"small\"\n          onChange={handleChange}\n          style={{ width: 130 }}\n          placeholder=\"Set User\"\n        >\n          {userList.map((user) => (\n            <Option value={user} key={user}>\n              {user}\n            </Option>\n          ))}\n        </Select>\n        <SwitchButton />\n        <div className=\"update-data-trigger\" onClick={setUploadModalShow}>\n          <CloudUploadOutlined style={{ fontSize: 24 }} />\n        </div>\n      </div>\n      <Modal\n        title=\"Upload\"\n        visible={uploadModalShow}\n        onOk={handleSubmit}\n        onCancel={setUploadModalShow}\n        centered\n      >\n        {batchUpdateItems.map((item) => (\n          <div key={item.label} className=\"update_item\">\n            <div className=\"update-item-label\">{item.label}</div>\n            <Input\n              placeholder=\"Empty means no batch setting\"\n              onChange={(e) => item.setFunc(e.target.value)}\n            />\n          </div>\n        ))}\n        <Upload {...uploadProps} className=\"update_item\">\n          <Button icon={<UploadOutlined />}>bib/json/csv</Button>\n        </Upload>\n      </Modal>\n    </div>\n  );\n});\n\nexport default Header;\n","import React from \"react\";\nimport \"./App.scss\";\nimport { StoreProvider } from \"Store\";\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\nimport ManagePage from \"Pages/ManagePage\";\nimport Analysis from \"Pages/AnalysisPage\";\nimport Header from \"Components/Header\";\n\nconst App = () => {\n  return (\n    <StoreProvider>\n      <Router\n        // basename=\"/vis_paper_management\"\n      >\n        <div className=\"view-container\">\n          <div className=\"header-container\">\n            <Header />\n          </div>\n          <Switch>\n            <Route exact path={`/management`} component={ManagePage} />\n            <Route exact path={`/analysis`} component={Analysis} />\n            <Route path=\"/\" component={ManagePage} />\n          </Switch>\n        </div>\n      </Router>\n    </StoreProvider>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'antd/dist/antd.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}