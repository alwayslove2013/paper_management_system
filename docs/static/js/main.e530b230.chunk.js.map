{"version":3,"sources":["Server/index.js","Common/svgPadding.js","Common/mustInclude.js","Common/mostCommon.js","Store/createStoreV0128.js","Store/index.js","Pages/ManagePage/SearchView/index.js","Pages/ManagePage/ControlView/index.js","Pages/ManagePage/UnitView/CircleUnit.js","Pages/ManagePage/UnitView/PaperTooltip.js","Pages/ManagePage/UnitView/index.js","Pages/ManagePage/DetailView/index.js","Pages/ManagePage/index.js","Hooks/useClientRect.js","Pages/AnalysisPage/TagView/TagFilter/index.js","Pages/AnalysisPage/TagView/TimeLine/index.js","Pages/AnalysisPage/TagView/index.js","Pages/AnalysisPage/ProjectView/index.js","Pages/AnalysisPage/NetworkView/index.js","Pages/AnalysisPage/TopicView/index.js","Pages/AnalysisPage/HighlightListView/index.js","Pages/AnalysisPage/DetailView/index.js","Pages/AnalysisPage/index.js","Common/userList.js","Components/Header/index.js","App.js","reportWebVitals.js","index.js"],"names":["baseUrl","fetchData","url","params","getUrl","includes","qs","stringify","Promise","resolve","reject","fetch","then","res","json","data","catch","err","getPapers","a","getPublicTags","getPrivateTags","uid","setPrivateTags","pid","paper","privateTags","read","tags","filter","join","anaSvgPadding","left","right","top","bottom","anaTimeSvgPadding","mustInclude","list","mustIncludeList","count","slice","forEach","mustItem","i","length","mostCommon","items","n","item2Count","itemList","item","itemCountList","push","sort","b","map","attr2func","publicTags","createStore","currentPage","setCurrentPage","this","window","location","pathname","tooltipX","tooltipY","setTooltipPos","x","y","titleSearch","setTitleSearch","text","toLocaleLowerCase","searchPaperDois","papers","title","indexOf","doi","Set","commonAuthors","commonCountries","commonPublicTags","commonPrivateTags","initPapers","setPapers","compareAttr","console","log","doi2paper","colors","innerColors","outerColors","internalRefList","internalCitedList","refList","toLowerCase","split","trim","authors","replace","countries","s","part","toUpperCase","ref","computedPosition","initPublicTags","runInAction","initPrivateTags","setPaper","attr","value","find","p","userId","toJS","doiUpdateColors","unitXAttr","xAttrSet","add","xAttrList","Array","from","unitYAttr","maxUnitBlockPaperCount","unitBlockCount","xAttr","yAttr","unitIndex","Math","max","Object","values","readIndex","splice","batchUpdateColors","setUserId","localStorage","setItem","initUserId","getItem","generateCategory","label","highlightType","category2highlightType","controlTagNameList","category","activeTags","ans","key","outerCategories","isUnitOuterHighlight","outerCategory","tag2color","colorUse","setTagColor","tag","fullTag","_color","d3","updateColor","hightlightAttrs","maxCitationCount","currentSelected","currentSelectedRefSet","currentSelectedCitedSet","isSelected","setCurrentSelected","cancelSelect","controlIsActive","unitXAttrList","year","all","analysisPapers","highlight","anaHighPapers","anaCategories","anaFilterType","setAnaFilterType","type","clearBrushTrigger","setClearBrushTrigger","fn","anaHighCate","anaHighTag","setAnaHighPapersByTag","get","setAnaHighPapersByYear","yearRange","yearStart","yearEnd","storeContext","React","createContext","StoreProvider","children","store","useLocalObservable","Provider","useGlobalStore","useContext","Error","SearchView","handleInput","debounce","e","target","className","onInput","SearchOutlined","ControlView","observer","searchAttr","ControlItem","tagData","useState","setTags","useEffect","initTags","keys","handleClickOption","currentTags","index","clickOption","isSelect","ControlOption","style","background","border","value_format","onClick","CircleUnit","memo","cx","cy","r","opacity","handleClick","isBackgroundActive","handleHover","handleHoverOut","polarX","angle","sin","polarY","cos","innerStepAngle","PI","innerPoints","_","startX","startY","endX","endY","outerR","outerPolarX","outerPolarY","outerStepAngle","outerPoints","id","cursor","onMouseEnter","onMouseLeave","width","height","fill","rx","ry","point","d","stroke","strokeWidth","PaperTooltip","isShow","paperCircle","containerWidth","containerHeight","xRatio","tooltipWidth","bottomStyle","transform","unitLayoutPadding","unitBlockPadding","UnitView","unitYAttrList","searchPaperDoiSet","svgWidth","setSvgWidth","svgHeight","setSvgHeight","svg","document","querySelector","clientWidth","clientHeight","unitBlockWidth","unitBlockHeight","aspectRatio","floor","blockCountX","ceil","sqrt","xAttr2blockCountX","maxColumnBlockCount","j","xAttr2blockCountX_StartCount","xAttr2blockCountX_StartPos","scale","domain","range","paperCircles","oriData","BlockIndexX","BlockIndexY","circleIndexX","circleIndexY","citationGrey","citationCount","activeColors","has","Title","borderColor","xLabels","yLabels","handleClickPaper","stopPropagation","hoverDoi","setHoverDoi","hoverPaper","hoverPaperCircle","borderOpacity","textAnchor","fontSize","DetailView","currentSelectedPaper","editTags","size","checkedChildren","CheckOutlined","unCheckedChildren","CloseOutlined","defaultChecked","onChange","editTag","handleChangeTags","DetailItem","DetailEditTags","_setTags","newTags","editInputIndex","setEditInputIndex","input","useRef","editInputValue","setEditInputValue","handleEditInputConfirm","inputValue","setInputValue","handleInputConfirm","setInputVisible","inputVisible","onchange","onBlur","onPressEnter","closable","onClose","removeTag","PlusOutlined","ManagePage","useClientRect","svgId","clientRect","setClientRect","selectAll","remove","node","getClientRects","TagFilter","replaceAll","padding","nice","append","classed","bandwidth","on","call","g","tickSizeOuter","ticks","select","TimeLine","initYearRange","bars","rectX","tickValues","brush","extent","selection","bar","brushYear","move","highlightBarsG","TagView","anaTimeData","anaTagViewData","yearSelecting","setYearSelecting","tagViewData","ProjectView","NetworkView","TopicView","HighlightListView","DetaiView","AnalysisPage","userList","Option","Select","Header","switchPage","switchPageShowText","SwitchButton","to","placeholder","user","App","basename","exact","path","component","Analysis","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.e530b230.chunk.js","sourcesContent":["import qs from \"qs\";\n\n// const baseUrl = \"http://vis.pku.edu.cn/vis4vis/\";\nconst baseUrl = \"http://127.0.0.1:12357/\";\n\nconst fetchData = (url, params = \"\") => {\n  const getUrl =\n    baseUrl + url + (url.includes(\"?\") ? \"&\" : \"?\") + qs.stringify(params);\n  return new Promise((resolve, reject) => {\n    fetch(getUrl)\n      .then((res) => res.json())\n      .then((data) => resolve(data))\n      .catch((err) => reject(err));\n  });\n};\n\nexport const getPapers = async () => {\n  return await fetchData(\"get_papers\");\n}\n\nexport const getPublicTags = async () => {\n  return await fetchData(\"get_public_tags\");\n};\n\nexport const getPrivateTags = async ({ uid }) => {\n  return await fetchData(\"get_private_tags\", { uid });\n};\n\nexport const setPublicTags = ({ pid, paper }) => {\n  const tags = paper.publicTags;\n  fetchData(\"set_public_tags\", { pid, tags: tags.join(\",\") });\n  return \"OK\";\n};\n\nexport const setPrivateTags = ({ uid, pid, paper }) => {\n  const { privateTags, read } = paper;\n  uid &&\n    fetchData(\"set_private_tags\", {\n      uid,\n      pid,\n      tags: [...privateTags, read && \"read\"].filter((a) => a).join(\",\"),\n    });\n  return \"OK\";\n};\n","const anaSvgPadding = {\n  left: 15,\n  right: 35,\n  top: 8,\n  bottom: 45,\n};\n\nconst anaTimeSvgPadding = {\n  left: 15,\n  right: 35,\n  top: 8,\n  bottom: 25,\n};\n\nexport { anaSvgPadding, anaTimeSvgPadding };\n","// List A 必须包括 List B, 同时长度限制在count内\n\nconst mustInclude = (list, mustIncludeList, count) => {\n  list = list.slice(0, count);\n  mustIncludeList.forEach((mustItem) => {\n    if (!list.includes(mustItem)) {\n      let i = list.length - 1;\n      while (mustIncludeList.includes(list[i])) i -= 1;\n      list[i] = mustItem;\n    }\n  });\n  return list;\n}\n\nexport default mustInclude","const mostCommon = (items, n = 10) => {\n  const item2Count = {};\n  items.forEach((itemList) => {\n    itemList.forEach((item) => {\n      if (item) {\n        if (item in item2Count) {\n          item2Count[item] += 1;\n        } else {\n          item2Count[item] = 1;\n        }\n      }\n    });\n  });\n  const itemCountList = [];\n  for (let item in item2Count) {\n    itemCountList.push({\n      item,\n      count: item2Count[item],\n    });\n  }\n  itemCountList.sort((a, b) => b.count - a.count);\n  return itemCountList.slice(0, n).map(a => a.item);\n};\n\nexport default mostCommon;\n","import * as d3 from \"d3\";\nimport { toJS, runInAction } from \"mobx\";\nimport {\n  getPapers,\n  setPublicTags,\n  setPrivateTags,\n  getPublicTags,\n  getPrivateTags,\n} from \"Server\";\nimport { get } from \"lodash\";\nimport { mostCommon, mustInclude } from \"Common\";\n\nconst debug = true;\n\nconst attr2func = {\n  publicTags: setPublicTags,\n  privateTags: setPrivateTags,\n  read: setPrivateTags,\n};\n\nconst createStore = () => {\n  return {\n    currentPage: \"Management\",\n    setCurrentPage() {\n      this.currentPage = window.location.pathname.includes(\"/analysis\")\n        ? \"Analysis\"\n        : \"Management\";\n    },\n    tooltipX: 500,\n    tooltipY: 500,\n    setTooltipPos(x = -1, y = -1) {\n      this.tooltipX = x;\n      this.tooltipY = y;\n    },\n    titleSearch: \"\",\n    setTitleSearch(text) {\n      this.titleSearch = text.toLocaleLowerCase();\n    },\n    get searchPaperDoiSet() {\n      const searchPaperDois = this.titleSearch\n        ? this.papers\n            .filter(\n              (paper) =>\n                paper.title.toLocaleLowerCase().indexOf(this.titleSearch) > -1\n            )\n            .map((paper) => paper.doi)\n        : [];\n      const searchPaperDoiSet = new Set(searchPaperDois);\n      return searchPaperDoiSet;\n    },\n    papers: [],\n    commonAuthors: [],\n    commonCountries: [],\n    commonPublicTags: [],\n    commonPrivateTags: [],\n    async initPapers() {\n      if (this.papers.length === 0) {\n        const papers = await getPapers();\n        this.setPapers(papers);\n      }\n    },\n    async setPapers(papers, compareAttr = \"citationCount\") {\n      debug && console.log(\"==> 初始化Papers\");\n      const doi2paper = {};\n      papers.forEach((paper) => {\n        // 初始化，一些特殊处理，比如如果没有doi或者引用量，就安排一个\n        // if (paper.doi === \"#\") paper.doi = `tmp-${i}`;\n        // if (paper.CitationCount === \"\") paper.CitationCount = 0;\n        // if (paper.Countries === \"#\" || paper.Countries === \"###\")\n        //   paper.Countries = \"\";\n        paper.privateTags = [];\n        paper.read = false;\n        paper.publicTags = [];\n        paper.colors = [];\n        paper.innerColors = [];\n        paper.outerColors = [];\n        paper.internalRefList = [];\n        paper.internalCitedList = [];\n        paper.refList = paper.refList\n          .toLowerCase()\n          // .split(\";\")\n          .split(/[,;]/)\n          .map((a) => a.trim());\n        doi2paper[paper.doi] = paper;\n\n        // 提取authors\n        paper.authors = paper.authors\n          .split(\";\")\n          .map((a) => a.trim().replace(/\\{(.*)\\}/, \"$1\"));\n\n        // 提取countries\n        paper.countries = paper.countries\n          .split(\";\")\n          .map((s) => {\n            const part = s\n              .trim()\n              .split(\" \")\n              .map((a) => a.trim())\n              .filter((a) => a);\n            if (part.length === 0) return \"\";\n            let country = part[part.length - 1]\n              .toLowerCase()\n              .replace(/^\\w/, (s) => s.toUpperCase());\n            return country;\n          })\n          .filter((a) => a);\n      });\n\n      papers.forEach((paper) => {\n        paper.refList.forEach((ref) => {\n          if (ref in doi2paper) {\n            const refPaper = doi2paper[ref];\n            refPaper.internalCitedList.push(paper.doi);\n            paper.internalRefList.push(ref);\n          }\n        });\n      });\n\n      this.commonAuthors = mostCommon(\n        papers.map((paper) => paper.authors),\n        30\n      );\n      // console.log(\n      //   \"Authors Tags: \",\n      //   mostCommon(\n      //     papers.map((paper) => paper.authors),\n      //     100\n      //   )\n      // );\n      this.commonCountries = mostCommon(\n        papers.map((paper) => paper.countries),\n        30\n      );\n\n      // 先按引用量排序，再去统计分组的排序，这个时间消耗其实还挺大的。\n      papers.sort((a, b) => b[compareAttr] - a[compareAttr]);\n\n      // 开始计算位置\n      this.computedPosition(papers);\n      await this.initPublicTags(papers);\n\n      runInAction(() => {\n        this.papers = papers;\n        this.initPrivateTags();\n      });\n    },\n    setPaper(doi, attr, value) {\n      const paper = this.papers.find((p) => p.doi === doi);\n      paper[attr] = value;\n      // if (attr === \"read\") {\n      //   if (value) {\n      //     paper.privateTags.push(\"read\");\n      //   } else {\n      //     paper.privateTags = [...paper.privateTags].filter(\n      //       (a) => a !== \"read\"\n      //     );\n      //   }\n      // }\n      debug && console.log(\"==> 更新paper数据 by doi:\", doi, attr, value);\n      // attr === \"publicTags\" && setPublicTags(doi, value);\n      attr2func[attr]({\n        uid: this.userId,\n        pid: doi,\n        paper: toJS(paper),\n      });\n      this.doiUpdateColors(doi);\n    },\n    unitXAttr: \"year\",\n    get unitXAttrList() {\n      const xAttrSet = new Set();\n      this.papers.forEach((paper) => {\n        xAttrSet.add(paper[this.unitXAttr]);\n      });\n      const xAttrList = Array.from(xAttrSet);\n      xAttrList.sort((a, b) => b - a);\n      return xAttrList;\n    },\n    unitYAttr: \"conferenceName\",\n    get unitYAttrList() {\n      return [\"SciVis\", \"InfoVis\", \"EuroVis\", \"VAST\", \"PacificVis\"];\n      // const yAttrSet = new Set();\n      // this.papers.forEach((paper) => {\n      //   yAttrSet.add(paper[this.unitYAttr]);\n      // });\n      // const yAttrList = Array.from(yAttrSet);\n      // yAttrList.sort();\n      // return yAttrList;\n    },\n    maxUnitBlockPaperCount: 0,\n    unitBlockCount: {},\n    computedPosition(papers) {\n      // 每一个block有多少单元\n      const unitBlockCount = {};\n      papers.forEach((paper) => {\n        const xAttr = paper[this.unitXAttr];\n        const yAttr = paper[this.unitYAttr];\n        if (!(xAttr in unitBlockCount)) unitBlockCount[xAttr] = {};\n        if (!(yAttr in unitBlockCount[xAttr])) unitBlockCount[xAttr][yAttr] = 0;\n        paper.unitIndex = unitBlockCount[xAttr][yAttr];\n        unitBlockCount[xAttr][yAttr] += 1;\n      });\n      this.maxUnitBlockPaperCount =\n        Math.max(...papers.map((paper) => paper.unitIndex)) * 0.6;\n      this.unitBlockCount = unitBlockCount;\n    },\n\n    async initPublicTags(papers) {\n      const publicTags = await getPublicTags();\n      papers.forEach((paper) => {\n        if (paper.doi in publicTags) {\n          paper.publicTags = publicTags[paper.doi].filter((a) => a);\n        }\n      });\n      runInAction(() => {\n        this.commonPublicTags = mostCommon(Object.values(publicTags), 30);\n      });\n    },\n    async initPrivateTags() {\n      const privateTags = await getPrivateTags({ uid: this.userId });\n\n      runInAction(() => {\n        this.papers.forEach((paper) => {\n          if (paper.doi in privateTags) {\n            const readIndex = privateTags[paper.doi].indexOf(\"read\");\n            if (readIndex > -1) {\n              paper.read = true;\n              privateTags[paper.doi].splice(readIndex, 1);\n            }\n            paper.privateTags = privateTags[paper.doi].filter((a) => a);\n          }\n        });\n        this.commonPrivateTags = mostCommon(Object.values(privateTags), 30);\n      });\n\n      this.batchUpdateColors();\n    },\n\n    userId: \"\",\n    setUserId(userId) {\n      if (userId !== this.userId) {\n        this.userId = userId;\n        debug && console.log(\"==> change userId:\", this.userId);\n        localStorage.setItem(\"paper-management-system-userId\", userId);\n        userId && this.initPrivateTags();\n      }\n    },\n    initUserId() {\n      if (this.userId.length === 0) {\n        const userId = localStorage.getItem(\"paper-management-system-userId\");\n        userId && this.setUserId(userId);\n      }\n    },\n\n    get controlTagNameList() {\n      return this.generateCategory(10);\n    },\n    get anaCategories() {\n      return this.generateCategory(18, true);\n    },\n    generateCategory(count, have_read = false) {\n      const countries = mustInclude(\n        this.commonCountries,\n        [\"Japan\", \"Korea\"],\n        count\n      );\n      const authors = mustInclude(this.commonAuthors, [\"Xiaoru Yuan\"], count);\n      const privateTags = mustInclude(this.commonPrivateTags, [\"read\"], count);\n      const publicTags = this.commonPublicTags;\n      return [\n        {\n          label: \"Country\",\n          value: \"countries\",\n          list: countries,\n          highlightType: \"outer\",\n        },\n        {\n          label: \"Author\",\n          value: \"authors\",\n          list: authors,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Private Tag\",\n          value: \"privateTags\",\n          list: privateTags,\n          highlightType: \"inner\",\n        },\n        {\n          label: \"Public Tag\",\n          value: \"publicTags\",\n          list: publicTags,\n          highlightType: \"inner\",\n        },\n      ];\n    },\n    get category2highlightType() {\n      const category2highlightType = {};\n      this.controlTagNameList.forEach((category) => {\n        category2highlightType[category.value] = category.highlightType;\n      });\n      return category2highlightType;\n    },\n    activeTags: {\n      countries: [],\n      authors: [],\n      privateTags: [],\n      publicTags: [],\n    },\n    // 判断 至少有一个控制器被激活\n    get controlIsActive() {\n      let ans = false;\n      for (let key in this.activeTags) {\n        if (this.activeTags[key].length > 0) {\n          ans = true;\n        }\n      }\n      return ans;\n    },\n    // 判断 至少有一个outer被激活\n    get isUnitOuterHighlight() {\n      const outerCategories = this.controlTagNameList\n        .filter((category) => category.highlightType === \"outer\")\n        .map((category) => category.value);\n      let isUnitOuterHighlight = false;\n      outerCategories.forEach((outerCategory) => {\n        if (this.activeTags[outerCategory].length > 0)\n          isUnitOuterHighlight = true;\n      });\n      return isUnitOuterHighlight;\n    },\n    tag2color: {},\n    colorUse: {},\n    setTagColor(tag, category) {\n      debug && console.log(\"==> 设置tag颜色:\", category, tag);\n      const fullTag = `${category}---${tag}`;\n      if (fullTag in this.tag2color) {\n        // 回收该颜色\n        this.colorUse[this.tag2color[fullTag]] = false;\n        delete this.tag2color[fullTag];\n        this.activeTags[category] = [...this.activeTags[category]].filter(\n          (a) => a !== tag\n        );\n      } else {\n        // 分配一个新的颜色\n        this.activeTags[category].push(tag);\n        let i = 0;\n        let _color = d3.schemeTableau10[i];\n        while (this.colorUse[_color]) {\n          i += 1;\n          if (i === 10) {\n            _color = \"black\";\n            break;\n          }\n          _color = d3.schemeTableau10[i];\n        }\n        this.tag2color[fullTag] = _color;\n        this.colorUse[_color] = true;\n      }\n      this.batchUpdateColors();\n    },\n    batchUpdateColors() {\n      this.papers.forEach((paper) => {\n        paper.colors = [];\n        paper.innerColors = [];\n        paper.outerColors = [];\n        this.updateColor(paper);\n      });\n    },\n    doiUpdateColors(doi) {\n      const paper = this.papers.find((p) => p.doi === doi);\n      paper.colors = [];\n      paper.innerColors = [];\n      paper.outerColors = [];\n      this.updateColor(paper);\n    },\n    updateColor(paper) {\n      const isReadTagActive = this.activeTags.privateTags.indexOf(\"read\") > -1;\n      if (isReadTagActive && paper.read) {\n        paper.colors.push(this.tag2color[\"privateTags---read\"]);\n        paper.innerColors.push(this.tag2color[\"privateTags---read\"]);\n      }\n\n      for (let category in this.activeTags) {\n        const hightlightAttrs = this.activeTags[category];\n        if (this.category2highlightType[category] === \"inner\") {\n          hightlightAttrs.forEach((attr) => {\n            if (paper[category].indexOf(attr) > -1) {\n              const fullTag = `${category}---${attr}`;\n              paper.innerColors.push(this.tag2color[fullTag]);\n            }\n          });\n        } else {\n          hightlightAttrs.forEach((attr) => {\n            if (paper[category].indexOf(attr) > -1) {\n              const fullTag = `${category}---${attr}`;\n              paper.outerColors.push(this.tag2color[fullTag]);\n            }\n          });\n        }\n        hightlightAttrs.forEach((attr) => {\n          if (paper[category].indexOf(attr) > -1) {\n            const fullTag = `${category}---${attr}`;\n            paper.colors.push(this.tag2color[fullTag]);\n          }\n        });\n      }\n    },\n    maxCitationCount: 200,\n\n    currentSelected: \"\",\n    currentSelectedRefSet: new Set(),\n    currentSelectedCitedSet: new Set(),\n    isSelected: false,\n    setCurrentSelected(doi) {\n      debug && console.log(\"==> 选中文章:\", doi);\n      this.currentSelected = doi;\n      this.isSelected = !!doi;\n\n      const paper = this.papers.find((paper) => paper.doi === doi);\n      this.currentSelectedRefSet = new Set(paper.internalRefList);\n      this.currentSelectedCitedSet = new Set(paper.internalCitedList);\n    },\n    cancelSelect() {\n      debug && console.log(\"==> 点击背景，取消论文选中状态\");\n      this.isSelected = false;\n    },\n    get currentSelectedPaper() {\n      return this.papers.find((paper) => paper.doi === this.currentSelected);\n    },\n\n    get analysisPapers() {\n      return this.controlIsActive\n        ? this.papers.filter(\n            (paper) =>\n              paper.innerColors.length > 0 || paper.outerColors.length > 0\n          )\n        : this.papers;\n    },\n    get anaTimeData() {\n      const timeList = this.unitXAttrList.map((a) => +a).sort();\n      return timeList.map((year) => ({\n        x: year,\n        all: this.analysisPapers.filter((paper) => +paper.year === year).length,\n        highlight: this.anaHighPapers.filter((paper) => +paper.year === year)\n          .length,\n      }));\n    },\n\n    get anaTagViewData() {\n      return this.anaCategories.map((category) => {\n        const { label, value } = category;\n        const data = category.list.map((tag) =>\n          tag === \"read\"\n            ? {\n                label: \"read\",\n                all: this.analysisPapers.filter((paper) => paper.read).length,\n                highlight: this.anaHighPapers.filter((paper) => paper.read)\n                  .length,\n              }\n            : {\n                label: tag,\n                all: this.analysisPapers.filter((paper) =>\n                  paper[category.value].includes(tag)\n                ).length,\n                highlight: this.anaHighPapers.filter((paper) =>\n                  paper[category.value].includes(tag)\n                ).length,\n              }\n        );\n        return {\n          label,\n          value,\n          data,\n        };\n      });\n    },\n\n    anaFilterType: \"none\", // \"none\", \"year\", \"tag\", \"topic\", \"lasso\"\n    setAnaFilterType(type) {\n      debug && console.log(\"setAnaFilterType\", type);\n      this.anaFilterType = type;\n    },\n    clearBrushTrigger: () => {},\n    setClearBrushTrigger(fn) {\n      this.clearBrushTrigger = fn;\n    },\n\n    anaHighCate: \"\",\n    anaHighTag: \"\",\n    anaHighPapers: [],\n    setAnaHighPapersByTag({ anaHighCate, anaHighTag }) {\n      debug && console.log(\"setAnaHighPapersByTag\", anaHighCate, anaHighTag);\n      this.clearBrushTrigger();\n      this.anaHighCate = anaHighCate;\n      this.anaHighTag = anaHighTag;\n      this.anaHighPapers = this.analysisPapers.filter((paper) =>\n        get(paper, anaHighCate, []).includes(anaHighTag)\n      );\n    },\n    setAnaHighPapersByYear(yearRange) {\n      debug && console.log(\"setAnaHighPapersByYear\", yearRange);\n      const [yearStart, yearEnd] = yearRange;\n      this.anaHighPapers = this.analysisPapers.filter(\n        (paper) => +paper.year >= yearStart && +paper.year <= yearEnd\n      );\n    },\n  };\n};\n\nexport default createStore;\n","import React from \"react\";\nimport createStore from \"./createStoreV0128\";\nimport { useLocalObservable } from \"mobx-react-lite\";\n\nconst storeContext = React.createContext(null);\n\nexport const StoreProvider = ({ children }) => {\n  const store = useLocalObservable(createStore);\n  return (\n    <storeContext.Provider value={store}>{children}</storeContext.Provider>\n  );\n};\n\nexport const useGlobalStore = () => {\n  const store = React.useContext(storeContext);\n  if (!store) {\n    throw new Error(\"no Provider\");\n  }\n  return store;\n};\n","import React from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"Store\";\nimport { debounce } from \"lodash\";\nimport { SearchOutlined } from \"@ant-design/icons\";\n// import {observer} from \"mobx-react-lite\";\n\nconst SearchView = () => {\n  const store = useGlobalStore();\n  // const { searchPaperDoiSet } = store;\n  // console.log(\"=====> searchPaperDoiSet\", searchPaperDoiSet);\n  const handleInput = debounce((e) => {\n    // console.log(\"===>\", e.target.value);\n    store.setTitleSearch(e.target.value);\n  }, 200);\n  return (\n    <div className=\"search-view\">\n      <div className=\"search-view-input\">\n        <input onInput={handleInput} />\n      </div>\n\n      <div className=\"search-view-icon\">\n        <SearchOutlined />\n      </div>\n    </div>\n  );\n};\n\nexport default SearchView;\n","import React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\n// import { toJS } from \"mobx\";\nimport SearchView from \"../SearchView\";\n\nconst ControlView = observer(() => {\n  const store = useGlobalStore();\n  const { controlTagNameList } = store;\n  return (\n    <div className=\"control-view\">\n      <div className=\"control-item\">\n        <div className=\"control-item-title\">Title Search</div>\n        <div className=\"control-item-options\">\n          <SearchView searchAttr={\"title\"} />\n        </div>\n      </div>\n\n      {controlTagNameList.map((tag) => (\n        <ControlItem key={tag.label} tagData={tag} />\n      ))}\n    </div>\n  );\n});\n\nexport default ControlView;\n\nconst ControlItem = observer(({ tagData }) => {\n  const store = useGlobalStore();\n  const { tag2color } = store;\n\n  const [tags, setTags] = useState([]);\n  // 又是一个外挂逻辑，从ana界面切回来以后，需要初始化tag item，理论上这个应该放在store统一处理\n  useEffect(() => {\n    const initTags = Object.keys(tag2color)\n      .filter((tag) => tag.split(\"---\")[0] === tagData.value)\n      .map((tag) => tag.split(\"---\")[1])\n      .filter((tag) => tagData.list.indexOf(tag) > -1);\n    setTags(initTags);\n  }, []);\n  const handleClickOption = (value) => {\n    const currentTags = [...tags];\n    const index = currentTags.indexOf(value);\n    if (index > -1) {\n      currentTags.splice(index, 1);\n      setTags(currentTags);\n    } else {\n      currentTags.push(value);\n      setTags(currentTags);\n    }\n    store.setTagColor(value, tagData.value);\n  };\n\n  return (\n    <div className=\"control-item\">\n      <div className=\"control-item-title\">{tagData.label}</div>\n      <div className=\"control-item-options\">\n        {tagData.list.map((item) => (\n          <ControlOption\n            key={item}\n            value={item}\n            clickOption={handleClickOption}\n            isSelect={\n              tags.indexOf(item) > -1 && tag2color[`${tagData.value}---${item}`]\n            }\n          />\n        ))}\n      </div>\n    </div>\n  );\n});\n\nconst ControlOption = ({ value, clickOption, isSelect }) => {\n  const className = [\"control-item-option\", isSelect && \"option-active\"]\n    .filter((a) => a)\n    .join(\" \");\n  const style = isSelect\n    ? { background: isSelect, border: `1px solid ${isSelect}` }\n    : {};\n  const value_format = value === \"Usa\" ? \"USA\" : value;\n  return (\n    <div className={className} onClick={() => clickOption(value)} style={style}>\n      {value_format}\n    </div>\n  );\n};\n","import React from \"react\";\n\nconst CircleUnit = React.memo(\n  ({\n    cx,\n    cy,\n    r,\n    // colors,\n    opacity,\n    doi,\n    handleClick,\n    // borderColor,\n    // borderOpacity,\n    title,\n    innerColors,\n    outerColors,\n    isBackgroundActive,\n    handleHover,\n    handleHoverOut,\n  }) => {\n    const polarX = (angle) => cx + Math.sin(angle) * r;\n    const polarY = (angle) => cy + Math.cos(angle) * r;\n    const innerStepAngle = (2 * Math.PI) / innerColors.length;\n    const innerPoints = innerColors.map((_, i) => ({\n      startX: polarX(innerStepAngle * i),\n      startY: polarY(innerStepAngle * i),\n      endX: polarX(innerStepAngle * (i + 1)),\n      endY: polarY(innerStepAngle * (i + 1)),\n    }));\n\n    // console.log('outerColors', outerColors)\n    const outerR = r * 1.5;\n    const outerPolarX = (angle) => cx + Math.sin(angle) * outerR;\n    const outerPolarY = (angle) => cy + Math.cos(angle) * outerR;\n    const outerStepAngle = (2 * Math.PI) / outerColors.length;\n    const outerPoints = outerColors.map((_, i) => ({\n      startX: outerPolarX(outerStepAngle * i),\n      startY: outerPolarY(outerStepAngle * i),\n      endX: outerPolarX(outerStepAngle * (i + 1)),\n      endY: outerPolarY(outerStepAngle * (i + 1)),\n    }));\n\n    // const borderOpacity = isSelect ? 1 : 0;\n\n    return (\n      <g\n        id=\"unit-g\"\n        onClick={(e) => handleClick(e, doi)}\n        cursor=\"pointer\"\n        onMouseEnter={() => handleHover(doi)}\n        onMouseLeave={() => handleHoverOut()}\n      >\n        <title>{title}</title>\n\n        {isBackgroundActive && (\n          <g id=\"unit-background-g\">\n            <rect\n              x={cx - 1.6 * r}\n              y={cy - 1.6 * r}\n              width={r * 3.2}\n              height={r * 3.2}\n              fill=\"#fc8d62\"\n              rx={r * 0.4}\n              ry={r * 0.4}\n            />\n            <circle cx={cx} cy={cy} r={1.3 * r} fill=\"#eee\" />\n          </g>\n        )}\n        <g id=\"unit-border-g\">\n          {/* <circle\n            cx={cx}\n            cy={cy}\n            r={1.4 * r}\n            fill=\"none\"\n            stroke={borderColor}\n            strokeWidth={0.6 * r}\n            opacity={borderOpacity}\n          /> */}\n          {outerPoints.length > 1 ? (\n            outerPoints.map((point, i) => (\n              <path\n                key={i}\n                d={`M ${cx} ${cy}\n              L ${point.startX} ${point.startY}\n              A ${outerR} ${outerR} 0 0 0 ${point.endX} ${point.endY}\n              Z\n              `}\n                // stroke=\"white\"\n                fill={outerColors[i]}\n                // strokeWidth={0.1 * r}\n                // fill-opacity=\"0.2\"\n              />\n            ))\n          ) : (\n            <circle\n              cx={cx}\n              cy={cy}\n              r={outerR}\n              fill={outerColors.length > 0 ? outerColors[0] : \"none\"}\n              // stroke=\"red\"\n              // strokeWidth={0.15 * r}\n            />\n          )}\n          {/* {outerPoints.length > 0 && <circle\n            cx={cx}\n            cy={cy}\n            r={1.2 * r}\n            fill=\"white\"\n            // stroke={borderColor}\n            // strokeWidth={0.6 * r}\n            // opacity={borderOpacity}\n          />} */}\n          <circle\n            cx={cx}\n            cy={cy}\n            r={1.1 * r}\n            fill=\"white\"\n            // stroke={borderColor}\n            // strokeWidth={0.6 * r}\n            opacity={outerPoints.length > 0 ? 1 : 0}\n          />\n        </g>\n        <g id=\"unit-sector-g\" opacity={opacity}>\n          {innerPoints.length > 1 ? (\n            innerPoints.map((point, i) => (\n              <path\n                key={i}\n                d={`M ${cx} ${cy}\n              L ${point.startX} ${point.startY}\n              A ${r} ${r} 0 0 0 ${point.endX} ${point.endY}\n              Z\n              `}\n                stroke=\"white\"\n                fill={innerColors[i]}\n                strokeWidth={0.1 * r}\n                // fill-opacity=\"0.2\"\n              />\n            ))\n          ) : (\n            <circle\n              cx={cx}\n              cy={cy}\n              r={r}\n              fill={innerColors[0]}\n              // stroke=\"red\"\n              // strokeWidth={0.15 * r}\n            />\n          )}\n        </g>\n      </g>\n    );\n  }\n);\n\nexport default CircleUnit;\n","import React from \"react\";\nimport { get } from \"lodash\";\n\nconst tooltipWidthRatio = 0.25;\n\nconst PaperTooltip = ({\n  isShow,\n  paper,\n  paperCircle,\n  containerWidth,\n  containerHeight,\n}) => {\n  const xRatio = paperCircle.cx / containerWidth;\n  const tooltipWidth = containerWidth * tooltipWidthRatio;\n  const tooltipX = paperCircle.cx - tooltipWidth * xRatio;\n  const tooltipY = paperCircle.cy + 15;\n  const bottomStyle =\n    paperCircle.cy + 200 > containerHeight ? \"translateY(-150%)\" : \"\";\n  const style = {\n    transform: `translate(${tooltipX}px,${tooltipY}px) ${bottomStyle}`,\n    opacity: isShow ? 1 : 0,\n  };\n  return (\n    <div className=\"unit-tooltip\" style={style}>\n      <div className=\"unit-tooltip-title\">{get(paper, \"title\", \"\")}</div>\n      <div className=\"unit-tooltip-authors\">\n        {get(paper, \"authors\", []).join(\"; \")} ({paper.year})\n      </div>\n    </div>\n  );\n};\n\nexport default PaperTooltip;\n","import React, { useEffect, useState } from \"react\";\nimport \"./index.scss\";\nimport CircleUnit from \"./CircleUnit\";\nimport PaperTooltip from \"./PaperTooltip\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { toJS } from \"mobx\";\nimport { get } from \"lodash\";\nimport * as d3 from \"d3\";\n\nconst unitLayoutPadding = {\n  top: 30,\n  left: 40,\n  right: 15,\n  bottom: 1,\n};\n\nconst unitBlockPadding = {\n  top: 2,\n  left: 3,\n  right: 3,\n  bottom: 1,\n};\n\nconst UnitView = observer(() => {\n  const store = useGlobalStore();\n  const {\n    papers,\n    unitXAttr,\n    unitYAttr,\n    unitXAttrList,\n    unitYAttrList,\n    unitBlockCount,\n    maxUnitBlockPaperCount,\n    // doi2paperBlockPos,\n    // doi2privateTags,\n    // doi2publicTags,\n    // doi2comments,\n    // doi2colors,\n    controlIsActive,\n    isUnitOuterHighlight,\n    currentSelected,\n    setCurrentSelected,\n    isSelected,\n    cancelSelect,\n    currentSelectedRefSet,\n    currentSelectedCitedSet,\n    searchPaperDoiSet,\n    // setTooltipPos,\n    // tooltipX,\n    // tooltipY,\n  } = store;\n\n  // const svg = document.querySelector(\"#unit-svg\");\n  // const svgWidth =\n  //   svg.clientWidth - unitLayoutPadding.left - unitLayoutPadding.right;\n  // const svgHeight =\n  //   svg.clientHeight - unitLayoutPadding.top - unitLayoutPadding.bottom;\n\n  const [svgWidth, setSvgWidth] = useState(0);\n  const [svgHeight, setSvgHeight] = useState(0);\n\n  // 初始化svg长宽\n  useEffect(() => {\n    const svg = document.querySelector(\"#unit-svg\");\n    setSvgWidth(\n      svg.clientWidth - unitLayoutPadding.left - unitLayoutPadding.right\n    );\n    setSvgHeight(\n      svg.clientHeight - unitLayoutPadding.top - unitLayoutPadding.bottom\n    );\n  }, []);\n  const unitBlockWidth =\n    unitXAttrList.length > 0\n      ? svgWidth / unitXAttrList.length -\n        unitBlockPadding.left -\n        unitBlockPadding.right\n      : 0;\n  const unitBlockHeight =\n    unitYAttrList.length > 0\n      ? svgHeight / unitYAttrList.length -\n        unitBlockPadding.top -\n        unitBlockPadding.bottom\n      : 0;\n  // console.log(unitBlockWidth, unitBlockHeight);\n\n  const aspectRatio = Math.floor(\n    unitBlockWidth > 0 ? unitBlockHeight / unitBlockWidth : 1\n  );\n\n  const blockCountX = Math.ceil(\n    Math.sqrt(maxUnitBlockPaperCount / aspectRatio)\n  );\n  // console.log('blockCountX', blockCountX);\n\n  const xAttr2blockCountX = unitXAttrList.map((xAttr, i) => {\n    const maxColumnBlockCount = Math.max(\n      ...unitYAttrList.map((yAttr, j) => get(unitBlockCount, [xAttr, yAttr], 0))\n    );\n    let blockCountX = Math.ceil(\n      Math.sqrt(maxUnitBlockPaperCount / aspectRatio)\n    );\n    if (maxColumnBlockCount > maxUnitBlockPaperCount) {\n      blockCountX += 1;\n    }\n    return blockCountX;\n  });\n  // console.log(\"xAttr2blockCountX\", xAttr2blockCountX);\n\n  // const blockCountY = Math.ceil(aspectRatio * blockCountX);\n\n  let r = unitBlockWidth / blockCountX;\n  // console.log(\"r\", r);\n\n  const xAttr2blockCountX_StartCount = [0];\n  const xAttr2blockCountX_StartPos = [0];\n\n  for (let i = 1; i < unitXAttrList.length; i++) {\n    xAttr2blockCountX_StartCount.push(\n      xAttr2blockCountX_StartCount[i - 1] + xAttr2blockCountX[i - 1]\n    );\n  }\n\n  r =\n    (svgWidth -\n      (unitBlockPadding.left + unitBlockPadding.right) * unitXAttrList.length) /\n    (xAttr2blockCountX_StartCount[xAttr2blockCountX_StartCount.length - 1] +\n      xAttr2blockCountX[xAttr2blockCountX.length - 1]);\n  // console.log(\"new r\", r);\n\n  for (let i = 1; i < unitXAttrList.length; i++) {\n    xAttr2blockCountX_StartPos.push(\n      xAttr2blockCountX_StartCount[i] * r +\n        (unitBlockPadding.left + unitBlockPadding.right) * i\n    );\n  }\n  // console.log(\"xAttr2blockCountX_StartCount\", xAttr2blockCountX_StartCount);\n  // console.log(\"xAttr2blockCountX_StartPos\", xAttr2blockCountX_StartPos);\n  const scale = d3.scaleLinear().domain([0, 100]).range([0.25, 0.8]);\n  const citeCount2grey = (count) => d3.interpolateGreys(scale(count));\n  const paperCircles = papers.map((paper) => {\n    const paperCircle = {};\n    paperCircle.oriData = toJS(paper);\n\n    paperCircle.BlockIndexX = unitXAttrList.indexOf(paper[unitXAttr]);\n    paperCircle.BlockIndexY = unitYAttrList.indexOf(paper[unitYAttr]);\n\n    const doi = paper.doi;\n    paperCircle.doi = doi;\n\n    paperCircle.circleIndexX =\n      paper.unitIndex % xAttr2blockCountX[paperCircle.BlockIndexX];\n    paperCircle.circleIndexY = Math.floor(\n      paper.unitIndex / xAttr2blockCountX[paperCircle.BlockIndexX]\n    );\n\n    paperCircle.cx =\n      unitLayoutPadding.left +\n      paperCircle.BlockIndexX *\n        (unitBlockWidth + unitBlockPadding.left + unitBlockPadding.right) +\n      (paperCircle.circleIndexX + 0.5) * r;\n    paperCircle.cy =\n      unitLayoutPadding.top +\n      paperCircle.BlockIndexY *\n        (unitBlockHeight + unitBlockPadding.top + unitBlockPadding.bottom) +\n      (paperCircle.circleIndexY + 0.5) * r;\n\n    // 外挂逻辑\n    if (paper[\"year\"] === '2004' && paperCircle.BlockIndexY > 0) {\n      paperCircle.cy += 50 - paperCircle.BlockIndexY * 10;\n    }\n\n    paperCircle.cx =\n      unitLayoutPadding.left +\n      xAttr2blockCountX_StartPos[paperCircle.BlockIndexX] +\n      (paperCircle.circleIndexX + 0.5) * r;\n\n    paperCircle.citationGrey = citeCount2grey(paper.citationCount);\n    paperCircle.activeColors = paper.innerColors;\n    // paperCircle.colors =\n    //   paperCircle.activeColors.length > 0\n    //     ? paperCircle.activeColors\n    //     : [paperCircle.citationGrey];\n    paperCircle.innerColors =\n      paperCircle.activeColors.length > 0\n        ? paperCircle.activeColors\n        : [paperCircle.citationGrey];\n    // paperCircle.outerColors\n    paperCircle.outerColors = [\"none\"];\n    if (isUnitOuterHighlight) {\n      paperCircle.outerColors = paper.outerColors;\n    } else {\n      if (isSelected) {\n        if (currentSelected === paper.doi)\n          paperCircle.outerColors = [\"#d95f02\"];\n        if (currentSelectedRefSet.has(paper.doi))\n          paperCircle.outerColors = [\"#1b9e77\"];\n        if (currentSelectedCitedSet.has(paper.doi))\n          paperCircle.outerColors = [\"#7570b3\"];\n      } else {\n        paperCircle.outerColors = [\"none\"];\n      }\n    }\n\n    paperCircle.opacity = controlIsActive\n      ? (paper.innerColors.length + paper.outerColors.length)  > 0\n        ? 0.8\n        : 0.4\n      : 0.8;\n\n    paperCircle.title = paper.Title;\n\n    if (isSelected) {\n      if (currentSelected === paper.doi) paperCircle.borderColor = \"#d95f02\";\n      if (currentSelectedRefSet.has(paper.doi))\n        paperCircle.borderColor = \"#1b9e77\";\n      if (currentSelectedCitedSet.has(paper.doi))\n        paperCircle.borderColor = \"#7570b3\";\n    } else {\n      paperCircle.borderColor = \"none\";\n    }\n\n    paperCircle.isBackgroundActive = searchPaperDoiSet.has(paper.doi);\n\n    return paperCircle;\n  });\n\n  const xLabels = unitXAttrList.map((xAttr, i) => {\n    const startX = unitLayoutPadding.left + xAttr2blockCountX_StartPos[i];\n    const middleX = startX + (xAttr2blockCountX[i] * r) / 2;\n    return {\n      value: xAttr,\n      x: middleX,\n      y: unitLayoutPadding.top * 0.8,\n    };\n  });\n\n  const yLabels = unitYAttrList.map((yAttr, i) => {\n    const startY =\n      unitLayoutPadding.top +\n      (unitBlockHeight + unitBlockPadding.top + unitBlockPadding.bottom) * i;\n    return {\n      value: yAttr,\n      x: unitLayoutPadding.left * 0.35,\n      y: startY,\n    };\n  });\n\n  const handleClickPaper = (e, doi) => {\n    // console.log(\"click\", e, doi);\n    e.stopPropagation();\n    setCurrentSelected(doi);\n  };\n\n  const handleClickBackground = () => {\n    cancelSelect();\n  };\n\n  const [hoverDoi, setHoverDoi] = useState(\"\");\n  const hoverPaper =\n    hoverDoi.length > 0 ? papers.find((paper) => paper.doi === hoverDoi) : {};\n  const hoverPaperCircle =\n    hoverDoi.length > 0\n      ? paperCircles.find((paper) => paper.doi === hoverDoi)\n      : {};\n\n  const handleHover = (doi) => {\n    console.log(\"===> hover\", doi);\n    setHoverDoi(doi);\n  };\n  const handleHoverOut = () => {\n    console.log(\"===> mouse leave\");\n    setHoverDoi(\"\");\n  };\n\n  return (\n    <div className=\"unit-view\">\n      <svg\n        id=\"unit-svg\"\n        width=\"100%\"\n        height=\"100%\"\n        onClick={handleClickBackground}\n      >\n        <g id=\"units\">\n          {r > 0 &&\n            paperCircles.map((paper, i) => (\n              <CircleUnit\n                key={i}\n                cx={paper.cx}\n                cy={paper.cy}\n                r={r / 2.4}\n                // grey={paper.citationGrey}\n                // oriData={paper.oriData}\n                doi={paper.doi}\n                colors={paper.colors}\n                opacity={paper.opacity}\n                innerColors={paper.innerColors}\n                outerColors={paper.outerColors}\n                handleClick={handleClickPaper}\n                // isSelect={isSelected && currentSelected === paper.doi}\n                borderOpacity={paper.borderOpacity}\n                borderColor={paper.borderColor}\n                title={paper.title}\n                isBackgroundActive={paper.isBackgroundActive}\n                handleHover={handleHover}\n                handleHoverOut={handleHoverOut}\n              />\n            ))}\n        </g>\n        <g id=\"x-label\">\n          {r > 0 &&\n            xLabels.map((label) => (\n              <text\n                key={label.value}\n                x={label.x}\n                y={label.y}\n                textAnchor=\"middle\"\n                fontSize={r * 1.6}\n                fill=\"rgb(78, 78, 78)\"\n              >\n                {label.value}\n              </text>\n            ))}\n        </g>\n        <g id=\"y-label\">\n          {r > 0 &&\n            yLabels.map((label) => (\n              <text\n                key={label.value}\n                // x={label.x}\n                // y={label.y}\n                // textAnchor=\"start\"\n                transform={`translate(${label.x}, ${label.y}) rotate(90)`}\n                fontSize={r * 1.6}\n                fill=\"rgb(78, 78, 78)\"\n              >\n                {label.value}\n              </text>\n            ))}\n        </g>\n      </svg>\n      <PaperTooltip\n        isShow={hoverDoi.length > 0}\n        paper={hoverPaper}\n        containerWidth={svgWidth}\n        containerHeight={svgHeight}\n        paperCircle={hoverPaperCircle}\n      />\n    </div>\n  );\n});\n\nexport default UnitView;\n","import React, { useState, useRef } from \"react\";\nimport \"./index.scss\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { get } from \"lodash\";\nimport { Switch } from \"antd\";\nimport { CloseOutlined, CheckOutlined } from \"@ant-design/icons\";\nimport { Tag, Input } from \"antd\";\nimport { PlusOutlined } from \"@ant-design/icons\";\nimport { toJS } from \"mobx\";\n\nconst debug = true;\n\nconst DetailView = observer(() => {\n  const store = useGlobalStore();\n  const { currentSelectedPaper, setPaper } = store;\n  const paper = currentSelectedPaper;\n  debug && console.log(\"currentSelectedPaper\", toJS(currentSelectedPaper));\n  if (!currentSelectedPaper) {\n    return <div></div>;\n  }\n\n  const doi = get(paper, \"doi\", \"\");\n\n  const editTags = [\n    {\n      title: \"Private Tags\",\n      value: \"privateTags\",\n      initTags: get(paper, \"privateTags\", []),\n    },\n    {\n      title: \"Public Tags\",\n      value: \"publicTags\",\n      initTags: get(paper, \"publicTags\", []),\n    },\n  ];\n  const handleChangeTags = (attr, value) => {\n    doi && setPaper(doi, attr, value);\n  };\n  const handleChangeRead = (value) => {\n    setPaper(doi, \"read\", value);\n  };\n  return (\n    <div className=\"detail-view\" key={doi}>\n      {paper && (\n        <>\n          <div className=\"detail-title\">{paper.title}</div>\n          <div className=\"detail-authors\">\n            {get(paper, \"authors\", []).join(\"; \")} ({paper.year})\n          </div>\n          <div className=\"detail-edit-tags\">\n            <div className=\"detail-edit-read\">\n              <div className=\"detail-edit-title\">Read</div>\n              <Switch\n                size=\"small\"\n                checkedChildren={<CheckOutlined />}\n                unCheckedChildren={<CloseOutlined />}\n                defaultChecked={get(paper, \"read\", false)}\n                onChange={handleChangeRead}\n              />\n            </div>\n            {editTags.map((editTag) => (\n              <DetailEditTags\n                key={editTag.value}\n                title={editTag.title}\n                initTags={editTag.initTags}\n                handleChangeTags={(value) =>\n                  handleChangeTags(editTag.value, value)\n                }\n              />\n            ))}\n          </div>\n          <div className=\"detail-attrs\">\n            <DetailItem paper={paper} label={\"keywords\"} />\n            <DetailItem paper={paper} label={\"doi\"} />\n            <DetailItem paper={paper} label={\"affiliation\"} />\n            <DetailItem paper={paper} label={\"abstract\"} />\n          </div>\n        </>\n      )}\n    </div>\n  );\n});\n\nexport default DetailView;\n\nconst DetailItem = ({ paper, label }) => (\n  <div className=\"detail-attr\">\n    <div className=\"detail-key\">{label}:</div>\n    <div className=\"detail-content\">{get(paper, label, \"\")}</div>\n  </div>\n);\n\nconst DetailEditTags = ({ title, initTags, handleChangeTags }) => {\n  const [tags, _setTags] = useState(initTags);\n  const setTags = (newTags) => {\n    handleChangeTags(newTags);\n    _setTags(newTags);\n  };\n  const [editInputIndex, setEditInputIndex] = useState(-1);\n  // const [editInput, setEditInput] = useState();\n  // const saveEditInputRef = (input) => setEditInput(input);\n  const input = useRef();\n  // const saveInputRef = (input) => setInput(input);\n\n  const [editInputValue, setEditInputValue] = useState(\"\");\n  const handleEditInputConfirm = () => {\n    const newTags = [...tags];\n    newTags[editInputIndex] = editInputValue;\n    setTags(newTags);\n    setEditInputIndex(-1);\n    setEditInputValue(\"\");\n  };\n\n  const [inputValue, setInputValue] = useState(\"\");\n  const handleInputConfirm = () => {\n    if (inputValue && tags.indexOf(inputValue) < 0) {\n      setTags([...tags, inputValue]);\n      setInputVisible(false);\n      setInputValue(\"\");\n    }\n  };\n\n  const handleClose = (removeTag) => {\n    setTags(tags.filter((tag) => tag !== removeTag));\n  };\n\n  const [inputVisible, setInputVisible] = useState(false);\n  const showInput = () => {\n    setInputVisible(true);\n    // input.focus();\n  };\n  return (\n    <div className=\"detail-edit-tag\">\n      <div className=\"detail-edit-title\">{title}:</div>\n      <div className=\"detail-edit-tags\">\n        <>\n          {tags.map((tag, index) => {\n            if (editInputIndex === index) {\n              return (\n                <Input\n                  // ref={saveEditInputRef}\n                  key={tag}\n                  size=\"small\"\n                  className=\"tag-input\"\n                  value={editInputValue}\n                  onchange={(e) => setEditInputValue(e.target.value)}\n                  onBlur={handleEditInputConfirm}\n                  onPressEnter={handleEditInputConfirm}\n                />\n              );\n            }\n\n            const tagElem = (\n              <Tag\n                className=\"edit-tag\"\n                key={tag}\n                closable={true}\n                onClose={() => handleClose(tag)}\n              >\n                <span\n                // onDoubleClick={(e) => {\n                //   setEditInputIndex(index);\n                //   setEditInputValue(tag);\n                //   editInput.focus();\n                //   e.preventDefault();\n                // }}\n                >\n                  {tag}\n                </span>\n              </Tag>\n            );\n            return tagElem;\n          })}\n          {inputVisible && (\n            <Input\n              ref={input}\n              type=\"text\"\n              size=\"small\"\n              className=\"tag-input\"\n              value={inputValue}\n              onChange={(e) => setInputValue(e.target.value)}\n              onBlur={handleInputConfirm}\n              onPressEnter={handleInputConfirm}\n            />\n          )}\n          {!inputVisible && (\n            <Tag className=\"site-tag-plus\" onClick={showInput}>\n              <PlusOutlined /> New Tag\n            </Tag>\n          )}\n        </>\n      </div>\n    </div>\n  );\n};\n","import React, { useEffect } from \"react\";\nimport { useGlobalStore } from \"Store\";\n\nimport ControlView from \"./ControlView\";\nimport UnitView from \"./UnitView\";\nimport DetailView from \"./DetailView\";\n\nconst ManagePage = () => {\n  const store = useGlobalStore();\n  useEffect(() => {\n    store.setCurrentPage();\n    store.initPapers();\n    store.initUserId();\n  }, []);\n  return (\n    <div className=\"main-container\">\n      <div className=\"control-main-container\">\n        <div className=\"control-view-container\">\n          <ControlView />\n        </div>\n        <div className=\"unit-view-container\">\n          <UnitView />\n        </div>\n      </div>\n      <div className=\"detail-view-container\">\n        <DetailView />\n      </div>\n    </div>\n  );\n};\n\nexport default ManagePage;\n","import { useEffect, useState } from \"react\";\nimport * as d3 from \"d3\";\n\n// 初始化，确定长宽\nconst useClientRect = ({ svgId }) => {\n  const [clientRect, setClientRect] = useState({ width: 0, height: 0 });\n  useEffect(() => {\n    const svg = d3.select(`#${svgId}`);\n    svg.selectAll(\"*\").remove();\n    const clientRect = svg.node().getClientRects()[0];\n    setClientRect(clientRect);\n  }, [svgId]);\n  return clientRect;\n};\n\nexport default useClientRect;\n","import React, { useEffect } from \"react\";\nimport \"./index.scss\";\nimport * as d3 from \"d3\";\nimport { useClientRect } from \"Hooks\";\nimport { anaSvgPadding } from \"Common\";\n\nconst TagFilter = React.memo(\n  ({\n    label = \"label\",\n    value = \"\",\n    data = [],\n    setAnaHighPapersByTag = () => {},\n    anaFilterType,\n    setAnaFilterType = () => {},\n  }) => {\n    const svgId = `ana-tag-filter-svg-${label.replaceAll(/\\W/g, \"\")}`;\n    const svg = d3.select(`#${svgId}`);\n    const clientRect = useClientRect({\n      svgId,\n    });\n    const { width, height } = clientRect;\n    const padding = anaSvgPadding;\n    useEffect(() => {}, []);\n    useEffect(() => {\n      if (data.length === 0 || width === 0 || height === 0) return;\n      svg.selectAll(\"*\").remove();\n      data = data.filter((d) => d.all > 0);\n      data = d3.sort(data, (a, b) => a.all - b.all);\n      const x = d3\n        .scaleBand()\n        .domain(data.map((d) => d.label))\n        .range([padding.left, width - padding.right])\n        .padding(0.2);\n      const y = d3\n        .scaleLinear()\n        .domain([0, d3.max(data, (d) => d.all)])\n        .nice()\n        .range([height - padding.bottom, padding.top]);\n\n      const xAxis = (g) =>\n        g\n          .attr(\n            \"transform\",\n            \"translate(\" + 0 + \", \" + (height - padding.bottom) + \")\"\n          )\n          .call(d3.axisBottom(x).tickSizeOuter(0))\n          .call((g) =>\n            g\n              .selectAll(\"text\")\n              .attr(\"transform\", \"rotate(-28)\")\n              .style(\"text-anchor\", \"end\")\n          );\n      const yAxis = (g) =>\n        g\n          .attr(\"transform\", `translate(${width - padding.right},0)`)\n          .call(d3.axisRight(y).ticks(5))\n          .call((g) => g.select(\".domain\").remove());\n\n      svg\n        .append(\"g\")\n        .classed(\"non-active-bars\", true)\n        .selectAll(\"rect\")\n        .data(data)\n        .join(\"rect\")\n        .attr(\"x\", (d) => x(d.label))\n        .attr(\"y\", (d) => y(d.all))\n        .attr(\"height\", (d) => y(0) - y(d.all))\n        .attr(\"width\", x.bandwidth())\n        .style(\"cursor\", \"pointer\")\n        .on(\"click\", (e, d) => {\n          setAnaFilterType(\"tag\");\n          setAnaHighPapersByTag({ anaHighCate: value, anaHighTag: d.label });\n        });\n\n      if (anaFilterType !== \"none\") {\n        svg\n          .append(\"g\")\n          .classed(\"active-bars\", true)\n          .selectAll(\"rect\")\n          .data(data)\n          .join(\"rect\")\n          .attr(\"x\", (d) => x(d.label))\n          .attr(\"y\", (d) => y(d.highlight))\n          .attr(\"height\", (d) => y(0) - y(d.highlight))\n          .attr(\"width\", x.bandwidth())\n          .style(\"pointer-events\", \"none\");\n      }\n\n      svg.append(\"g\").attr(\"class\", \"x-axis\").call(xAxis);\n\n      svg.append(\"g\").attr(\"class\", \"y-axis\").call(yAxis);\n    });\n    return <svg id={svgId} width=\"100%\" height=\"100%\" />;\n  }\n);\n\nexport default TagFilter;\n","import React, { useEffect } from \"react\";\nimport \"./index.scss\";\nimport * as d3 from \"d3\";\nimport { useClientRect } from \"Hooks\";\nimport { anaTimeSvgPadding as padding } from \"Common\";\n\nconst TimeLine = React.memo(\n  ({\n    data,\n    onInput = () => {},\n    onChange = () => {},\n    setClearBrushTrigger = () => {},\n    anaFilterType,\n    setAnaFilterType = () => {},\n  }) => {\n    // const padding = anaTimeSvgPadding;\n    const clientRect = useClientRect({\n      svgId: \"ana-time-line-svg\",\n    });\n    const { width, height } = clientRect;\n\n    const initYearRange = [d3.min(data, (d) => d.x), d3.max(data, (d) => d.x)];\n    useEffect(() => {\n      onInput(initYearRange);\n    }, [data]);\n\n    useEffect(() => {\n      if (data.length === 0 || width === 0 || height === 0) return;\n      const x = d3\n        .scaleBand()\n        .domain(data.map((d) => d.x))\n        .range([padding.left, width - padding.right])\n        .padding(0.2);\n      const y = d3\n        .scaleLinear()\n        .domain([0, d3.max(data, (d) => d.all)])\n        .nice()\n        .range([height - padding.bottom, padding.top]);\n\n      const xAxis = (g) =>\n        g\n          .attr(\n            \"transform\",\n            \"translate(\" + 0 + \", \" + (height - padding.bottom) + \")\"\n          )\n          .call(d3.axisBottom(x).tickValues(d3.range(initYearRange[0], initYearRange[1], 5)).tickSizeOuter(0));\n      const yAxis = (g) =>\n        g\n          .attr(\"transform\", `translate(${width - padding.right},0)`)\n          .call(d3.axisRight(y).ticks(6))\n          .call((g) => g.select(\".domain\").remove());\n\n      const svg = d3.select(\"#ana-time-line-svg\");\n      // svg.selectAll(\"*\").remove();\n      const barsG = svg.append(\"g\").classed(\"non-active-bars\", true);\n      const bars = barsG\n        .selectAll(\"rect\")\n        .data(data)\n        .join(\"rect\")\n        .attr(\"x\", (d) => (d.rectX = x(d.x)))\n        .attr(\"y\", (d) => y(d.all))\n        .attr(\"height\", (d) => y(0) - y(d.all))\n        .attr(\"width\", x.bandwidth());\n\n      const highlightBarsG = svg\n        .append(\"g\")\n        .classed(\"active-bars\", true)\n        .classed(\"highlight-bars\", true);\n\n      svg.append(\"g\").attr(\"class\", \"x-axis\").call(xAxis);\n\n      svg.append(\"g\").attr(\"class\", \"y-axis\").call(yAxis);\n\n      const brushStart = () => {\n        setAnaFilterType(\"year\");\n      };\n\n      const brushing = ({ selection }) => {\n        bars.classed(\n          \"active-bars\",\n          (bar) =>\n            bar.rectX + x.bandwidth() > selection[0] && bar.rectX < selection[1]\n        );\n        const brushYear = data\n          .filter(\n            (d) =>\n              d.rectX + x.bandwidth() > selection[0] && d.rectX < selection[1]\n          )\n          .map((d) => d.x);\n        brushYear.length >= 1\n          ? onInput([brushYear[0], brushYear[brushYear.length - 1]])\n          : onInput(initYearRange);\n      };\n      const brushEnd = ({ selection }) => {\n        if (selection) {\n          const brushYear = data\n            .filter(\n              (d) =>\n                d.rectX + x.bandwidth() > selection[0] && d.rectX < selection[1]\n            )\n            .map((d) => d.x);\n          brushYear.length >= 1\n            ? onChange([brushYear[0], brushYear[brushYear.length - 1]])\n            : onChange(initYearRange);\n        } else {\n          bars.classed(\"active-bars\", false);\n          onInput(initYearRange);\n          setAnaFilterType(\"none\");\n          onChange(initYearRange);\n        }\n      };\n      const brush = d3\n        .brushX()\n        .extent([\n          [padding.left, padding.top * 0.3],\n          [width - padding.right, height - padding.bottom],\n        ])\n        .on(\"start\", brushStart)\n        .on(\"brush\", brushing)\n        .on(\"end\", brushEnd);\n\n      svg.call(brush);\n\n      setClearBrushTrigger(() => {\n        d3.brush().move(svg);\n        bars.classed(\"active-bars\", false);\n      });\n    }, [clientRect]);\n\n    useEffect(() => {\n      if (\n        width === 0 ||\n        height === 0 ||\n        anaFilterType === \"year\" ||\n        anaFilterType === \"none\"\n      )\n        return;\n      const svg = d3.select(\"#ana-time-line-svg\");\n      const highlightBarsG = svg.select(\".highlight-bars\");\n      const x = d3\n        .scaleBand()\n        .domain(data.map((d) => d.x))\n        .range([padding.left, width - padding.right])\n        .padding(0.2);\n      const y = d3\n        .scaleLinear()\n        .domain([0, d3.max(data, (d) => d.all)])\n        .nice()\n        .range([height - padding.bottom, padding.top]);\n      const highlightBars = highlightBarsG\n        .selectAll(\"rect\")\n        .data(data)\n        .join(\"rect\")\n        .attr(\"x\", (d) => x(d.x))\n        .attr(\"y\", (d) => y(d.highlight))\n        .attr(\"height\", (d) => y(0) - y(d.highlight))\n        .attr(\"width\", x.bandwidth());\n    }, [data, anaFilterType]);\n    return <svg id=\"ana-time-line-svg\" width=\"100%\" height=\"100%\" />;\n  }\n);\n\nexport default TimeLine;\n","import React, { useState } from \"react\";\nimport \"./index.scss\";\nimport { observer } from \"mobx-react-lite\";\nimport { useGlobalStore } from \"Store\";\nimport TagFilter from \"./TagFilter\";\nimport TimeLine from \"./TimeLine\";\n// import { toJS } from \"mobx\";\n\nconst TagView = observer(() => {\n  const store = useGlobalStore();\n  const {\n    // controlTagNameList,\n    // unitXAttr,\n    // unitXAttrList,\n    // analysisPapers,\n    // anaHighPapers,\n    // clearBrushTrigger,\n    setClearBrushTrigger,\n    anaTimeData,\n    anaTagViewData,\n    setAnaHighPapersByYear,\n    setAnaHighPapersByTag,\n    anaFilterType,\n    setAnaFilterType,\n  } = store;\n  // console.log(\"anaTagViewData\", toJS(anaTagViewData));\n  // console.log(\"ClearBrushTrigger\", clearBrushTrigger);\n  const [yearSelecting, setYearSelecting] = useState([0, 0]);\n  // const [yearSelected, setYearSelected] = useState([0, 0]);\n  return (\n    <div className=\"tag-view-container\">\n      <>\n        {anaTagViewData.map((tagViewData) => (\n          <div className=\"tag-filter-container\" key={tagViewData.value}>\n            <div className=\"tag-filter-label\">{tagViewData.label}</div>\n            <div className=\"tag-filter-div\">\n              {tagViewData.data.length > 0 && (\n                <TagFilter\n                  label={tagViewData.label}\n                  value={tagViewData.value}\n                  data={tagViewData.data}\n                  setAnaFilterType={setAnaFilterType}\n                  setAnaHighPapersByTag={setAnaHighPapersByTag}\n                  anaFilterType={anaFilterType}\n                />\n              )}\n            </div>\n          </div>\n        ))}\n        <div className=\"tag-filter-container\">\n          <div className=\"year-seleted-text\">{yearSelecting.join(\"-\")}</div>\n          <div className=\"time-line-div\">\n            {anaTimeData.length > 0 && (\n              <TimeLine\n                data={anaTimeData}\n                onInput={setYearSelecting}\n                onChange={setAnaHighPapersByYear}\n                setClearBrushTrigger={setClearBrushTrigger}\n                setAnaFilterType={setAnaFilterType}\n                anaFilterType={anaFilterType}\n              />\n            )}\n          </div>\n        </div>\n      </>\n    </div>\n  );\n});\n\nexport default TagView;\n","import React from 'react'\nimport './index.scss'\n\nconst ProjectView = () => {\n  return (\n    <div>\n      ProjectView\n    </div>\n  )\n}\n\nexport default ProjectView\n","import React from 'react'\nimport './index.scss'\n\nconst NetworkView = () => {\n  return (\n    <div>\n      NetworkView\n    </div>\n  )\n}\n\nexport default NetworkView\n","import React from 'react'\nimport './index.scss'\n\nconst TopicView = () => {\n  return (\n    <div>\n      TopicView\n    </div>\n  )\n}\n\nexport default TopicView\n","import React from 'react'\nimport './index.scss'\n\nconst HighlightListView = () => {\n  return (\n    <div>\n      HighlightListView\n    </div>\n  )\n}\n\nexport default HighlightListView\n","import React from 'react'\nimport './index.scss'\n\nconst DetaiView = () => {\n  return (\n    <div>\n      DetaiView\n    </div>\n  )\n}\n\nexport default DetaiView\n","import React, { useEffect } from \"react\";\nimport { useGlobalStore } from \"Store\";\nimport \"./index.scss\";\nimport TagView from \"./TagView\";\nimport ProjectView from \"./ProjectView\";\nimport NetworkView from \"./NetworkView\";\nimport TopicView from \"./TopicView\";\nimport HighlightListView from \"./HighlightListView\";\nimport DetailView from \"./DetailView\";\n\nconst AnalysisPage = () => {\n  const store = useGlobalStore();\n  useEffect(() => {\n    store.setCurrentPage();\n    store.initPapers();\n    store.initUserId();\n  }, []);\n  return (\n    <div className=\"analysis-container\">\n      <div className=\"left-container\">\n        <TagView />\n      </div>\n      <div className=\"middle-container\">\n        <div className=\"middle-top-container\">\n          <ProjectView />\n        </div>\n        <div className=\"middle-bottom-container\">\n          <NetworkView />\n        </div>\n      </div>\n      <div className=\"right-container\">\n        <div className=\"right-top-container\">\n          <TopicView />\n        </div>\n        <div className=\"right-middle-container\">\n          <HighlightListView />\n        </div>\n        <div className=\"right-bottom-container\">\n          <DetailView />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AnalysisPage;\n","export const userList = [\n  \"Prof. Yuan\",\n  \"Guozheng Li\",\n  \"Shuai Chen\",\n  \"Chenglei Yue\",\n  \"Ruike Jiang\",\n  \"Can Liu\",\n  \"Jincheng Li\",\n  \"Chaofan Yang\",\n  \"Hanning Shao\",\n  \"Yuchu Luo\",\n  \"Zhixian Lin\",\n  \"Min Tian\",\n  \"Dingyi Yang\",\n  \"Changhe Yang\",\n  \"Yanda Li\",\n  \"Datong Wei\",\n  \"Cong Wu\",\n  \"Hao Wu\",\n  \"Shaocong Tan\",\n  \"Jiacheng Yu\",\n  \"Sihang Li\",\n  \"Zhen Li\",\n  \"Haohua Liu\",\n  \"KaiChen Nie\"\n];\n\nexport default userList;\n","import React from \"react\";\nimport \"./index.scss\";\nimport userList from \"Common/userList\";\nimport { useGlobalStore } from \"Store\";\nimport { observer } from \"mobx-react-lite\";\nimport { Link } from \"react-router-dom\";\nimport { Select } from \"antd\";\nconst { Option } = Select;\n\nconst Header = observer(() => {\n  const store = useGlobalStore();\n  const handleChange = (userId) => {\n    store.setUserId(userId);\n  };\n  const { currentPage } = store;\n  const title = `Literature ${currentPage} System`;\n  const switchPage = currentPage === \"Analysis\" ? \"management\" : \"analysis\";\n  const switchPageShowText = currentPage === \"Analysis\" ? \"Manage\" : \"Analyze\";\n  const SwitchButton = () => (\n    <Link to={switchPage} className=\"switch-button\">\n      {switchPageShowText}\n    </Link>\n  );\n  return (\n    <div className=\"header\">\n      <div className=\"title\">{title}</div>\n      <div className=\"user-selector title\">\n        User: &nbsp;\n        <Select\n          value={store.userId}\n          size=\"small\"\n          onChange={handleChange}\n          style={{ width: 130 }}\n          placeholder=\"Set User\"\n        >\n          {userList.map((user) => (\n            <Option value={user} key={user}>\n              {user}\n            </Option>\n          ))}\n        </Select>\n        <SwitchButton />\n      </div>\n    </div>\n  );\n});\n\nexport default Header;\n","import React from \"react\";\nimport \"./App.scss\";\nimport { StoreProvider } from \"Store\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport ManagePage from \"Pages/ManagePage\";\nimport Analysis from \"Pages/AnalysisPage\";\nimport Header from \"Components/Header\";\n\nconst App = () => {\n  return (\n    <StoreProvider>\n      <Router basename=\"/vis_paper_management\">\n        <div className=\"view-container\">\n          <div className=\"header-container\">\n            <Header />\n          </div>\n          <Switch>\n            <Route exact path={`/management`} component={ManagePage} />\n            <Route exact path={`/analysis`} component={Analysis} />\n            <Route path=\"/\" component={ManagePage} />\n          </Switch>\n        </div>\n      </Router>\n    </StoreProvider>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'antd/dist/antd.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}