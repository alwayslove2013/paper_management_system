(this.webpackJsonppaper_management_system=this.webpackJsonppaper_management_system||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},152:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n(0),r=n.n(a),c=n(23),o=n.n(c),s=(n(127),n(128),n(17)),l=n(24),u=n(20),d=n.n(u),h=n(52),p=n(10),g=n(31),f=n(110),j=n.n(f),b="http://vis.pku.edu.cn/vis4vis/",v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=b+e+(e.includes("?")?"&":"?")+j.a.stringify(t);return new Promise((function(e,t){fetch(n).then((function(e){return e.json()})).then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},m=function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("get_papers");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("get_public_tags");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(h.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uid,e.next=3,v("get_private_tags",{uid:n});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){var t=e.uid,n=e.pid,i=e.paper,a=i.privateTags,r=i.read;return t&&v("set_private_tags",{uid:t,pid:n,tags:[].concat(Object(l.a)(a),[r&&"read"]).filter((function(e){return e})).join(",")}),"OK"};function C(e,t){return fetch(e,{body:JSON.stringify(t),headers:{"user-agent":"Mozilla/4.0 MDN Example","content-type":"application/json"},method:"POST"}).then((function(e){return e.json()}))}var P=n(32),T=15,N=35,S=8,w=25,k=function(e,t,n){return e=e.slice(0,n),t.forEach((function(n){if(!e.includes(n)){for(var i=e.length-1;t.includes(e[i]);)i-=1;e[i]=n}})),e},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n={};e.forEach((function(e){e.forEach((function(e){e&&(e in n?n[e]+=1:n[e]=1)}))}));var i=[];for(var a in n)i.push({item:a,count:n[a]});return i.sort((function(e,t){return t.count-e.count})),i.slice(0,t).map((function(e){return e.item}))};var _={publicTags:function(e){var t=e.pid,n=e.paper.publicTags;return v("set_public_tags",{pid:t,tags:n.join(",")}),"OK"},privateTags:y,read:y},L=function(){return{currentPage:"Management",setCurrentPage:function(){this.currentPage=window.location.hash.includes("/analysis")?"Analysis":"Management"},tooltipX:500,tooltipY:500,setTooltipPos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.tooltipX=e,this.tooltipY=t},titleSearch:"",setTitleSearch:function(e){this.titleSearch=e.toLocaleLowerCase()},get searchPaperDoiSet(){var e=this,t=this.titleSearch?this.papers.filter((function(t){return t.title.toLocaleLowerCase().indexOf(e.titleSearch)>-1})).map((function(e){return e.doi})):[];return new Set(t)},papers:[],commonAuthors:[],commonCountries:[],commonPublicTags:[],commonPrivateTags:[],initPapers:function(){var e=arguments,t=this;return Object(h.a)(d.a.mark((function n(){var i,a;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],0!==t.papers.length&&!i){n.next=6;break}return n.next=4,m();case 4:a=n.sent,t.setPapers(a);case 6:case"end":return n.stop()}}),n)})))()},setPapers:function(e){var t=arguments,n=this;return Object(h.a)(d.a.mark((function i(){var a,r;return d.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=t.length>1&&void 0!==t[1]?t[1]:"citationCount",console.log("==> \u521d\u59cb\u5316Papers"),r={},e.forEach((function(e){e.privateTags=[],e.projection=[5,5],e.topics=[],e.read=!1,e.publicTags=[],e.colors=[],e.innerColors=[],e.outerColors=[],e.internalRefList=[],e.internalCitedList=[],e.topics=[[0,1]],e.isHighlight=!1,e.indexByYear=0,e.refList=e.refList.toLowerCase().split(/[,;]/).map((function(e){return e.trim()})),e.doi=e.doi.toLowerCase(),r[e.doi]=e,e.authors=e.authors.split(";").map((function(e){return e.trim().replace(/\{(.*)\}/,"$1")})),e.countries=e.countries.split(";").map((function(e){var t=e.trim().split(" ").map((function(e){return e.trim()})).filter((function(e){return e}));return 0===t.length?"":t[t.length-1].toLowerCase().replace(/^\w/,(function(e){return e.toUpperCase()}))})).filter((function(e){return e})),e.year=+e.year,e.keywords=e.keywords.split(/[;,]/).map((function(e){return e.trim().toLowerCase()}))})),e.forEach((function(e){e.refList.forEach((function(t){t in r&&(r[t].internalCitedList.push(e.doi),e.internalRefList.push(t))}))})),n.commonAuthors=H(e.map((function(e){return e.authors})),30),n.commonCountries=H(e.map((function(e){return e.countries})),30),e.sort((function(e,t){return t[a]-e[a]})),n.computedPosition(e),i.next=11,n.initPublicTags(e);case 11:Object(g.d)((function(){n.papers=e,n.initPrivateTags()}));case 12:case"end":return i.stop()}}),i)})))()},setPaper:function(e,t,n){var i=this.papers.find((function(t){return t.doi===e}));i[t]=n,console.log("==> \u66f4\u65b0paper\u6570\u636e by doi:",e,t,n),_[t]({uid:this.userId,pid:e,paper:Object(g.e)(i)}),this.doiUpdateColors(e)},unitXAttr:"year",get unitXAttrList(){var e=this,t=new Set;this.papers.forEach((function(n){t.add(n[e.unitXAttr])}));var n=Array.from(t);return n.sort((function(e,t){return t-e})),n},unitYAttr:"conferenceName",unitYAttrList:["SciVis","InfoVis","EuroVis","VAST","PacificVis","Others"],maxUnitBlockPaperCount:0,unitBlockCount:{},computedPosition:function(e){var t=this,n={};e.forEach((function(e){var i=e[t.unitXAttr],a=t.unitYAttrList.includes(e[t.unitYAttr])?e[t.unitYAttr]:t.unitYAttrList[t.unitYAttrList.length-1];i in n||(n[i]={}),a in n[i]||(n[i][a]=0),e.unitIndex=n[i][a],n[i][a]+=1})),this.maxUnitBlockPaperCount=.7*Math.max.apply(Math,Object(l.a)(e.map((function(e){return e.unitIndex})))),this.unitBlockCount=n},initPublicTags:function(e){var t=this;return Object(h.a)(d.a.mark((function n(){var i;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,x();case 2:i=n.sent,e.forEach((function(e){e.doi in i&&(e.publicTags=i[e.doi].filter((function(e){return e})))})),Object(g.d)((function(){t.commonPublicTags=H(Object.values(i),30)}));case 5:case"end":return n.stop()}}),n)})))()},initPrivateTags:function(){var e=this;return Object(h.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O({uid:e.userId});case 2:n=t.sent,Object(g.d)((function(){e.papers.forEach((function(e){if(e.doi in n){var t=n[e.doi].indexOf("read");t>-1&&(e.read=!0,n[e.doi].splice(t,1)),e.privateTags=n[e.doi].filter((function(e){return e}))}})),e.commonPrivateTags=H(Object.values(n),30)})),e.batchUpdateColors();case 5:case"end":return t.stop()}}),t)})))()},userId:"",setUserId:function(e){e!==this.userId&&(this.userId=e,console.log("==> change userId:",this.userId),localStorage.setItem("paper-management-system-userId",e),e&&this.initPrivateTags())},initUserId:function(){if(0===this.userId.length){var e=localStorage.getItem("paper-management-system-userId");e&&this.setUserId(e)}},get controlTagNameList(){return this.generateCategory(10)},get anaCategories(){var e=k(H(this.analysisPapers.map((function(e){return e.countries})),30),["Japan","Korea"],50),t=H(this.analysisPapers.map((function(e){return e.authors})),30),n=k(this.commonPrivateTags,[],50),i=k(this.commonPublicTags,[],50);return[{label:"Country",value:"countries",list:e,highlightType:"outer"},{label:"Author",value:"authors",list:t,highlightType:"inner"},{label:"Keywords",value:"keywords",list:k(H(this.analysisPapers.map((function(e){return e.keywords})),30),[],50),highlightType:"inner"},{label:"Private Tag",value:"privateTags",list:n,highlightType:"inner"},{label:"Public Tag",value:"publicTags",list:i,highlightType:"inner"}]},get commonKeywords(){return H(this.papers.map((function(e){return e.keywords})),30)},generateCategory:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=k(this.commonCountries,["Japan","Korea"],e),i=k(this.commonAuthors,["Xiaoru Yuan"],e),a=k(this.commonPrivateTags,t?["read"]:[],e),r=k(this.commonPublicTags,[],e),c=k(this.commonKeywords,[],e);return[{label:"Country",value:"countries",list:n,highlightType:"outer"},{label:"Author",value:"authors",list:i,highlightType:"inner"},{label:"Keywords",value:"keywords",list:c,highlightType:"inner"},{label:"Private Tag",value:"privateTags",list:a,highlightType:"inner"},{label:"Public Tag",value:"publicTags",list:r,highlightType:"inner"}]},get category2highlightType(){var e={};return this.controlTagNameList.forEach((function(t){e[t.value]=t.highlightType})),e},activeTags:{countries:[],authors:[],privateTags:[],publicTags:[],keywords:[]},get controlIsActive(){var e=!1;for(var t in this.activeTags)this.activeTags[t].length>0&&(e=!0);return e},get isUnitOuterHighlight(){var e=this,t=this.controlTagNameList.filter((function(e){return"outer"===e.highlightType})).map((function(e){return e.value})),n=!1;return t.forEach((function(t){e.activeTags[t].length>0&&(n=!0)})),n},tag2color:{},colorUse:{},setTagColor:function(e,t){console.log("==> \u8bbe\u7f6etag\u989c\u8272:",t,e);var n="".concat(t,"---").concat(e);if(n in this.tag2color)this.colorUse[this.tag2color[n]]=!1,delete this.tag2color[n],this.activeTags[t]=Object(l.a)(this.activeTags[t]).filter((function(t){return t!==e}));else{this.activeTags[t].push(e);for(var i=0,a=p.schemeTableau10[i];this.colorUse[a];){if(10===(i+=1)){a="black";break}a=p.schemeTableau10[i]}this.tag2color[n]=a,this.colorUse[a]=!0}this.batchUpdateColors()},batchUpdateColors:function(){var e=this;this.papers.forEach((function(t){t.colors=[],t.innerColors=[],t.outerColors=[],e.updateColor(t)}))},doiUpdateColors:function(e){var t=this.papers.find((function(t){return t.doi===e}));t.colors=[],t.innerColors=[],t.outerColors=[],this.updateColor(t)},updateColor:function(e){var t=this;this.activeTags.privateTags.indexOf("read")>-1&&e.read&&(e.colors.push(this.tag2color["privateTags---read"]),e.innerColors.push(this.tag2color["privateTags---read"]));var n=function(n){var i=t.activeTags[n];"inner"===t.category2highlightType[n]?i.forEach((function(i){if(e[n].indexOf(i)>-1){var a="".concat(n,"---").concat(i);e.innerColors.push(t.tag2color[a])}})):i.forEach((function(i){if(e[n].indexOf(i)>-1){var a="".concat(n,"---").concat(i);e.outerColors.push(t.tag2color[a])}})),i.forEach((function(i){if(e[n].indexOf(i)>-1){var a="".concat(n,"---").concat(i);e.colors.push(t.tag2color[a])}}))};for(var i in this.activeTags)n(i)},maxCitationCount:200,currentSelected:"",currentSelectedRefSet:new Set,currentSelectedCitedSet:new Set,isSelected:!1,setCurrentSelected:function(e){console.log("==> \u9009\u4e2d\u6587\u7ae0:",e),this.currentSelected=e,this.isSelected=!!e;var t=this.papers.find((function(t){return t.doi===e}));this.currentSelectedRefSet=new Set(t.internalRefList),this.currentSelectedCitedSet=new Set(t.internalCitedList)},cancelSelect:function(){console.log("==> \u70b9\u51fb\u80cc\u666f\uff0c\u53d6\u6d88\u8bba\u6587\u9009\u4e2d\u72b6\u6001"),this.isSelected=!1},get currentSelectedPaper(){var e=this,t=this.papers.find((function(t){return t.doi===e.currentSelected}));return console.log("currentSelectedPaper",Object(g.e)(t)),t},get analysisPapers(){return this.controlIsActive?this.papers.filter((function(e){return e.innerColors.length>0||e.outerColors.length>0})):this.papers},get anaTimeData(){var e=this;return this.unitXAttrList.map((function(e){return+e})).sort().map((function(t){return{x:t,all:e.analysisPapers.filter((function(e){return+e.year===t})).length,highlight:e.anaHighPapers.filter((function(e){return+e.year===t})).length}}))},get anaTagViewData(){var e=this;return this.anaCategories.map((function(t){return{label:t.label,value:t.value,data:t.list.map((function(n){return"read"===n?{label:"read",all:e.analysisPapers.filter((function(e){return e.read})).length,highlight:e.anaHighPapers.filter((function(e){return e.read})).length}:{label:n,all:e.analysisPapers.filter((function(e){return e[t.value].includes(n)})).length,highlight:e.anaHighPapers.filter((function(e){return e[t.value].includes(n)})).length}}))}}))},anaFilterType:"none",setAnaFilterType:function(e){console.log("setAnaFilterType",e),this.anaFilterType=e},clearBrushTrigger:function(){},setClearBrushTrigger:function(e){this.clearBrushTrigger=e},anaHighCate:"",anaHighTag:"",anaHighTopic:"",anaHighPapers:[],setAnaHighPapersByTag:function(e){var t=e.anaHighCate,n=e.anaHighTag;console.log("setAnaHighPapersByTag",t,n),this.clearBrushTrigger(),this.anaHighCate===t&&this.anaHighTag===n?(this.anaHighTag="none",this.setAnaFilterType("none"),this.anaHighPapers=this.analysisPapers):(this.anaHighCate=t,this.anaHighTag=n,this.setAnaFilterType(t),this.anaHighPapers=this.analysisPapers.filter((function(e){return Object(P.get)(e,t,[]).includes(n)})))},setAnaHighPapersByTopic:function(e){console.log("setAnaHighPapersByTopic",e),this.clearBrushTrigger(),"topic"===this.anaFilterType&&this.anaHighTopic===e?(this.anaHighTopic="none",this.anaHighEntityTopic=-1,this.setAnaFilterType("none"),this.anaHighPapers=this.analysisPapers):(this.anaHighTopic=e,this.anaHighEntityTopic=-1,this.anaHighTag="topic ".concat(e+1),this.setAnaFilterType("topic"),this.anaHighPapers=this.analysisPapers.filter((function(t){return t.topics.map((function(e){return e[0]})).includes(e)})))},setAnaHighPapersByYear:function(e){console.log("setAnaHighPapersByYear",e);var t=Object(s.a)(e,2),n=t[0],i=t[1];this.anaHighTag="".concat(n,"-").concat(i),this.anaHighPapers=this.analysisPapers.filter((function(e){return+e.year>=n&&+e.year<=i}))},anaSelectHighlightPaperDoi:"",setAnaSelectHighlightPaperDoi:function(e){console.log("setAnaSelectHighlightPaper",e),this.anaSelectHighlightPaperDoi===e?(console.log("reset anaSelectHighlightPaperDoi"),this.anaSelectHighlightPaperDoi=""):this.anaSelectHighlightPaperDoi=e},get anaSelectHighlightPaper(){var e=this;return this.analysisPapers.find((function(t){return t.doi===e.anaSelectHighlightPaperDoi}))||{}},topicColorScale:p.schemeTableau10.slice(1),defaultHighColor:p.schemeTableau10[0],drawProjectionFlag:!1,resetProjectionFlag:function(){console.log("reset drawProjectionFlag"),this.drawProjectionFlag=!1},num_topics:5,setNumTopics:function(e){this.num_topics=e,this.tryLda()},topics_detail:[],tryLda:function(){var e=this,t=this.analysisPapers.map((function(e){return e.doi})),n=this.userId,i=this.num_topics;console.log("try lda Start!",i),function(e){var t=e.dois,n=e.uid,i=e.num_topics;return C(b+"get_lda_results",{dois:t,num_topics:void 0===i?3:i,uid:n})}({dois:t,uid:n,num_topics:i}).then((function(t){console.log("try lda OK!",t),Object(g.d)((function(){var n=t.paper_lda_res,i=t.topics_detail,a=t.code;"success"===(void 0===a?"success":a)&&(e.analysisPapers.forEach((function(e){e.doi in n?(e.projection=n[e.doi].projection,e.topics=n[e.doi].topics.sort((function(e,t){return t[1]-e[1]}))):(e.projection=[5,5],e.topics=[])})),e.drawProjectionFlag=!0,e.topics_detail=i,e.anaHighPapers=e.analysisPapers)}))}))},anaHighEntityTopic:-1,setAnaHighEntityTopic:function(e){this.anaHighEntityTopic===e?(console.log("setAnaHighEntityTopic",!1),this.anaHighEntityTopic=-1):(console.log("setAnaHighEntityTopic",e),this.anaHighEntityTopic=e)},anaHighEntityCitePaperDois:[],anaHighEntityCitedPaperDois:[],anaHighTopicIndenpentPaperDois:[],setHighEntityLinkData:function(e,t,n){console.log("citePaperDois",e),console.log("citedPaperDois",t),this.anaHighEntityCitePaperDois=e,this.anaHighEntityCitedPaperDois=t,this.anaHighTopicIndenpentPaperDois=n},uploadModalShow:!1,setUploadModalShow:function(){console.log("setUploadModalShow",!this.uploadModalShow),this.uploadModalShow=!this.uploadModalShow},updatePaper:function(e,t){var n=this;console.log("update paper info",e,t),function(e,t){return C(b+"update_single_paper",{oriDoi:e,newPaper:t})}(e,t).then((function(){Object(g.d)((function(){console.log("singleUpdatePaper finished",e,t),n.initPapers()}))}))}}},A=n(154),I=r.a.createContext(null),E=function(e){var t=e.children,n=Object(A.a)(L);return Object(i.jsx)(I.Provider,{value:n,children:t})},D=function(){var e=r.a.useContext(I);if(!e)throw new Error("no Provider");return e},Y=n(89),B=n(26),F=(n(132),n(159)),M=(n(133),n(94)),X=function(){var e=D(),t=Object(P.debounce)((function(t){e.setTitleSearch(t.target.value)}),200);return Object(i.jsxs)("div",{className:"search-view",children:[Object(i.jsx)("div",{className:"search-view-input",children:Object(i.jsx)("input",{onInput:t})}),Object(i.jsx)("div",{className:"search-view-icon",children:Object(i.jsx)(M.a,{})})]})},U=Object(F.a)((function(){var e=D().controlTagNameList;return Object(i.jsxs)("div",{className:"control-view",children:[Object(i.jsxs)("div",{className:"control-item",children:[Object(i.jsx)("div",{className:"control-item-title",children:"Title Search"}),Object(i.jsx)("div",{className:"control-item-search-input",children:Object(i.jsx)(X,{searchAttr:"title"})})]}),e.map((function(e){return Object(i.jsx)(W,{tagData:e},e.label)}))]})})),W=Object(F.a)((function(e){var t=e.tagData,n=D(),r=n.tag2color,c=n.papers,o=Object(a.useState)([]),u=Object(s.a)(o,2),d=u[0],h=u[1];Object(a.useEffect)((function(){var e=Object.keys(r).filter((function(e){return e.split("---")[0]===t.value})).map((function(e){return e.split("---")[1]})).filter((function(e){return t.list.indexOf(e)>-1}));h(e)}),[]);var p=function(e){var i=Object(l.a)(d),a=i.indexOf(e);a>-1?(i.splice(a,1),h(i)):(i.push(e),h(i)),n.setTagColor(e,t.value)};return Object(i.jsxs)("div",{className:"control-item",children:[Object(i.jsx)("div",{className:"control-item-title",children:t.label}),Object(i.jsx)("div",{className:"control-item-options",children:t.list.map((function(e){return Object(i.jsx)(z,{value:e,clickOption:p,isSelect:d.indexOf(e)>-1&&r["".concat(t.value,"---").concat(e)],count:d.indexOf(e)>-1?c.filter((function(n){return n[t.value].includes(e)})).length:0},e)}))})]})})),z=function(e){var t=e.value,n=e.clickOption,a=e.isSelect,r=e.count,c=void 0===r?0:r,o=["control-item-option",a&&"option-active"].filter((function(e){return e})).join(" "),s=a?{background:a,border:"1px solid ".concat(a)}:{},l="Usa"===t?"USA":t;return Object(i.jsxs)("div",{className:o,onClick:function(){return n(t)},style:s,children:[l," ",a&&"(".concat(c,")")]})},K=(n(134),r.a.memo((function(e){var t=e.cx,n=e.cy,a=e.r,r=e.opacity,c=e.doi,o=e.handleClick,s=e.title,l=e.innerColors,u=e.outerColors,d=e.isBackgroundActive,h=e.handleHover,p=e.handleHoverOut,g=function(e){return t+Math.sin(e)*a},f=function(e){return n+Math.cos(e)*a},j=2*Math.PI/l.length,b=l.map((function(e,t){return{startX:g(j*t),startY:f(j*t),endX:g(j*(t+1)),endY:f(j*(t+1))}})),v=1.5*a,m=function(e){return t+Math.sin(e)*v},x=function(e){return n+Math.cos(e)*v},O=2*Math.PI/u.length,y=u.map((function(e,t){return{startX:m(O*t),startY:x(O*t),endX:m(O*(t+1)),endY:x(O*(t+1))}}));return Object(i.jsxs)("g",{id:"unit-g",onClick:function(e){return o(e,c)},cursor:"pointer",onMouseEnter:function(){return h(c)},onMouseLeave:function(){return p()},children:[Object(i.jsx)("title",{children:s}),d&&Object(i.jsxs)("g",{id:"unit-background-g",children:[Object(i.jsx)("rect",{x:t-1.6*a,y:n-1.6*a,width:3.2*a,height:3.2*a,fill:"#fc8d62",rx:.4*a,ry:.4*a}),Object(i.jsx)("circle",{cx:t,cy:n,r:1.3*a,fill:"#eee"})]}),Object(i.jsxs)("g",{id:"unit-border-g",children:[y.length>1?y.map((function(e,a){return Object(i.jsx)("path",{d:"M ".concat(t," ").concat(n,"\n              L ").concat(e.startX," ").concat(e.startY,"\n              A ").concat(v," ").concat(v," 0 0 0 ").concat(e.endX," ").concat(e.endY,"\n              Z\n              "),fill:u[a]},a)})):Object(i.jsx)("circle",{cx:t,cy:n,r:v,fill:u.length>0?u[0]:"none"}),Object(i.jsx)("circle",{cx:t,cy:n,r:1.1*a,fill:"white",opacity:y.length>0?1:0})]}),Object(i.jsx)("g",{id:"unit-sector-g",opacity:r,children:b.length>1?b.map((function(e,r){return Object(i.jsx)("path",{d:"M ".concat(t," ").concat(n,"\n              L ").concat(e.startX," ").concat(e.startY,"\n              A ").concat(a," ").concat(a," 0 0 0 ").concat(e.endX," ").concat(e.endY,"\n              Z\n              "),stroke:"white",fill:l[r],strokeWidth:.1*a},r)})):Object(i.jsx)("circle",{cx:t,cy:n,r:a,fill:l[0]})})]})}))),R=function(e){var t=e.isShow,n=e.paper,a=e.paperCircle,r=e.containerWidth,c=e.containerHeight,o=a.cx/r,s=.25*r,l=a.cx-s*o,u=a.cy+15,d=a.cy+200>c?"translateY(-150%)":"",h={transform:"translate(".concat(l,"px,").concat(u,"px) ").concat(d),opacity:t?1:0};return Object(i.jsxs)("div",{className:"unit-tooltip",style:h,children:[Object(i.jsx)("div",{className:"unit-tooltip-title",children:Object(P.get)(n,"title","")}),Object(i.jsxs)("div",{className:"unit-tooltip-authors",children:[Object(P.get)(n,"authors",[]).join("; ")," (",n.year,")"]})]})},J=30,V=40,Z=15,q=1,G=2,$=3,Q=3,ee=1,te=Object(F.a)((function(){var e=D(),t=e.papers,n=e.unitXAttr,r=e.unitYAttr,c=e.unitXAttrList,o=e.unitYAttrList,u=e.unitBlockCount,d=e.maxUnitBlockPaperCount,h=e.controlIsActive,f=e.isUnitOuterHighlight,j=e.currentSelected,b=e.setCurrentSelected,v=e.isSelected,m=e.cancelSelect,x=e.currentSelectedRefSet,O=e.currentSelectedCitedSet,y=e.searchPaperDoiSet,C=Object(a.useState)(0),T=Object(s.a)(C,2),N=T[0],S=T[1],w=Object(a.useState)(0),k=Object(s.a)(w,2),H=k[0],_=k[1];Object(a.useEffect)((function(){var e=document.querySelector("#unit-svg");S(e.clientWidth-V-Z),_(e.clientHeight-J-q)}),[]);for(var L,A=c.length>0?N/c.length-$-Q:0,I=o.length>0?H/o.length-G-ee:0,E=Math.floor(A>0?I/A:1),Y=Math.ceil(Math.sqrt(d/E)),B=c.map((function(e,t){var n=Math.max.apply(Math,Object(l.a)(o.map((function(t,n){return Object(P.get)(u,[e,t],0)})))),i=Math.ceil(Math.sqrt(d/E));return n>d&&(i+=1),i})),F=[0],M=[0],X=1;X<c.length;X++)F.push(F[X-1]+B[X-1]);L=(N-($+Q)*c.length)/(F[F.length-1]+B[B.length-1]);for(var U=1;U<c.length;U++)M.push(F[U]*L+($+Q)*U);var W=p.scaleLinear().domain([0,100]).range([.25,.8]),z=t.map((function(e){var t={};t.oriData=Object(g.e)(e),t.BlockIndexX=c.indexOf(e[n]),t.BlockIndexY=o.includes(e[r])?o.indexOf(e[r]):o.length-1;var i,a=e.doi;return t.doi=a,t.circleIndexX=e.unitIndex%B[t.BlockIndexX],t.circleIndexY=Math.floor(e.unitIndex/B[t.BlockIndexX]),t.cy=J+t.BlockIndexY*(I+G+ee)+(t.circleIndexY+.5)*L,"2004"===e.year&&t.BlockIndexY>0&&(t.cy+=50-10*t.BlockIndexY),t.cx=V+M[t.BlockIndexX]+(t.circleIndexX+.5)*L,t.citationGrey=(i=e.citationCount,p.interpolateGreys(W(i))),t.activeColors=e.innerColors,t.innerColors=t.activeColors.length>0?t.activeColors:[t.citationGrey],t.outerColors=["none"],f?t.outerColors=e.outerColors:v?(j===e.doi&&(t.outerColors=["#d95f02"]),x.has(e.doi)&&(t.outerColors=["#1b9e77"]),O.has(e.doi)&&(t.outerColors=["#7570b3"])):t.outerColors=["none"],t.opacity=h?e.innerColors.length+e.outerColors.length>0?.8:.4:.8,t.title=e.Title,v?(j===e.doi&&(t.borderColor="#d95f02"),x.has(e.doi)&&(t.borderColor="#1b9e77"),O.has(e.doi)&&(t.borderColor="#7570b3")):t.borderColor="none",t.isBackgroundActive=y.has(e.doi),t})),te=c.map((function(e,t){return{value:e,x:V+M[t]+B[t]*L/2,y:.8*J}})),ne=o.map((function(e,t){return{value:e,x:.35*V,y:J+(I+G+ee)*t}})),ie=function(e,t){e.stopPropagation(),b(t)},ae=Object(a.useState)(""),re=Object(s.a)(ae,2),ce=re[0],oe=re[1],se=ce.length>0?t.find((function(e){return e.doi===ce})):{},le=ce.length>0?z.find((function(e){return e.doi===ce})):{},ue=function(e){console.log("===> hover",e),oe(e)},de=function(){console.log("===> mouse leave"),oe("")};return Object(i.jsxs)("div",{className:"unit-view",children:[Object(i.jsxs)("svg",{id:"unit-svg",width:"100%",height:"100%",onClick:function(){m()},children:[Object(i.jsx)("g",{id:"units",children:L>0&&z.map((function(e,t){return Object(i.jsx)(K,{cx:e.cx,cy:e.cy,r:L/2.4,doi:e.doi,colors:e.colors,opacity:e.opacity,innerColors:e.innerColors,outerColors:e.outerColors,handleClick:ie,borderOpacity:e.borderOpacity,borderColor:e.borderColor,title:e.title,isBackgroundActive:e.isBackgroundActive,handleHover:ue,handleHoverOut:de},t)}))}),Object(i.jsx)("g",{id:"x-label",children:L>0&&te.map((function(e){return Object(i.jsx)("text",{x:e.x,y:e.y,textAnchor:"middle",fontSize:1.6*L,fill:"rgb(78, 78, 78)",children:e.value},e.value)}))}),Object(i.jsx)("g",{id:"y-label",children:L>0&&ne.map((function(e){return Object(i.jsx)("text",{transform:"translate(".concat(e.x,", ").concat(e.y,") rotate(90)"),fontSize:1.6*L,fill:"rgb(78, 78, 78)",children:e.value},e.value)}))})]}),Object(i.jsx)(R,{isShow:ce.length>0,paper:se,containerWidth:N,containerHeight:H,paperCircle:le})]})})),ne=n(58),ie=(n(135),n(164)),ae=n(161),re=n(160),ce=n(165),oe=n(166),se=n(93),le=n(38),ue=n(121),de=["title","doi","year","conferenceName","authors","citationCount","affiliation","countries","abstract","keywords","refList"],he=Object(F.a)((function(){var e=D(),t=e.currentSelectedPaper,n=e.setPaper,r=e.updatePaper,c=t,o=Object(a.useState)(!1),l=Object(s.a)(o,2),u=l[0],d=l[1],h=Object(a.useState)({}),p=Object(s.a)(h,2),g=p[0],f=p[1],j=function(){if(!u){var e={};de.forEach((function(n){return e[n]=Array.isArray(t[n])?t[n].join("; "):t[n]})),f(e)}d(!u)};if(!t)return Object(i.jsx)("div",{});var b=Object(P.get)(c,"doi",""),v=[{title:"Private Tags",value:"privateTags",initTags:Object(P.get)(c,"privateTags",[])},{title:"Public Tags",value:"publicTags",initTags:Object(P.get)(c,"publicTags",[])}];return Object(i.jsx)("div",{className:"detail-view",children:c&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"detail-header",children:[Object(i.jsxs)("div",{className:"detail-header-content",children:[Object(i.jsx)("div",{className:"detail-title",children:c.title}),Object(i.jsxs)("div",{className:"detail-authors",children:[Object(P.get)(c,"authors",[]).join("; ")," (",c.year,")"]})]}),Object(i.jsx)("div",{className:"detail-header-icons",children:Object(i.jsx)(oe.a,{onClick:j})})]}),Object(i.jsxs)("div",{className:"detail-edit-tags",children:[Object(i.jsxs)("div",{className:"detail-edit-read",children:[Object(i.jsx)("div",{className:"detail-edit-title",children:"Read"}),Object(i.jsx)(ie.a,{size:"small",checkedChildren:Object(i.jsx)(se.a,{}),unCheckedChildren:Object(i.jsx)(le.a,{}),defaultChecked:Object(P.get)(c,"read",!1),onChange:function(e){n(b,"read",e)}})]}),v.map((function(e){return Object(i.jsx)(ge,{title:e.title,initTags:e.initTags,handleChangeTags:function(t){return function(e,t){b&&n(b,e,t)}(e.value,t)}},e.value)}))]}),Object(i.jsxs)("div",{className:"detail-attrs",children:[Object(i.jsxs)("div",{className:"detail-attr",children:[Object(i.jsx)("div",{className:"detail-key",children:"keywords:"}),Object(i.jsx)("div",{className:"detail-content",children:Object(P.get)(c,"keywords",[]).join("; ")})]}),Object(i.jsx)(pe,{paper:c,label:"doi"}),Object(i.jsx)(pe,{paper:c,label:"conference/journal",value:"conferenceName"}),Object(i.jsx)(pe,{paper:c,label:"affiliation"}),Object(i.jsx)(pe,{paper:c,label:"abstract"})]}),Object(i.jsx)(ae.a,{title:"Upload",visible:u,onOk:function(){r(t.doi,g),j()},onCancel:j,centered:!0,children:de.map((function(e){return Object(i.jsxs)("div",{className:"detail-new-paper-item",children:[Object(i.jsx)("div",{className:"detail-new-paper-label",children:e}),Object(i.jsx)("div",{className:"detail-new-paper-input",children:Object(i.jsx)(re.a,{value:g[e],onChange:function(t){var n=Object(ne.a)({},g);n[e]=t.target.value,f(n)}})})]},e)}))},t.doi)]})},b)})),pe=function(e){var t=e.paper,n=e.label,a=e.value,r=void 0===a?"":a;return 0===r.length&&(r=n),Object(i.jsxs)("div",{className:"detail-attr",children:[Object(i.jsxs)("div",{className:"detail-key",children:[n,":"]}),Object(i.jsx)("div",{className:"detail-content",children:Object(P.get)(t,r,"")})]})},ge=function(e){var t=e.title,n=e.initTags,r=e.handleChangeTags,c=Object(a.useState)(n),o=Object(s.a)(c,2),u=o[0],d=o[1],h=function(e){r(e),d(e)},p=Object(a.useState)(-1),g=Object(s.a)(p,2),f=g[0],j=g[1],b=Object(a.useRef)(),v=Object(a.useState)(""),m=Object(s.a)(v,2),x=m[0],O=m[1],y=function(){var e=Object(l.a)(u);e[f]=x,h(e),j(-1),O("")},C=Object(a.useState)(""),P=Object(s.a)(C,2),T=P[0],N=P[1],S=function(){T&&u.indexOf(T)<0&&(h([].concat(Object(l.a)(u),[T])),_(!1),N(""))},w=Object(a.useState)(!1),k=Object(s.a)(w,2),H=k[0],_=k[1];return Object(i.jsxs)("div",{className:"detail-edit-tag",children:[Object(i.jsxs)("div",{className:"detail-edit-title",children:[t,":"]}),Object(i.jsx)("div",{className:"detail-edit-tags",children:Object(i.jsxs)(i.Fragment,{children:[u.map((function(e,t){return f===t?Object(i.jsx)(re.a,{size:"small",className:"tag-input",value:x,onchange:function(e){return O(e.target.value)},onBlur:y,onPressEnter:y},e):Object(i.jsx)(ce.a,{className:"edit-tag",closable:!0,onClose:function(){return t=e,void h(u.filter((function(e){return e!==t})));var t},children:Object(i.jsx)("span",{children:e})},e)})),H&&Object(i.jsx)(re.a,{ref:b,type:"text",size:"small",className:"tag-input",value:T,onChange:function(e){return N(e.target.value)},onBlur:S,onPressEnter:S}),!H&&Object(i.jsxs)(ce.a,{className:"site-tag-plus",onClick:function(){_(!0)},children:[Object(i.jsx)(ue.a,{})," New Tag"]})]})})]})},fe=function(){var e=D();return Object(a.useEffect)((function(){e.setCurrentPage(),e.initPapers(),e.initUserId()}),[]),Object(i.jsxs)("div",{className:"main-container",children:[Object(i.jsxs)("div",{className:"control-main-container",children:[Object(i.jsx)("div",{className:"control-view-container",children:Object(i.jsx)(U,{})}),Object(i.jsx)("div",{className:"unit-view-container",children:Object(i.jsx)(te,{})})]}),Object(i.jsx)("div",{className:"detail-view-container",children:Object(i.jsx)(he,{})})]})},je=(n(138),n(139),n(140),function(e){var t=e.svgId,n=Object(a.useState)({width:0,height:0}),i=Object(s.a)(n,2),r=i[0],c=i[1];return Object(a.useEffect)((function(){var e=p.select("#".concat(t)).node().getClientRects()[0];c(e)}),[t]),r}),be=r.a.memo((function(e){var t=e.data,n=e.onInput,r=void 0===n?function(){}:n,c=e.onChange,o=void 0===c?function(){}:c,s=e.setClearBrushTrigger,l=void 0===s?function(){}:s,u=e.anaFilterType,d=void 0===u?"none":u,h=e.setAnaFilterType,g=void 0===h?function(){}:h,f=je({svgId:"ana-time-line-svg"}),j=f.width,b=f.height,v=[p.min(t,(function(e){return e.x})),p.max(t,(function(e){return e.x}))];return Object(a.useEffect)((function(){r(v)}),[]),Object(a.useEffect)((function(){if(0!==t.length&&0!==j&&0!==b){var e=p.scaleBand().domain(t.map((function(e){return e.x}))).range([T,j-N]).padding(.2),n=p.scaleLinear().domain([0,p.max(t,(function(e){return e.all}))]).nice().range([b-w,S]),i=p.select("#ana-time-line-svg"),a=i.append("g").classed("non-active-bars",!0).selectAll("rect").data(t).join("rect").attr("x",(function(t){return t.rectX=e(t.x)})).attr("y",(function(e){return n(e.all)})).attr("height",(function(e){return n(0)-n(e.all)})).attr("width",e.bandwidth());i.append("g").classed("active-bars",!0).classed("highlight-bars",!0);i.append("g").attr("class","x-axis").call((function(t){return t.attr("transform","translate(0, "+(b-w)+")").call(p.axisBottom(e).tickValues(p.range(v[0],v[1],5)).tickSizeOuter(0))})),i.append("g").attr("class","y-axis").call((function(e){return e.attr("transform","translate(".concat(j-N,",0)")).call(p.axisRight(n).ticks(6))}));var c=p.brushX().extent([[T,.3*S],[j-N,b-w]]).on("start",(function(){g("year")})).on("brush",(function(n){var i=n.selection;a.classed("active-bars",(function(t){return t.rectX+e.bandwidth()>i[0]&&t.rectX<i[1]}));var c=t.filter((function(t){return t.rectX+e.bandwidth()>i[0]&&t.rectX<i[1]})).map((function(e){return e.x}));c.length>=1?r([c[0],c[c.length-1]]):r(v)})).on("end",(function(n){var i=n.selection;if(i){var c=t.filter((function(t){return t.rectX+e.bandwidth()>i[0]&&t.rectX<i[1]})).map((function(e){return e.x}));c.length>=1?o([c[0],c[c.length-1]]):o(v)}else a.classed("active-bars",!1),r(v),g("none"),o(v)}));i.call(c),l((function(){p.brush().move(i),a.classed("active-bars",!1),r(v)}))}}),[f]),Object(a.useEffect)((function(){if(0!==j&&0!==b){var e=p.select("#ana-time-line-svg").select(".highlight-bars");if("year"===d||"none"===d)e.selectAll("rect").attr("height",0);else{var n=p.scaleBand().domain(t.map((function(e){return e.x}))).range([T,j-N]).padding(.2),i=p.scaleLinear().domain([0,p.max(t,(function(e){return e.all}))]).nice().range([b-w,S]);e.selectAll("rect").data(t).join("rect").attr("x",(function(e){return n(e.x)})).attr("y",(function(e){return i(e.highlight)})).attr("height",(function(e){return i(0)-i(e.highlight)})).attr("width",n.bandwidth())}}}),[t,d]),Object(i.jsx)("svg",{id:"ana-time-line-svg",width:"100%",height:"100%"})})),ve=(n(141),n(156)),me=ve.a.TabPane,xe=Object(a.memo)((function(e){var t=e.dataSource,n=e.anaFilterType,a=e.onChange;return Object(i.jsx)(ve.a,{children:t.map((function(e){return Object(i.jsx)(me,{tab:e.label,children:Object(i.jsx)(Oe,Object(ne.a)(Object(ne.a)({},e),{},{isHighlight:"none"!==n,onChange:a}))},e.label)}))})})),Oe=function(e){var t=e.value,n=e.data,a=e.isHighlight,r=e.onChange,c="tag-filter-".concat(t);n=n.filter((function(e){return e.all>0})).sort((function(e,t){return t.all-e.all}));var o=p.scaleLinear().domain([0,p.max(n,(function(e){return e.all}))]).nice().range([0,90]);return Object(i.jsx)("div",{id:c,style:{paddingBottom:20},children:n.map((function(e){return Object(i.jsxs)("div",{className:"tag-bar-row",onClick:function(){return r({anaHighCate:t,anaHighTag:e.label})},children:[Object(i.jsx)("div",{className:"tag-label single-row",children:"Usa"===e.label?"USA":e.label}),Object(i.jsxs)("div",{className:"tag-bar-container",children:[Object(i.jsx)("div",{className:"tag-bar bar",style:{width:"".concat(o(e.all),"%"),height:16}}),a&&Object(i.jsx)("div",{className:"active-tag-bar highlight-bar-blue bar",style:{width:"".concat(o(e.highlight),"%"),height:16}})]}),Object(i.jsxs)("div",{className:"tag-count",children:[a&&Object(i.jsxs)("div",{className:"tag-count-highlight highlight-blue",children:[e.highlight,"\xa0/\xa0"]}),Object(i.jsx)("div",{children:e.all})]})]},e.label)}))})},ye=xe,Ce=Object(F.a)((function(){var e=D(),t=e.analysisPapers,n=e.anaHighPapers,r=e.setClearBrushTrigger,c=e.anaTimeData,o=e.anaTagViewData,l=e.setAnaHighPapersByYear,u=e.setAnaHighPapersByTag,d=e.anaFilterType,h=e.setAnaFilterType,p=e.anaHighTag,g=Object(a.useState)([0,0]),f=Object(s.a)(g,2),j=f[0],b=f[1];return Object(i.jsxs)("div",{className:"tag-view-container",children:[Object(i.jsxs)("div",{className:"tag-header",children:[Object(i.jsx)("div",{className:"analysis-paper-count",children:Object(i.jsx)(Pe,{isAll:"none"===d,allCount:t.length,highlightCount:n.length})}),"none"===d||Object(i.jsx)("div",{className:"selected-highlight-attr highlight-bar-blue",children:"".concat("Usa"===p?"USA":p)})]}),Object(i.jsx)("div",{className:"tag-highlight-tabs-container",children:Object(i.jsx)(ye,{dataSource:o,onChange:u,anaFilterType:d})}),Object(i.jsxs)("div",{className:"tag-time-line",children:[Object(i.jsx)("div",{className:"year-seleted-text",children:j.join("-")}),Object(i.jsx)("div",{className:"time-line-div",children:c.length>0&&Object(i.jsx)(be,{data:c,onInput:b,onChange:l,setClearBrushTrigger:r,setAnaFilterType:h,anaFilterType:d})})]})]})})),Pe=Object(a.memo)((function(e){var t=e.isAll,n=e.allCount,a=e.highlightCount,r=void 0===a?0:a;return t?Object(i.jsxs)("span",{className:"paper-all-count",children:["Papers: ",n]}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("span",{className:"paper-all-count",children:"Papers: "}),Object(i.jsx)("span",{className:"paper-highlight-count highlight-blue",children:r}),Object(i.jsxs)("span",{className:"paper-all-count",children:["\xa0/\xa0",n]})]})})),Te=Ce,Ne=(n(142),n(157)),Se=Object(F.a)((function(){var e="ana-projection-map-svg",t=D(),n=(t.drawProjectionFlag,t.analysisPapers),r=t.anaHighPapers,c=t.num_topics,o=(t.resetProjectionFlag,t.setNumTopics),u=(t.defaultHighColor,t.topicColorScale),d=t.anaFilterType,h=t.anaHighTopic,g=t.setAnaSelectHighlightPaperDoi,f=t.anaSelectHighlightPaperDoi,j=t.setHighEntityLinkData,b=t.anaHighEntityTopic,v=t.setAnaHighEntityTopic,m=Object(a.useState)(c),x=Object(s.a)(m,2),O=x[0],y=x[1],C=je({svgId:e}),P=C.width,T=C.height;Object(a.useEffect)((function(){t.tryLda()}),[]);var N=30,S=30,w=30,k=30,H=p.scaleLinear().domain([p.min(n,(function(e){return e.projection[0]})),p.max(n,(function(e){return e.projection[0]}))]).nice().range([N,P-S]),_=p.scaleLinear().domain([p.min(n,(function(e){return e.projection[1]})),p.max(n,(function(e){return e.projection[1]}))]).nice().range([T-k,w]),L=p.range(c).map((function(e){return p.contourDensity().x((function(e){return H(e.projection[0])})).y((function(e){return _(e.projection[1])})).size([P,T]).bandwidth(30).thresholds(5)(n.filter((function(t){return t.topics.map((function(e){return e[0]})).includes(e)})))[0]})),A=function(e){return"none"===d?.25:"topic"!==d?.1:e===h?.36:.1},I=p.scaleLinear().domain([0,p.max(n,(function(e){return+e.citationCount}))]).range([3,15]),E=function(e){if(0===e.topics.length)return"#ccc";var t=e.topics[0];return e.topics.forEach((function(e){e[1]>t[1]&&(t=e)})),u[t[0]]},Y=function(e){return f===e.doi||"none"===d?1:r.map((function(e){return e.doi})).includes(e.doi)?.8:.2},B=function(e){return f===e.doi?6:"none"===d||"topic"===d?1:r.map((function(e){return e.doi})).includes(e.doi)?3:1},F=function(e){return f===e.doi?[4,8]:"none"===d||"topic"===d?"none":r.map((function(e){return e.doi})).includes(e.doi)?[5,5]:"none"},M=function(e){return f===e.doi?"red":"none"===d||"topic"===d?"#fff":r.map((function(e){return e.doi})).includes(e.doi)?"#333":"none"},X=function(e){var t=n.filter((function(t){return t.topics.map((function(e){return e[0]})).includes(e)})),i=n.filter((function(t){return t.topics[0][0]===e})),a=H(i.reduce((function(e,t){return e+t.projection[0]}),0)/i.length),r=_(i.reduce((function(e,t){return e+t.projection[1]}),0)/i.length);return{allPapers:t,topicIndex:e,mainPapers:i,positionX:a,positionY:r,color:u[e]}},U=X(h),W=new Set(U.allPapers.map((function(e){return e.doi}))),z=p.range(c).filter((function(e){return e!==h})).map((function(e){return X(e)}));z.forEach((function(e){e.intersectionPapers=e.allPapers.filter((function(e){return W.has(e.doi)}))}));var K=p.scaleLinear().domain(p.extent([].concat(Object(l.a)(z),[U]),(function(e){return e.allPapers.length}))).range([30,45]),R=function(e){var t=2*Math.PI*e.intersectionPapers.length/e.allPapers.length,n=K(e.allPapers.length),i={x:e.positionX,y:e.positionY-n},a={x:e.positionX+Math.sin(t)*n,y:e.positionY-Math.cos(t)*n};return"M ".concat(e.positionX," ").concat(e.positionY,"\n          L ").concat(i.x," ").concat(i.y,"\n          A ").concat(n," ").concat(n," 0 0 1 ").concat(a.x," ").concat(a.y,"\n          Z\n          ")},J=function(e){return b<0?.8:e.topicIndex===b?1:.6},V=z.map((function(e){var t=e.topicIndex,n={x:e.positionX,y:e.positionY},i={x:U.positionX,y:U.positionY},a=function(e,t,n,i,a){var r,c,o,s,l=Math.sqrt((e-n)*(e-n)+(t-i)*(t-i)),u=(i-t)*a/l,d=(n-e)*a/l;return{x_1_3_positive:(r=e-u)+(n-e)/3,y_1_3_positive:(c=t+d)+(i-t)/3,x_2_3_positive:r+2*(n-e)/3,y_2_3_positive:c+2*(i-t)/3,x_1_3_negative:(o=e+u)+(n-e)/3,y_1_3_negative:(s=t-d)+(i-t)/3,x_2_3_negative:o+2*(n-e)/3,y_2_3_negative:s+2*(i-t)/3}}(n.x,n.y,i.x,i.y,25),r=[{x:a.x_1_3_negative,y:a.y_1_3_negative},{x:a.x_2_3_negative,y:a.y_2_3_negative}],c=[{x:a.x_1_3_positive,y:a.y_1_3_positive},{x:a.x_2_3_positive,y:a.y_2_3_positive}],o=e.allPapers.filter((function(e){return W.has(e.doi)})),s=o.length,l=new Set(o.map((function(e){return e.doi}))),u=e.allPapers.filter((function(e){return!l.has(e.doi)})),d=U.allPapers.filter((function(e){return!l.has(e.doi)})),h=new Set(u.reduce((function(e,t){return e.concat(t.refList)}),[])),p=d.filter((function(e){return h.has(e.doi)})),g=new Set(p.map((function(e){return e.doi}))),f=u.reduce((function(e,t){return e+t.refList.filter((function(e){return g.has(e)})).length}),0),j=p.length,b=u.filter((function(e){return e.refList.filter((function(e){return g.has(e)})).length>0})),v=new Set(d.reduce((function(e,t){return e.concat(t.refList)}),[])),m=u.filter((function(e){return v.has(e.doi)})),x=new Set(m.map((function(e){return e.doi}))),O=d.reduce((function(e,t){return e+t.refList.filter((function(e){return x.has(e)})).length}),0),y=m.length;return{topicIndex:t,source:n,target:i,citeControlPoints:r,citedControlPoints:c,independentPapers:u,interPapers:o,centralEntityIndependentPapers:d,citeDoiSet:h,citedDoiSet:v,interCount:s,citePapers:p,citePaperCount:j,citeLinkCount:f,citedPapers:m,citedPaperCount:y,citedLinkCount:O,citeSourcePapers:b,citePapersDoiSet:g}})),Z=p.scaleLinear().domain([0,p.max(V,(function(e){return p.max([e.interCount,e.citeLinkCount,e.citedLinkCount])}))]).range([5,20]),q=function(e){return 0===e?0:Z(e)},G=function(e){return b<0?.7:e.topicIndex===b?1:.3};return Object(i.jsxs)("div",{className:"projection-view",children:[Object(i.jsxs)("svg",{id:e,width:"100%",height:"100%",children:[Object(i.jsx)("g",{id:"topic-contours-g",strokeLinejoin:"round",strokeWidth:"1.5",children:L.map((function(e,t){return Object(i.jsx)("path",{d:p.geoPath()(e),fill:u[t],opacity:A(t),stroke:t===h?"#111":"none",strokeDasharray:t===h?5:"none"},t)}))}),Object(i.jsx)("g",{id:"paper-circles-g",stroke:"#fff",children:n.map((function(e){return Object(i.jsx)("circle",{cx:H(e.projection[0]),cy:_(e.projection[1]),r:I(+e.citationCount)+B(e),fill:E(e),strokeLinecap:"round",strokeWidth:B(e),opacity:Y(e),strokeDasharray:F(e),stroke:M(e),cursor:"pointer",onClick:function(){return g(e.doi)}},e.doi)}))}),"topic"===d&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("g",{id:"topic-links-g",strokeLinecap:"round",children:V.map((function(e){return Object(i.jsxs)("g",{fill:"none",opacity:G(e),cursor:"pointer",onClick:function(){return v((t=e).topicIndex),void j(t.citeSourcePapers.map((function(e){return e.doi})),t.citedPapers.map((function(e){return e.doi})),t.centralEntityIndependentPapers.map((function(e){return e.doi})));var t},children:[Object(i.jsx)("path",{className:"cited",stroke:u[e.topicIndex],strokeWidth:q(e.citedLinkCount),d:"M".concat(e.source.x,",").concat(e.source.y," \n                    C").concat(e.citedControlPoints[0].x,",").concat(e.citedControlPoints[0].y,", \n                    ").concat(e.citedControlPoints[1].x,",").concat(e.citedControlPoints[1].y,", \n                    ").concat(e.target.x,",").concat(e.target.y)}),Object(i.jsx)("path",{className:"cite",stroke:u[h],strokeWidth:q(e.citeLinkCount),d:"M".concat(e.target.x,",").concat(e.target.y,"\n                    C").concat(e.citeControlPoints[1].x,",").concat(e.citeControlPoints[1].y,", \n                    ").concat(e.citeControlPoints[0].x,",").concat(e.citeControlPoints[0].y,", \n                    ").concat(e.source.x,",").concat(e.source.y)})]},e.topicIndex)}))}),Object(i.jsxs)("g",{id:"topic-entities-g",children:[Object(i.jsx)("g",{id:"selected-topic-entity-g"}),Object(i.jsx)("g",{id:"others-topic-entities-g",stroke:"#fff",strokeWidth:"3",children:z.map((function(e){return Object(i.jsxs)("g",{opacity:J(e),children:[Object(i.jsx)("circle",{cx:e.positionX,cy:e.positionY,r:K(e.allPapers.length),fill:e.color}),Object(i.jsx)("path",{fill:u[h],d:R(e)})]},e.topicIndex)}))})]})]})]}),Object(i.jsxs)("div",{className:"topics-number-input",children:[Object(i.jsxs)("div",{className:"topics-number-input-text",children:["Topics Num: ",O]}),Object(i.jsx)(Ne.a,{min:2,max:10,onAfterChange:o,onChange:y,value:O})]})]})})),we=n(44),ke=(n(143),Object(F.a)((function(){var e="ana-network-svg",t=50,n=50,a=40,r=40,c=je({svgId:e}),o=c.width,s=c.height,u=D(),d=u.analysisPapers,h=u.topicColorScale,g=u.anaFilterType,f=u.anaHighTopic,j=u.anaHighPapers,b=u.setAnaSelectHighlightPaperDoi,v=u.anaSelectHighlightPaperDoi,m=u.anaHighEntityTopic,x=u.anaHighEntityCitePaperDois,O=u.anaHighEntityCitedPaperDois,y=u.anaHighTopicIndenpentPaperDois,C=new Set(j.map((function(e){return e.doi}))),P=p.extent(d,(function(e){return+e.year})),T=p.range.apply(p,Object(l.a)(P.map((function(e,t){return e+t})))).map((function(e){return d.filter((function(t){return+t.year===+e})).length})),N=p.max([(o-t-n)/(P[1]-P[0]+1)*.68,0]),S=p.max([p.min([.4*N,(s-r-a)/p.max(T)*.8]),0]),w=p.scaleLinear().domain(P).range([t,o-n]),k=p.scaleLinear().domain([0,p.max(T)-1]).range([a,s-r]),H={},_=d.slice();_.sort((function(e,t){return e.topics[0][0]===t.topics[0][0]?e.topics[0][1]-t.topics[0][1]:e.topics[0][0]-t.topics[0][0]}));var L={};_.forEach((function(e){e.year in H||(H[e.year]=0),L[e.doi]=H[e.year],H[e.year]+=1}));var A=function(e){if(e.doi===v)return 1;if(C.has(e.doi))return 1;if(m>=0){if(x.includes(e.doi))return.9;if(O.includes(e.doi))return.9}return.3},I=function(e){if(e.doi===v)return"red";if(m>=0){if(x.includes(e.doi))return"#666";if(O.includes(e.doi))return"#666"}return"none"===g?"#fff":C.has(e.doi)?"#666":"#fff"},E=function(e){return e.doi===v?3:2},Y=function(e){if(e.doi===v)return[4,7];if(m>=0){if(x.includes(e.doi))return"none";if(O.includes(e.doi))return"none"}return"none"===g?"none":C.has(e.doi)?[5,4]:"none"},B=p.contourDensity().x((function(e){return w(+e.year)})).y((function(e){return k(L[e.doi])})).size([o,s]).bandwidth(30).thresholds(5)(j)[0],F="none"===g?"none":"topic"===g?h[f]:"#aaa",M="none"===g?0:.25,X={};d.forEach((function(e){return X[e.doi]=e}));var U=[];d.forEach((function(e){e.refList.forEach((function(t){if(t in X){var n={source:t,target:e.doi,weight:1};U.push(n)}}))}));var W=p.linkHorizontal().x((function(e){return w(X[e].year)})).y((function(e){return k(L[e])})),z=function(e){if(k(L[e.source])===k(L[e.target])){var t=w(X[e.source].year),n=k(L[e.source]),i=w(X[e.target].year),c=n,o=t+.3*(i-t),l=t+.7*(i-t),u=n+(s-r-a)/p.max(T)*.8,d=u;return"M".concat(t,",").concat(n," C ").concat(o,",").concat(u,",").concat(l,",").concat(d,",").concat(i,",").concat(c)}return W(e)},K=function(e){if(e.source===v||e.target===v)return"#333";if(m>=0){if(x.includes(e.target)&&y.includes(e.source))return h[f];if(O.includes(e.source)&&y.includes(e.target))return h[m]}return C.has(e.source)&&C.has(e.target)?"#555":"#aaa"},R=function(e){if(e.source===v||e.target===v)return.7;if("none"===g)return.1;if(m>=0){if(x.includes(e.target)&&y.includes(e.source))return.9;if(O.includes(e.source)&&y.includes(e.target))return.9}return m<0&&C.has(e.source)&&C.has(e.target)?.35:0},J=function(e){if(e.source===v||e.target===v)return 5;if(m>=0){if(x.includes(e.target)&&y.includes(e.source))return 5;if(O.includes(e.source)&&y.includes(e.target))return 5}return C.has(e.source)&&C.has(e.target)?4:0};return Object(i.jsx)("div",{className:"ana-network-view",children:Object(i.jsxs)("svg",{id:e,width:"100%",height:"100%",children:[Object(i.jsx)("g",{id:"network-contour-g",children:Object(i.jsx)("path",{d:p.geoPath()(B),fill:F,opacity:M})}),Object(i.jsx)("g",{id:"network-links-g",fill:"none",children:U.map((function(e){return Object(i.jsx)("path",{d:z(e),strokeLinecap:"round",stroke:K(e),strokeWidth:J(e),opacity:R(e)},"".concat(e.source,"-").concat(e.target))}))}),Object(i.jsx)("g",{id:"network-rects-g",children:d.map((function(e){var t;return Object(i.jsx)("g",(t={transform:"translate(".concat(w(+e.year),", ").concat(k(L[e.doi]),")"),cursor:"pointer",onClick:function(){console.log("click",e)},opacity:A(e)},Object(we.a)(t,"onClick",(function(){return b(e.doi)})),Object(we.a)(t,"children",Object(i.jsxs)(i.Fragment,{children:[e.topics.map((function(e,t,n){return Object(i.jsx)("rect",{fill:h[e[0]],x:-N/2+N/n.length*t,y:-S/2,width:N/n.length,height:S,stroke:"#fff",strokeWidth:"1"},e[0])})),Object(i.jsx)("rect",{x:-N/2-E(e)/2,y:-S/2-E(e)/2,fill:"none",width:N+E(e),height:S+E(e),stroke:I(e),strokeWidth:E(e),strokeLinecap:"round",strokeDasharray:Y(e)})]})),t),e.doi)}))})]})})}))),He=(n(144),Object(F.a)((function(){var e=D(),t=e.topics_detail,n=e.topicColorScale,a=e.analysisPapers,r=e.anaHighPapers,c=e.anaFilterType,o=e.setAnaHighPapersByTopic,s=e.anaHighTopic;return Object(i.jsxs)("div",{className:"topic-list-view",children:[Object(i.jsx)("div",{className:"topic-list-header",children:"Topics List"}),Object(i.jsx)("div",{className:"topic-list-content",children:t.map((function(e,t){return Object(i.jsx)(_e,{topic:e,index:t+1,color:n[t],isHighlight:"none"!==c,all:a.filter((function(e){return e.topics.map((function(e){return e[0]})).includes(t)})).length,highlight:r.filter((function(e){return e.topics.map((function(e){return e[0]})).includes(t)})).length,onChange:function(){return o(t)},isSelected:"topic"===c&&s===t},t)}))})]})}))),_e=function(e){var t=e.topic,n=e.index,a=e.color,r=e.isHighlight,c=e.all,o=e.highlight,s=e.onChange,l={background:a},u=["topic-item",e.isSelected&&"topic-item-selected"].filter((function(e){return e})).join(" ");return Object(i.jsxs)("div",{className:u,style:l,onClick:s,children:[Object(i.jsxs)("div",{className:"topic-header",children:[Object(i.jsxs)("div",{className:"topic-index",children:["Topic ",n]}),Object(i.jsx)("div",{className:"topic-number",children:r?"".concat(o," / ").concat(c):c})]}),Object(i.jsx)("div",{className:"topic-detail",children:t.join(", ")})]})},Le=He,Ae=(n(145),Object(F.a)((function(){var e=D(),t=e.anaSelectHighlightPaperDoi,n=e.anaHighPapers,a=e.setAnaSelectHighlightPaperDoi;return Object(i.jsxs)("div",{className:"highlight-list-view",children:[Object(i.jsx)("div",{className:"highlight-list-header",children:"Highlight Papers"}),Object(i.jsx)("div",{className:"highlight-list-content",children:n.map((function(e,n){return Object(i.jsx)(Ie,{paper:e,index:n,handleClick:function(){return a(e.doi)},isSelected:e.doi===t},e.doi)}))})]})}))),Ie=function(e){var t=e.paper,n=e.index,a=e.handleClick,r=void 0===a?function(){}:a,c=e.isSelected,o=void 0!==c&&c;return Object(i.jsxs)("div",{className:"paper-item ".concat(o?"paper-item-selected":""),onClick:function(){return r(t.doi)},children:[Object(i.jsxs)("div",{className:"paper-index",children:[n+1,"."]}),Object(i.jsxs)("div",{className:"paper-content",children:[Object(i.jsxs)("div",{className:"paper-header",children:[Object(i.jsx)("div",{className:"paper-header-conferenceName",children:t.conferenceName}),Object(i.jsx)("div",{className:"paper-header-title",children:t.title})]}),Object(i.jsxs)("div",{className:"paper-details",children:[t.authors.join("; ")," (",t.year,")"]}),Object(i.jsx)("div",{className:"paper-tags",children:[].concat(Object(l.a)(t.keywords),Object(l.a)(t.publicTags),Object(l.a)(t.privateTags)).join("; ")})]})]})},Ee=Ae,De=(n(146),Object(F.a)((function(){var e=D().anaSelectHighlightPaper,t=e.conferenceName,n=void 0===t?"":t,a=e.year,r=void 0===a?"":a,c=e.title,o=void 0===c?"":c,s=e.authors,l=void 0===s?[]:s,u=e.keywords,d=void 0===u?[]:u,h=e.abstract,p=void 0===h?"":h;return e.title?Object(i.jsxs)("div",{className:"detail-paper-view",children:[Object(i.jsx)("div",{className:"paper-title",children:o}),Object(i.jsxs)("div",{className:"paper-details",children:[l.join("; "),Object(i.jsx)("span",{className:"paper-header",children:r&&"(".concat(n," ").concat(r,")")})]}),Object(i.jsxs)("div",{className:"paper-info",children:[Object(i.jsx)("span",{className:"paper-info-title",children:"Keywords:"}),Object(i.jsx)("span",{className:"paper-info-content",children:d.join("; ")})]}),Object(i.jsxs)("div",{className:"paper-info",children:[Object(i.jsx)("span",{className:"paper-info-title",children:"Abstract:"}),Object(i.jsx)("span",{className:"paper-info-content",children:p})]})]}):Object(i.jsx)("div",{})}))),Ye=function(){var e=D();return Object(a.useEffect)((function(){e.setCurrentPage(),e.initPapers(),e.initUserId()}),[]),Object(i.jsxs)("div",{className:"analysis-container",children:[Object(i.jsx)("div",{className:"left-container",children:Object(i.jsx)(Te,{})}),Object(i.jsxs)("div",{className:"middle-container",children:[Object(i.jsx)("div",{className:"middle-top-container",children:Object(i.jsx)(Se,{})}),Object(i.jsx)("div",{className:"middle-bottom-container",children:Object(i.jsx)(ke,{})})]}),Object(i.jsxs)("div",{className:"right-container",children:[Object(i.jsx)("div",{className:"right-top-container",children:Object(i.jsx)(Le,{})}),Object(i.jsx)("div",{className:"right-middle-container",children:Object(i.jsx)(Ee,{})}),Object(i.jsx)("div",{className:"right-bottom-container",children:Object(i.jsx)(De,{})})]})]})},Be=(n(147),["Prof. Yuan","Guozheng Li","Shuai Chen","Chenglei Yue","Ruike Jiang","Can Liu","Jincheng Li","Chaofan Yang","Hanning Shao","Yuchu Luo","Zhixian Lin","Min Tian","Dingyi Yang","Changhe Yang","Yanda Li","Datong Wei","Cong Wu","Hao Wu","Shaocong Tan","Jiacheng Yu","Sihang Li","Zhen Li","Haohua Liu","KaiChen Nie"]),Fe=n(158),Me=n(155),Xe=n(49),Ue=n(163),We=n(162),ze=Fe.a.Option,Ke=Object(F.a)((function(){var e=D(),t=e.currentPage,n=e.userId,r=e.initPapers,c=Object(a.useState)(!1),o=Object(s.a)(c,2),l=o[0],u=o[1],d=function(){return u(!l)},h="Literature ".concat(t," System"),p="Analysis"===t?"management":"analysis",g="Analysis"===t?"Manage":"Analyze",f=function(){return Object(i.jsx)(Y.b,{to:p,className:"switch-button",children:g})},j=Object(a.useState)(""),v=Object(s.a)(j,2),m=v[0],x=v[1],O=Object(a.useState)(""),y=Object(s.a)(O,2),C=y[0],P=y[1],T=Object(a.useState)(""),N=Object(s.a)(T,2),S=N[0],w=[{label:"Conference Name",setFunc:x},{label:"Public Tags",setFunc:P},{label:"Private Tags",setFunc:N[1]}],k=Object(a.useState)(""),H=Object(s.a)(k,2),_=H[0],L=H[1],A={maxCount:1,beforeUpload:function(e){return L(e),!1}};return Object(i.jsxs)("div",{className:"header",children:[Object(i.jsx)("div",{className:"title",children:h}),Object(i.jsxs)("div",{className:"user-selector",children:["User: \xa0",Object(i.jsx)(Fe.a,{value:e.userId,size:"small",onChange:function(t){e.setUserId(t)},style:{width:130},placeholder:"Set User",children:Be.map((function(e){return Object(i.jsx)(ze,{value:e,children:e},e)}))}),Object(i.jsx)(f,{}),Object(i.jsx)("div",{className:"update-data-trigger",onClick:d,children:Object(i.jsx)(Ue.a,{style:{fontSize:24}})})]}),Object(i.jsxs)(ae.a,{title:"Upload",visible:l,onOk:function(){(function(e){var t=e.file,n=e.conferenceName,i=e.publicTags,a=e.privateTags,r=e.userId,c=new FormData;c.append("file",t),c.append("conferenceName",n),c.append("publicTags",i),c.append("privateTags",a),c.append("uid",r);var o=t.name.split(".").slice(-1)[0];return c.append("fileType",o),fetch(b+"add_papers",{body:c,method:"POST"}).then((function(e){return e.json()}))})({file:_,conferenceName:m,publicTags:C,privateTags:S,userId:n}).then((function(){r(!0)})),d()},onCancel:d,centered:!0,children:[w.map((function(e){return Object(i.jsxs)("div",{className:"update_item",children:[Object(i.jsx)("div",{className:"update-item-label",children:e.label}),Object(i.jsx)(re.a,{placeholder:"Empty means no batch setting",onChange:function(t){return e.setFunc(t.target.value)}})]},e.label)})),Object(i.jsx)(Me.a,Object(ne.a)(Object(ne.a)({},A),{},{className:"update_item",children:Object(i.jsx)(Xe.a,{icon:Object(i.jsx)(We.a,{}),children:"bib/json/csv"})}))]})]})})),Re=function(){return Object(i.jsx)(E,{children:Object(i.jsx)(Y.a,{children:Object(i.jsxs)("div",{className:"view-container",children:[Object(i.jsx)("div",{className:"header-container",children:Object(i.jsx)(Ke,{})}),Object(i.jsxs)(B.c,{children:[Object(i.jsx)(B.a,{exact:!0,path:"/management",component:fe}),Object(i.jsx)(B.a,{exact:!0,path:"/analysis",component:Ye}),Object(i.jsx)(B.a,{path:"/",component:fe})]})]})})})},Je=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,167)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),i(e),a(e),r(e),c(e)}))};n(151);o.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(Re,{})}),document.getElementById("root")),Je()}},[[152,1,2]]]);
//# sourceMappingURL=main.b88a486f.chunk.js.map